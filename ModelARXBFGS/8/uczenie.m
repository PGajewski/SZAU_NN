%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.376572e+002; foe(n+1)=2.318212e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.746377e+002; foe(n+1)=1.723577e+002; krok(n+1)=4.987505e-004; ng(n+1)=7.179722e+002;
n=2; farx(n+1)=3.588784e+001; foe(n+1)=6.763621e+001; krok(n+1)=1.495979e-002; ng(n+1)=2.538807e+002;
n=3; farx(n+1)=2.566897e+001; foe(n+1)=5.873242e+001; krok(n+1)=1.259664e-003; ng(n+1)=3.756286e+002;
n=4; farx(n+1)=1.488173e+001; foe(n+1)=6.434681e+001; krok(n+1)=2.774090e-003; ng(n+1)=2.554394e+002;
n=5; farx(n+1)=3.104919e+000; foe(n+1)=3.919154e+002; krok(n+1)=1.667309e-003; ng(n+1)=4.659679e+002;
n=6; farx(n+1)=1.333059e+000; foe(n+1)=8.679593e+001; krok(n+1)=2.160874e-002; ng(n+1)=2.728919e+002;
n=7; farx(n+1)=7.565788e-001; foe(n+1)=2.451835e+001; krok(n+1)=5.962927e-002; ng(n+1)=1.687675e+002;
n=8; farx(n+1)=6.252173e-001; foe(n+1)=1.294902e+001; krok(n+1)=3.067118e-002; ng(n+1)=5.852015e+001;
n=9; farx(n+1)=5.772478e-001; foe(n+1)=1.392952e+001; krok(n+1)=1.817918e-001; ng(n+1)=1.056526e+001;
n=10; farx(n+1)=5.029046e-001; foe(n+1)=1.077896e+001; krok(n+1)=1.359113e-001; ng(n+1)=2.368931e+001;
n=11; farx(n+1)=4.653912e-001; foe(n+1)=8.751343e+000; krok(n+1)=1.399123e-001; ng(n+1)=2.650128e+001;
n=12; farx(n+1)=3.973565e-001; foe(n+1)=7.775099e+000; krok(n+1)=1.492580e-001; ng(n+1)=2.490307e+001;
n=13; farx(n+1)=3.469612e-001; foe(n+1)=1.051336e+001; krok(n+1)=1.192585e-001; ng(n+1)=1.803696e+001;
n=14; farx(n+1)=3.071702e-001; foe(n+1)=1.154789e+001; krok(n+1)=3.550835e-001; ng(n+1)=2.921979e+001;
n=15; farx(n+1)=2.981204e-001; foe(n+1)=8.493135e+000; krok(n+1)=3.214125e-001; ng(n+1)=5.652215e+000;
n=16; farx(n+1)=2.773574e-001; foe(n+1)=6.688160e+000; krok(n+1)=1.178633e-001; ng(n+1)=1.255593e+001;
n=17; farx(n+1)=2.633325e-001; foe(n+1)=6.018258e+000; krok(n+1)=1.935340e-001; ng(n+1)=5.797146e+000;
n=18; farx(n+1)=2.593496e-001; foe(n+1)=6.743698e+000; krok(n+1)=5.896462e-001; ng(n+1)=8.214411e+000;
n=19; farx(n+1)=2.542506e-001; foe(n+1)=5.252490e+000; krok(n+1)=7.271671e-001; ng(n+1)=1.139014e+001;
n=20; farx(n+1)=2.496256e-001; foe(n+1)=3.329494e+000; krok(n+1)=4.010769e+000; ng(n+1)=3.684813e+000;
n=21; farx(n+1)=2.465721e-001; foe(n+1)=3.148275e+000; krok(n+1)=1.280117e+000; ng(n+1)=4.027324e+000;
n=22; farx(n+1)=2.440664e-001; foe(n+1)=3.077876e+000; krok(n+1)=1.856466e+000; ng(n+1)=3.326950e+000;
n=23; farx(n+1)=2.421604e-001; foe(n+1)=3.202775e+000; krok(n+1)=7.571876e-001; ng(n+1)=4.264663e+000;
n=24; farx(n+1)=2.399232e-001; foe(n+1)=2.504526e+000; krok(n+1)=1.262060e+000; ng(n+1)=2.215881e+000;
n=25; farx(n+1)=2.380927e-001; foe(n+1)=2.883859e+000; krok(n+1)=5.174513e-001; ng(n+1)=3.336800e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.370534e-001; foe(n+1)=2.371935e+000; krok(n+1)=4.465528e-004; ng(n+1)=5.252743e+000;
n=27; farx(n+1)=2.369821e-001; foe(n+1)=2.457268e+000; krok(n+1)=2.859446e-004; ng(n+1)=1.370486e+000;
n=28; farx(n+1)=2.368444e-001; foe(n+1)=2.287816e+000; krok(n+1)=7.805422e-003; ng(n+1)=5.417719e-001;
n=29; farx(n+1)=2.359617e-001; foe(n+1)=1.955965e+000; krok(n+1)=1.475580e-001; ng(n+1)=3.385262e-001;
n=30; farx(n+1)=2.343302e-001; foe(n+1)=1.895961e+000; krok(n+1)=5.714050e-001; ng(n+1)=2.293465e-001;
n=31; farx(n+1)=2.330839e-001; foe(n+1)=1.494851e+000; krok(n+1)=6.144464e-001; ng(n+1)=3.463685e+000;
n=32; farx(n+1)=2.324122e-001; foe(n+1)=1.431534e+000; krok(n+1)=1.846634e-001; ng(n+1)=1.896977e+000;
n=33; farx(n+1)=2.301570e-001; foe(n+1)=1.516105e+000; krok(n+1)=1.038969e+000; ng(n+1)=1.011713e+000;
n=34; farx(n+1)=2.288671e-001; foe(n+1)=1.607144e+000; krok(n+1)=2.317569e-001; ng(n+1)=4.010236e+000;
n=35; farx(n+1)=2.279856e-001; foe(n+1)=1.659595e+000; krok(n+1)=1.338969e-001; ng(n+1)=3.265333e+000;
n=36; farx(n+1)=2.244469e-001; foe(n+1)=2.052237e+000; krok(n+1)=1.062525e+000; ng(n+1)=2.171856e+000;
n=37; farx(n+1)=2.233892e-001; foe(n+1)=1.881064e+000; krok(n+1)=3.355407e-001; ng(n+1)=2.947277e+000;
n=38; farx(n+1)=2.215923e-001; foe(n+1)=1.670829e+000; krok(n+1)=1.833637e+000; ng(n+1)=1.380209e+000;
n=39; farx(n+1)=2.198275e-001; foe(n+1)=1.672306e+000; krok(n+1)=6.477968e-001; ng(n+1)=1.641994e+000;
n=40; farx(n+1)=2.186563e-001; foe(n+1)=1.699114e+000; krok(n+1)=1.202721e-001; ng(n+1)=3.731349e+000;
n=41; farx(n+1)=2.181262e-001; foe(n+1)=1.881531e+000; krok(n+1)=2.349459e-001; ng(n+1)=1.920281e+000;
n=42; farx(n+1)=2.175621e-001; foe(n+1)=1.787072e+000; krok(n+1)=4.268310e-001; ng(n+1)=2.498135e+000;
n=43; farx(n+1)=2.167591e-001; foe(n+1)=1.637296e+000; krok(n+1)=8.892951e-001; ng(n+1)=1.912935e+000;
n=44; farx(n+1)=2.146503e-001; foe(n+1)=1.524558e+000; krok(n+1)=3.350057e+000; ng(n+1)=2.029317e+000;
n=45; farx(n+1)=2.133352e-001; foe(n+1)=1.359725e+000; krok(n+1)=6.643777e-001; ng(n+1)=1.909139e+000;
n=46; farx(n+1)=2.113756e-001; foe(n+1)=1.395996e+000; krok(n+1)=7.178738e-001; ng(n+1)=2.279084e+000;
n=47; farx(n+1)=2.103230e-001; foe(n+1)=1.372102e+000; krok(n+1)=6.709302e-001; ng(n+1)=3.085777e+000;
n=48; farx(n+1)=2.080830e-001; foe(n+1)=1.514213e+000; krok(n+1)=1.258604e+000; ng(n+1)=2.591288e+000;
n=49; farx(n+1)=2.058397e-001; foe(n+1)=1.721680e+000; krok(n+1)=4.498732e-001; ng(n+1)=4.672685e+000;
n=50; farx(n+1)=2.046376e-001; foe(n+1)=1.751900e+000; krok(n+1)=5.378226e-001; ng(n+1)=1.213552e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
