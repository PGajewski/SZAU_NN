%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.279070e+002; foe(n+1)=2.340925e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.716244e+002; foe(n+1)=1.785459e+002; krok(n+1)=5.148205e-004; ng(n+1)=7.774113e+002;
n=2; farx(n+1)=3.914788e+001; foe(n+1)=6.600307e+001; krok(n+1)=1.136409e-002; ng(n+1)=3.375775e+002;
n=3; farx(n+1)=2.985559e+001; foe(n+1)=5.545657e+001; krok(n+1)=1.925691e-003; ng(n+1)=3.284731e+002;
n=4; farx(n+1)=1.431034e+001; foe(n+1)=5.330794e+001; krok(n+1)=7.505960e-003; ng(n+1)=2.155555e+002;
n=5; farx(n+1)=3.418719e+000; foe(n+1)=3.123424e+002; krok(n+1)=1.420511e-003; ng(n+1)=4.611918e+002;
n=6; farx(n+1)=1.544012e+000; foe(n+1)=4.879386e+001; krok(n+1)=2.720095e-002; ng(n+1)=1.644713e+002;
n=7; farx(n+1)=1.279204e+000; foe(n+1)=8.125022e+001; krok(n+1)=2.414071e-002; ng(n+1)=1.579732e+001;
n=8; farx(n+1)=7.386378e-001; foe(n+1)=3.112528e+001; krok(n+1)=3.726844e-002; ng(n+1)=4.741962e+001;
n=9; farx(n+1)=7.158828e-001; foe(n+1)=3.172083e+001; krok(n+1)=5.625683e-002; ng(n+1)=1.986242e+001;
n=10; farx(n+1)=6.523795e-001; foe(n+1)=2.635957e+001; krok(n+1)=1.015974e-001; ng(n+1)=2.391602e+001;
n=11; farx(n+1)=5.989433e-001; foe(n+1)=2.100005e+001; krok(n+1)=3.375584e-001; ng(n+1)=7.962381e+000;
n=12; farx(n+1)=5.155167e-001; foe(n+1)=1.449299e+001; krok(n+1)=1.094124e-001; ng(n+1)=2.127640e+001;
n=13; farx(n+1)=4.863170e-001; foe(n+1)=1.145414e+001; krok(n+1)=8.304721e-002; ng(n+1)=2.146302e+001;
n=14; farx(n+1)=4.152676e-001; foe(n+1)=1.299024e+001; krok(n+1)=6.121507e-001; ng(n+1)=1.840455e+001;
n=15; farx(n+1)=3.588583e-001; foe(n+1)=1.606746e+001; krok(n+1)=6.182030e-001; ng(n+1)=7.689012e+000;
n=16; farx(n+1)=2.893303e-001; foe(n+1)=8.900521e+000; krok(n+1)=5.631821e-001; ng(n+1)=1.406313e+001;
n=17; farx(n+1)=2.692937e-001; foe(n+1)=6.951191e+000; krok(n+1)=1.288588e-001; ng(n+1)=2.354314e+001;
n=18; farx(n+1)=2.522682e-001; foe(n+1)=6.289757e+000; krok(n+1)=6.776371e-001; ng(n+1)=1.841119e+000;
n=19; farx(n+1)=2.439955e-001; foe(n+1)=4.717212e+000; krok(n+1)=3.329123e-001; ng(n+1)=1.172797e+001;
n=20; farx(n+1)=2.409384e-001; foe(n+1)=5.176124e+000; krok(n+1)=3.772555e-001; ng(n+1)=4.201272e+000;
n=21; farx(n+1)=2.361535e-001; foe(n+1)=3.139633e+000; krok(n+1)=1.361453e+000; ng(n+1)=2.061048e+000;
n=22; farx(n+1)=2.344902e-001; foe(n+1)=3.312770e+000; krok(n+1)=1.114269e+000; ng(n+1)=2.176126e+000;
n=23; farx(n+1)=2.329022e-001; foe(n+1)=2.997755e+000; krok(n+1)=2.254461e+000; ng(n+1)=1.629737e+000;
n=24; farx(n+1)=2.289803e-001; foe(n+1)=2.164289e+000; krok(n+1)=3.217214e+000; ng(n+1)=4.290170e+000;
n=25; farx(n+1)=2.273183e-001; foe(n+1)=2.048772e+000; krok(n+1)=1.075480e+000; ng(n+1)=4.303370e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.271325e-001; foe(n+1)=2.042494e+000; krok(n+1)=3.301872e-004; ng(n+1)=2.416081e+000;
n=27; farx(n+1)=2.269755e-001; foe(n+1)=2.029541e+000; krok(n+1)=1.846469e-003; ng(n+1)=1.171488e+000;
n=28; farx(n+1)=2.266780e-001; foe(n+1)=2.160573e+000; krok(n+1)=1.631264e-003; ng(n+1)=1.500941e+000;
n=29; farx(n+1)=2.256851e-001; foe(n+1)=1.818093e+000; krok(n+1)=1.392689e-001; ng(n+1)=2.982592e-001;
n=30; farx(n+1)=2.245893e-001; foe(n+1)=1.801283e+000; krok(n+1)=2.625380e-001; ng(n+1)=2.737266e-001;
n=31; farx(n+1)=2.233983e-001; foe(n+1)=2.076739e+000; krok(n+1)=8.193164e-001; ng(n+1)=1.079354e+000;
n=32; farx(n+1)=2.219436e-001; foe(n+1)=2.201656e+000; krok(n+1)=1.002692e+000; ng(n+1)=3.505154e-001;
n=33; farx(n+1)=2.206139e-001; foe(n+1)=2.245808e+000; krok(n+1)=2.745494e-001; ng(n+1)=1.852960e+000;
n=34; farx(n+1)=2.175806e-001; foe(n+1)=1.877001e+000; krok(n+1)=1.133514e+000; ng(n+1)=2.152030e+000;
n=35; farx(n+1)=2.163839e-001; foe(n+1)=1.771120e+000; krok(n+1)=1.775417e-001; ng(n+1)=4.547441e+000;
n=36; farx(n+1)=2.147516e-001; foe(n+1)=1.796712e+000; krok(n+1)=3.477470e-001; ng(n+1)=1.859101e+000;
n=37; farx(n+1)=2.134923e-001; foe(n+1)=1.480719e+000; krok(n+1)=3.183983e-001; ng(n+1)=2.803130e+000;
n=38; farx(n+1)=2.115281e-001; foe(n+1)=1.339633e+000; krok(n+1)=3.136529e-001; ng(n+1)=4.254214e+000;
n=39; farx(n+1)=2.101985e-001; foe(n+1)=1.141811e+000; krok(n+1)=7.101669e-001; ng(n+1)=1.776939e+000;
n=40; farx(n+1)=2.092997e-001; foe(n+1)=1.058816e+000; krok(n+1)=8.704303e-001; ng(n+1)=2.349890e+000;
n=41; farx(n+1)=2.077194e-001; foe(n+1)=1.030909e+000; krok(n+1)=1.585247e+000; ng(n+1)=2.342968e+000;
n=42; farx(n+1)=2.069240e-001; foe(n+1)=9.987642e-001; krok(n+1)=5.138574e-001; ng(n+1)=2.050509e+000;
n=43; farx(n+1)=2.059264e-001; foe(n+1)=1.059731e+000; krok(n+1)=4.641165e-001; ng(n+1)=3.039726e+000;
n=44; farx(n+1)=2.045407e-001; foe(n+1)=9.893720e-001; krok(n+1)=7.491049e-001; ng(n+1)=2.605826e+000;
n=45; farx(n+1)=2.038041e-001; foe(n+1)=1.050752e+000; krok(n+1)=3.427774e-001; ng(n+1)=3.552884e+000;
n=46; farx(n+1)=2.032754e-001; foe(n+1)=1.030832e+000; krok(n+1)=4.686024e-001; ng(n+1)=2.125409e+000;
n=47; farx(n+1)=2.026015e-001; foe(n+1)=1.064319e+000; krok(n+1)=7.113726e-001; ng(n+1)=2.208957e+000;
n=48; farx(n+1)=2.021551e-001; foe(n+1)=9.578656e-001; krok(n+1)=3.762824e-001; ng(n+1)=2.681817e+000;
n=49; farx(n+1)=2.011718e-001; foe(n+1)=8.733170e-001; krok(n+1)=9.990941e-001; ng(n+1)=1.699918e+000;
n=50; farx(n+1)=2.009010e-001; foe(n+1)=8.528695e-001; krok(n+1)=2.250273e-001; ng(n+1)=2.320844e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
