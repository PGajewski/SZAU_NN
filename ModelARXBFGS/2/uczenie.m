%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.357025e+002; foe(n+1)=2.356852e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.789401e+002; foe(n+1)=1.788983e+002; krok(n+1)=4.957630e-004; ng(n+1)=7.153200e+002;
n=2; farx(n+1)=1.247151e+002; foe(n+1)=1.362408e+002; krok(n+1)=2.357847e-002; ng(n+1)=2.087127e+002;
n=3; farx(n+1)=4.133146e+001; foe(n+1)=5.420250e+001; krok(n+1)=5.018139e-004; ng(n+1)=1.478127e+003;
n=4; farx(n+1)=3.073590e+001; foe(n+1)=1.014733e+002; krok(n+1)=1.573435e-003; ng(n+1)=4.796090e+002;
n=5; farx(n+1)=1.852658e+001; foe(n+1)=2.627226e+002; krok(n+1)=7.590926e-004; ng(n+1)=4.289468e+002;
n=6; farx(n+1)=1.499600e+001; foe(n+1)=1.142699e+003; krok(n+1)=4.908489e-003; ng(n+1)=4.849853e+002;
n=7; farx(n+1)=9.361008e+000; foe(n+1)=1.193542e+003; krok(n+1)=1.296098e-002; ng(n+1)=2.603425e+002;
n=8; farx(n+1)=7.743838e+000; foe(n+1)=1.103159e+003; krok(n+1)=2.331518e-002; ng(n+1)=2.153996e+002;
n=9; farx(n+1)=3.354037e+000; foe(n+1)=9.006434e+002; krok(n+1)=8.569436e-002; ng(n+1)=1.928627e+002;
n=10; farx(n+1)=2.269612e+000; foe(n+1)=1.292493e+002; krok(n+1)=9.019129e-003; ng(n+1)=1.683447e+002;
n=11; farx(n+1)=1.628324e+000; foe(n+1)=2.882221e+001; krok(n+1)=2.847182e-002; ng(n+1)=2.064286e+002;
n=12; farx(n+1)=7.993516e-001; foe(n+1)=1.116983e+001; krok(n+1)=1.716139e-002; ng(n+1)=2.682390e+002;
n=13; farx(n+1)=7.428813e-001; foe(n+1)=1.139462e+001; krok(n+1)=2.191235e-002; ng(n+1)=6.469398e+001;
n=14; farx(n+1)=5.311407e-001; foe(n+1)=1.044396e+001; krok(n+1)=3.450079e-001; ng(n+1)=6.603700e+001;
n=15; farx(n+1)=4.661568e-001; foe(n+1)=1.294918e+001; krok(n+1)=1.794685e-001; ng(n+1)=3.191054e+001;
n=16; farx(n+1)=4.246870e-001; foe(n+1)=8.254944e+000; krok(n+1)=9.137743e-002; ng(n+1)=4.635371e+001;
n=17; farx(n+1)=3.407386e-001; foe(n+1)=1.170996e+001; krok(n+1)=5.249576e-001; ng(n+1)=3.700880e+001;
n=18; farx(n+1)=3.200051e-001; foe(n+1)=6.716687e+000; krok(n+1)=4.498732e-001; ng(n+1)=3.782121e+001;
n=19; farx(n+1)=3.096598e-001; foe(n+1)=6.771040e+000; krok(n+1)=5.819545e-001; ng(n+1)=3.606750e+000;
n=20; farx(n+1)=2.919705e-001; foe(n+1)=9.134134e+000; krok(n+1)=8.166569e-001; ng(n+1)=1.527264e+001;
n=21; farx(n+1)=2.797481e-001; foe(n+1)=8.967558e+000; krok(n+1)=1.616601e+000; ng(n+1)=1.420250e+001;
n=22; farx(n+1)=2.700184e-001; foe(n+1)=1.279051e+001; krok(n+1)=2.522360e+000; ng(n+1)=4.939872e+000;
n=23; farx(n+1)=2.674895e-001; foe(n+1)=1.120787e+001; krok(n+1)=6.278005e-001; ng(n+1)=2.780046e+000;
n=24; farx(n+1)=2.611328e-001; foe(n+1)=1.436749e+001; krok(n+1)=2.052572e+000; ng(n+1)=4.548745e+000;
n=25; farx(n+1)=2.537414e-001; foe(n+1)=1.086482e+001; krok(n+1)=1.760056e+000; ng(n+1)=6.955702e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.525119e-001; foe(n+1)=1.244181e+001; krok(n+1)=1.151008e-004; ng(n+1)=1.421967e+001;
n=27; farx(n+1)=2.522268e-001; foe(n+1)=1.197376e+001; krok(n+1)=1.945992e-004; ng(n+1)=4.941553e+000;
n=28; farx(n+1)=2.515739e-001; foe(n+1)=1.301803e+001; krok(n+1)=1.290694e-003; ng(n+1)=2.954321e+000;
n=29; farx(n+1)=2.494459e-001; foe(n+1)=1.144672e+001; krok(n+1)=2.147336e-002; ng(n+1)=1.241830e+000;
n=30; farx(n+1)=2.473404e-001; foe(n+1)=1.447794e+001; krok(n+1)=1.963396e-002; ng(n+1)=1.183934e+000;
n=31; farx(n+1)=2.465511e-001; foe(n+1)=1.353032e+001; krok(n+1)=2.452306e-002; ng(n+1)=1.818268e+000;
n=32; farx(n+1)=2.458205e-001; foe(n+1)=1.195410e+001; krok(n+1)=6.442938e-002; ng(n+1)=3.023772e+000;
n=33; farx(n+1)=2.449605e-001; foe(n+1)=1.236050e+001; krok(n+1)=6.504518e-002; ng(n+1)=4.897018e+000;
n=34; farx(n+1)=2.413934e-001; foe(n+1)=8.709061e+000; krok(n+1)=9.110982e-001; ng(n+1)=8.093655e+000;
n=35; farx(n+1)=2.377535e-001; foe(n+1)=8.797484e+000; krok(n+1)=9.574267e-001; ng(n+1)=9.134211e+000;
n=36; farx(n+1)=2.357963e-001; foe(n+1)=9.679316e+000; krok(n+1)=3.785938e-001; ng(n+1)=6.712210e+000;
n=37; farx(n+1)=2.303721e-001; foe(n+1)=8.406014e+000; krok(n+1)=1.443163e+000; ng(n+1)=6.647762e+000;
n=38; farx(n+1)=2.299708e-001; foe(n+1)=8.840893e+000; krok(n+1)=2.640812e-001; ng(n+1)=3.546347e+000;
n=39; farx(n+1)=2.291860e-001; foe(n+1)=9.210620e+000; krok(n+1)=3.465039e-001; ng(n+1)=4.112366e+000;
n=40; farx(n+1)=2.285524e-001; foe(n+1)=8.916522e+000; krok(n+1)=9.453922e-001; ng(n+1)=3.297004e+000;
n=41; farx(n+1)=2.262760e-001; foe(n+1)=7.603947e+000; krok(n+1)=2.087756e+000; ng(n+1)=4.473749e+000;
n=42; farx(n+1)=2.248752e-001; foe(n+1)=7.637990e+000; krok(n+1)=7.011953e-001; ng(n+1)=5.101280e+000;
n=43; farx(n+1)=2.228234e-001; foe(n+1)=7.824012e+000; krok(n+1)=6.182030e-001; ng(n+1)=4.555826e+000;
n=44; farx(n+1)=2.205056e-001; foe(n+1)=7.277017e+000; krok(n+1)=6.197318e-001; ng(n+1)=5.641180e+000;
n=45; farx(n+1)=2.192139e-001; foe(n+1)=6.573984e+000; krok(n+1)=3.080168e-001; ng(n+1)=6.005174e+000;
n=46; farx(n+1)=2.151065e-001; foe(n+1)=6.898512e+000; krok(n+1)=6.749097e-001; ng(n+1)=5.376116e+000;
n=47; farx(n+1)=2.122164e-001; foe(n+1)=6.871493e+000; krok(n+1)=5.461800e-001; ng(n+1)=1.056331e+001;
n=48; farx(n+1)=2.099237e-001; foe(n+1)=5.543945e+000; krok(n+1)=8.204121e-001; ng(n+1)=5.409238e+000;
n=49; farx(n+1)=2.080786e-001; foe(n+1)=4.881933e+000; krok(n+1)=6.361450e-001; ng(n+1)=4.094837e+000;
n=50; farx(n+1)=2.065844e-001; foe(n+1)=4.850018e+000; krok(n+1)=8.935632e-001; ng(n+1)=6.385921e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
