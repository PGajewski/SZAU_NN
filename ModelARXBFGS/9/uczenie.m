%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.412180e+002; foe(n+1)=2.326592e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.800970e+002; foe(n+1)=1.763848e+002; krok(n+1)=5.097061e-004; ng(n+1)=7.614998e+002;
n=2; farx(n+1)=1.380682e+002; foe(n+1)=1.506635e+002; krok(n+1)=1.053841e-002; ng(n+1)=2.536010e+002;
n=3; farx(n+1)=3.439905e+001; foe(n+1)=5.307495e+001; krok(n+1)=1.165794e-003; ng(n+1)=9.805034e+002;
n=4; farx(n+1)=1.858505e+001; foe(n+1)=1.797407e+002; krok(n+1)=3.490481e-003; ng(n+1)=2.791286e+002;
n=5; farx(n+1)=1.148420e+001; foe(n+1)=4.777889e+002; krok(n+1)=5.005982e-004; ng(n+1)=4.512239e+002;
n=6; farx(n+1)=6.505637e+000; foe(n+1)=1.313190e+002; krok(n+1)=1.372911e-001; ng(n+1)=2.796193e+002;
n=7; farx(n+1)=5.611174e+000; foe(n+1)=9.039264e+001; krok(n+1)=6.326141e-004; ng(n+1)=3.653322e+002;
n=8; farx(n+1)=4.633819e+000; foe(n+1)=4.288464e+001; krok(n+1)=1.256724e-002; ng(n+1)=9.345501e+001;
n=9; farx(n+1)=2.691147e+000; foe(n+1)=3.551690e+001; krok(n+1)=2.452306e-002; ng(n+1)=1.533409e+002;
n=10; farx(n+1)=1.457083e+000; foe(n+1)=2.710764e+001; krok(n+1)=2.812841e-002; ng(n+1)=2.039985e+002;
n=11; farx(n+1)=7.475137e-001; foe(n+1)=9.745919e+000; krok(n+1)=5.598693e-002; ng(n+1)=1.189916e+002;
n=12; farx(n+1)=4.829792e-001; foe(n+1)=9.494681e+000; krok(n+1)=3.172883e-002; ng(n+1)=7.417386e+001;
n=13; farx(n+1)=4.643460e-001; foe(n+1)=9.223111e+000; krok(n+1)=6.423218e-002; ng(n+1)=3.202546e+001;
n=14; farx(n+1)=4.331050e-001; foe(n+1)=1.205741e+001; krok(n+1)=5.983917e-002; ng(n+1)=1.154566e+001;
n=15; farx(n+1)=3.715636e-001; foe(n+1)=1.179432e+001; krok(n+1)=1.364675e-001; ng(n+1)=2.146385e+001;
n=16; farx(n+1)=3.020857e-001; foe(n+1)=1.056909e+001; krok(n+1)=1.942977e-001; ng(n+1)=3.838722e+001;
n=17; farx(n+1)=2.783568e-001; foe(n+1)=8.115182e+000; krok(n+1)=8.670260e-001; ng(n+1)=2.370226e+001;
n=18; farx(n+1)=2.732077e-001; foe(n+1)=8.718858e+000; krok(n+1)=1.081188e-001; ng(n+1)=1.130410e+001;
n=19; farx(n+1)=2.650319e-001; foe(n+1)=5.989170e+000; krok(n+1)=8.576098e-001; ng(n+1)=6.977567e+000;
n=20; farx(n+1)=2.573619e-001; foe(n+1)=5.848763e+000; krok(n+1)=8.858725e-001; ng(n+1)=1.164742e+001;
n=21; farx(n+1)=2.548590e-001; foe(n+1)=5.879096e+000; krok(n+1)=8.649503e-001; ng(n+1)=1.113138e+001;
n=22; farx(n+1)=2.504717e-001; foe(n+1)=4.002420e+000; krok(n+1)=1.561751e+000; ng(n+1)=4.321109e+000;
n=23; farx(n+1)=2.476489e-001; foe(n+1)=3.406496e+000; krok(n+1)=1.422745e+000; ng(n+1)=5.971428e+000;
n=24; farx(n+1)=2.470633e-001; foe(n+1)=3.301242e+000; krok(n+1)=4.317671e-001; ng(n+1)=5.945896e+000;
n=25; farx(n+1)=2.464379e-001; foe(n+1)=3.284328e+000; krok(n+1)=9.087851e-001; ng(n+1)=2.147121e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.464156e-001; foe(n+1)=3.287053e+000; krok(n+1)=7.240622e-005; ng(n+1)=1.778716e+000;
n=27; farx(n+1)=2.464128e-001; foe(n+1)=3.284746e+000; krok(n+1)=4.863026e-004; ng(n+1)=2.457567e-001;
n=28; farx(n+1)=2.463999e-001; foe(n+1)=3.258875e+000; krok(n+1)=1.457389e-003; ng(n+1)=3.760297e-001;
n=29; farx(n+1)=2.463130e-001; foe(n+1)=3.374025e+000; krok(n+1)=2.097129e-002; ng(n+1)=2.119157e-001;
n=30; farx(n+1)=2.441534e-001; foe(n+1)=3.345133e+000; krok(n+1)=5.914179e-001; ng(n+1)=1.899832e-001;
n=31; farx(n+1)=2.439078e-001; foe(n+1)=3.203371e+000; krok(n+1)=8.277891e-002; ng(n+1)=9.224734e+000;
n=32; farx(n+1)=2.421937e-001; foe(n+1)=3.086386e+000; krok(n+1)=1.217528e-001; ng(n+1)=8.654819e+000;
n=33; farx(n+1)=2.407581e-001; foe(n+1)=3.371359e+000; krok(n+1)=5.393056e-001; ng(n+1)=5.789581e+000;
n=34; farx(n+1)=2.397728e-001; foe(n+1)=3.330412e+000; krok(n+1)=2.894475e-001; ng(n+1)=5.355884e+000;
n=35; farx(n+1)=2.384089e-001; foe(n+1)=3.411324e+000; krok(n+1)=3.457398e-001; ng(n+1)=5.228700e+000;
n=36; farx(n+1)=2.372501e-001; foe(n+1)=3.286995e+000; krok(n+1)=7.848019e-001; ng(n+1)=4.282641e+000;
n=37; farx(n+1)=2.367299e-001; foe(n+1)=3.350887e+000; krok(n+1)=2.718226e-001; ng(n+1)=2.954781e+000;
n=38; farx(n+1)=2.346254e-001; foe(n+1)=2.634754e+000; krok(n+1)=1.745690e+000; ng(n+1)=1.297740e+000;
n=39; farx(n+1)=2.340030e-001; foe(n+1)=2.409547e+000; krok(n+1)=3.745525e-001; ng(n+1)=5.402413e+000;
n=40; farx(n+1)=2.326300e-001; foe(n+1)=2.745325e+000; krok(n+1)=1.109668e+000; ng(n+1)=3.229700e+000;
n=41; farx(n+1)=2.318009e-001; foe(n+1)=2.908624e+000; krok(n+1)=3.550835e-001; ng(n+1)=3.300923e+000;
n=42; farx(n+1)=2.300425e-001; foe(n+1)=3.338310e+000; krok(n+1)=7.382907e-001; ng(n+1)=4.272472e+000;
n=43; farx(n+1)=2.293905e-001; foe(n+1)=3.168516e+000; krok(n+1)=1.872762e-001; ng(n+1)=4.275148e+000;
n=44; farx(n+1)=2.284903e-001; foe(n+1)=2.957577e+000; krok(n+1)=5.885355e-001; ng(n+1)=2.628828e+000;
n=45; farx(n+1)=2.277070e-001; foe(n+1)=2.875143e+000; krok(n+1)=2.051030e-001; ng(n+1)=5.656772e+000;
n=46; farx(n+1)=2.267172e-001; foe(n+1)=3.172494e+000; krok(n+1)=1.601772e+000; ng(n+1)=1.085232e+000;
n=47; farx(n+1)=2.258730e-001; foe(n+1)=3.002829e+000; krok(n+1)=5.107206e-001; ng(n+1)=3.757125e+000;
n=48; farx(n+1)=2.251078e-001; foe(n+1)=2.546804e+000; krok(n+1)=2.093785e-001; ng(n+1)=1.769610e+000;
n=49; farx(n+1)=2.245833e-001; foe(n+1)=2.470504e+000; krok(n+1)=2.051030e-001; ng(n+1)=4.310579e+000;
n=50; farx(n+1)=2.235092e-001; foe(n+1)=2.548309e+000; krok(n+1)=4.997929e-001; ng(n+1)=4.765641e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
