%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.270127e+002; foe(n+1)=2.217840e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.776114e+002; foe(n+1)=1.758679e+002; krok(n+1)=5.330760e-004; ng(n+1)=7.455156e+002;
n=2; farx(n+1)=4.567665e+001; foe(n+1)=6.390598e+001; krok(n+1)=1.600678e-002; ng(n+1)=3.676975e+002;
n=3; farx(n+1)=3.512087e+001; foe(n+1)=5.796174e+001; krok(n+1)=3.970634e-004; ng(n+1)=7.170795e+002;
n=4; farx(n+1)=1.621445e+001; foe(n+1)=1.217648e+002; krok(n+1)=2.634602e-003; ng(n+1)=3.446578e+002;
n=5; farx(n+1)=4.602986e+000; foe(n+1)=1.639740e+003; krok(n+1)=6.935224e-004; ng(n+1)=4.876053e+002;
n=6; farx(n+1)=2.064523e+000; foe(n+1)=1.632440e+003; krok(n+1)=4.681906e-002; ng(n+1)=2.423597e+002;
n=7; farx(n+1)=1.732957e+000; foe(n+1)=1.421425e+003; krok(n+1)=5.205007e-002; ng(n+1)=8.522744e+001;
n=8; farx(n+1)=1.594043e+000; foe(n+1)=1.765896e+003; krok(n+1)=1.974372e-002; ng(n+1)=5.793416e+001;
n=9; farx(n+1)=1.374540e+000; foe(n+1)=9.411657e+002; krok(n+1)=7.277208e-002; ng(n+1)=1.003450e+002;
n=10; farx(n+1)=1.161714e+000; foe(n+1)=3.808952e+002; krok(n+1)=6.357754e-002; ng(n+1)=8.119105e+001;
n=11; farx(n+1)=9.024236e-001; foe(n+1)=1.233700e+002; krok(n+1)=1.738735e-001; ng(n+1)=4.170710e+001;
n=12; farx(n+1)=7.919577e-001; foe(n+1)=7.395234e+001; krok(n+1)=1.639493e-001; ng(n+1)=5.948503e+001;
n=13; farx(n+1)=6.608359e-001; foe(n+1)=8.236092e+001; krok(n+1)=3.822127e-002; ng(n+1)=6.946014e+001;
n=14; farx(n+1)=5.313316e-001; foe(n+1)=3.641039e+001; krok(n+1)=2.440798e-001; ng(n+1)=7.676919e+001;
n=15; farx(n+1)=4.873701e-001; foe(n+1)=2.263610e+001; krok(n+1)=1.121259e-001; ng(n+1)=3.081231e+001;
n=16; farx(n+1)=3.702926e-001; foe(n+1)=1.699996e+001; krok(n+1)=2.725288e-001; ng(n+1)=1.895483e+001;
n=17; farx(n+1)=3.543369e-001; foe(n+1)=1.544228e+001; krok(n+1)=7.660919e-002; ng(n+1)=2.526837e+001;
n=18; farx(n+1)=3.299976e-001; foe(n+1)=9.204792e+000; krok(n+1)=5.179328e-001; ng(n+1)=2.260725e+001;
n=19; farx(n+1)=2.968194e-001; foe(n+1)=7.102651e+000; krok(n+1)=8.193164e-001; ng(n+1)=1.637690e+001;
n=20; farx(n+1)=2.778336e-001; foe(n+1)=6.139004e+000; krok(n+1)=7.807902e-001; ng(n+1)=3.017248e+001;
n=21; farx(n+1)=2.515553e-001; foe(n+1)=3.915601e+000; krok(n+1)=1.119298e+000; ng(n+1)=8.529262e+000;
n=22; farx(n+1)=2.356858e-001; foe(n+1)=3.011080e+000; krok(n+1)=6.002260e-001; ng(n+1)=2.430075e+001;
n=23; farx(n+1)=2.300036e-001; foe(n+1)=2.077353e+000; krok(n+1)=8.536620e-001; ng(n+1)=5.944864e+000;
n=24; farx(n+1)=2.255368e-001; foe(n+1)=1.793003e+000; krok(n+1)=2.723893e+000; ng(n+1)=1.410185e+000;
n=25; farx(n+1)=2.225410e-001; foe(n+1)=1.593715e+000; krok(n+1)=1.762425e+000; ng(n+1)=6.150015e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.223017e-001; foe(n+1)=1.570197e+000; krok(n+1)=2.302017e-004; ng(n+1)=4.141627e+000;
n=27; farx(n+1)=2.222552e-001; foe(n+1)=1.583846e+000; krok(n+1)=2.025153e-004; ng(n+1)=1.799562e+000;
n=28; farx(n+1)=2.221753e-001; foe(n+1)=1.527928e+000; krok(n+1)=2.855545e-003; ng(n+1)=6.998893e-001;
n=29; farx(n+1)=2.217315e-001; foe(n+1)=1.598448e+000; krok(n+1)=9.909413e-002; ng(n+1)=2.695126e-001;
n=30; farx(n+1)=2.210721e-001; foe(n+1)=1.606945e+000; krok(n+1)=1.113003e-001; ng(n+1)=3.072076e-001;
n=31; farx(n+1)=2.204954e-001; foe(n+1)=1.630647e+000; krok(n+1)=9.363811e-002; ng(n+1)=6.372204e-001;
n=32; farx(n+1)=2.164582e-001; foe(n+1)=1.411079e+000; krok(n+1)=6.622313e-001; ng(n+1)=1.564914e+000;
n=33; farx(n+1)=2.129910e-001; foe(n+1)=1.442159e+000; krok(n+1)=2.920744e-001; ng(n+1)=7.248713e+000;
n=34; farx(n+1)=2.114088e-001; foe(n+1)=1.357990e+000; krok(n+1)=1.044257e-001; ng(n+1)=8.037079e+000;
n=35; farx(n+1)=2.099316e-001; foe(n+1)=1.249637e+000; krok(n+1)=4.027995e-001; ng(n+1)=4.183526e+000;
n=36; farx(n+1)=2.074894e-001; foe(n+1)=1.240198e+000; krok(n+1)=7.382907e-001; ng(n+1)=3.002828e+000;
n=37; farx(n+1)=2.067835e-001; foe(n+1)=1.201217e+000; krok(n+1)=2.143812e-001; ng(n+1)=4.516892e+000;
n=38; farx(n+1)=2.059561e-001; foe(n+1)=1.147179e+000; krok(n+1)=6.007020e-001; ng(n+1)=2.720965e+000;
n=39; farx(n+1)=2.036285e-001; foe(n+1)=1.173108e+000; krok(n+1)=6.077026e-001; ng(n+1)=2.187083e+000;
n=40; farx(n+1)=2.030073e-001; foe(n+1)=1.151478e+000; krok(n+1)=3.023171e-001; ng(n+1)=3.583879e+000;
n=41; farx(n+1)=2.021097e-001; foe(n+1)=1.088335e+000; krok(n+1)=3.132115e-001; ng(n+1)=2.120476e+000;
n=42; farx(n+1)=2.010699e-001; foe(n+1)=9.276381e-001; krok(n+1)=4.803814e-001; ng(n+1)=4.117674e+000;
n=43; farx(n+1)=2.001395e-001; foe(n+1)=1.018480e+000; krok(n+1)=6.912919e-001; ng(n+1)=2.771688e+000;
n=44; farx(n+1)=1.994359e-001; foe(n+1)=1.096884e+000; krok(n+1)=3.589369e-001; ng(n+1)=4.772996e+000;
n=45; farx(n+1)=1.984279e-001; foe(n+1)=1.093394e+000; krok(n+1)=8.375141e-001; ng(n+1)=3.026067e+000;
n=46; farx(n+1)=1.978029e-001; foe(n+1)=1.315310e+000; krok(n+1)=4.641165e-001; ng(n+1)=2.622809e+000;
n=47; farx(n+1)=1.970587e-001; foe(n+1)=1.346826e+000; krok(n+1)=8.771846e-001; ng(n+1)=1.371648e+000;
n=48; farx(n+1)=1.967559e-001; foe(n+1)=1.331372e+000; krok(n+1)=2.798246e-001; ng(n+1)=1.514862e+000;
n=49; farx(n+1)=1.961605e-001; foe(n+1)=1.428562e+000; krok(n+1)=9.709553e-001; ng(n+1)=1.777883e+000;
n=50; farx(n+1)=1.958841e-001; foe(n+1)=1.383691e+000; krok(n+1)=4.385923e-001; ng(n+1)=2.655033e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
