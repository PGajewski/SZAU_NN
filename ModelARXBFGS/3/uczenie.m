%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.365494e+002; foe(n+1)=2.412507e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.785591e+002; foe(n+1)=1.838756e+002; krok(n+1)=5.018139e-004; ng(n+1)=6.734932e+002;
n=2; farx(n+1)=4.592551e+001; foe(n+1)=8.039572e+001; krok(n+1)=8.892157e-002; ng(n+1)=2.370000e+002;
n=3; farx(n+1)=3.323848e+001; foe(n+1)=6.753892e+001; krok(n+1)=3.164277e-004; ng(n+1)=8.917310e+002;
n=4; farx(n+1)=2.784572e+001; foe(n+1)=6.432533e+001; krok(n+1)=4.395065e-004; ng(n+1)=4.802259e+002;
n=5; farx(n+1)=1.353765e+001; foe(n+1)=5.019989e+001; krok(n+1)=1.548346e-003; ng(n+1)=3.626670e+002;
n=6; farx(n+1)=7.364732e+000; foe(n+1)=6.891041e+002; krok(n+1)=5.557598e-003; ng(n+1)=1.626978e+002;
n=7; farx(n+1)=2.855465e+000; foe(n+1)=5.718180e+002; krok(n+1)=1.346946e-002; ng(n+1)=1.300009e+002;
n=8; farx(n+1)=1.560482e+000; foe(n+1)=1.871923e+002; krok(n+1)=2.308292e-002; ng(n+1)=2.104624e+002;
n=9; farx(n+1)=1.426333e+000; foe(n+1)=9.382595e+001; krok(n+1)=2.152696e-002; ng(n+1)=4.555633e+001;
n=10; farx(n+1)=1.149014e+000; foe(n+1)=4.292297e+001; krok(n+1)=7.727538e-002; ng(n+1)=3.029373e+001;
n=11; farx(n+1)=1.037599e+000; foe(n+1)=4.491775e+001; krok(n+1)=1.482879e-001; ng(n+1)=4.181667e+001;
n=12; farx(n+1)=8.062535e-001; foe(n+1)=5.750901e+001; krok(n+1)=1.335492e-001; ng(n+1)=6.225622e+001;
n=13; farx(n+1)=6.180389e-001; foe(n+1)=8.671976e+001; krok(n+1)=1.221956e-001; ng(n+1)=6.931399e+001;
n=14; farx(n+1)=5.828976e-001; foe(n+1)=6.118952e+001; krok(n+1)=2.055256e-001; ng(n+1)=2.974319e+001;
n=15; farx(n+1)=5.381041e-001; foe(n+1)=1.004722e+002; krok(n+1)=1.125137e-001; ng(n+1)=1.982833e+001;
n=16; farx(n+1)=4.834018e-001; foe(n+1)=7.247533e+001; krok(n+1)=1.775417e-001; ng(n+1)=2.574611e+001;
n=17; farx(n+1)=4.436954e-001; foe(n+1)=8.205622e+001; krok(n+1)=7.101669e-001; ng(n+1)=3.142957e+001;
n=18; farx(n+1)=4.168847e-001; foe(n+1)=1.332990e+002; krok(n+1)=1.734884e+000; ng(n+1)=5.760694e+000;
n=19; farx(n+1)=3.629008e-001; foe(n+1)=3.127939e+001; krok(n+1)=1.454604e+000; ng(n+1)=2.080854e+001;
n=20; farx(n+1)=3.280883e-001; foe(n+1)=2.541935e+001; krok(n+1)=1.024434e+000; ng(n+1)=1.963434e+001;
n=21; farx(n+1)=3.146338e-001; foe(n+1)=3.372243e+001; krok(n+1)=5.461275e-001; ng(n+1)=8.286034e+000;
n=22; farx(n+1)=2.973436e-001; foe(n+1)=2.247499e+001; krok(n+1)=7.992682e-001; ng(n+1)=1.260631e+001;
n=23; farx(n+1)=2.911740e-001; foe(n+1)=1.614767e+001; krok(n+1)=6.107131e-001; ng(n+1)=1.401019e+001;
n=24; farx(n+1)=2.874477e-001; foe(n+1)=1.735929e+001; krok(n+1)=6.428475e-001; ng(n+1)=4.420190e+000;
n=25; farx(n+1)=2.823362e-001; foe(n+1)=1.639273e+001; krok(n+1)=1.608038e+000; ng(n+1)=6.280665e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.821584e-001; foe(n+1)=1.605309e+001; krok(n+1)=2.110020e-004; ng(n+1)=2.719790e+000;
n=27; farx(n+1)=2.819567e-001; foe(n+1)=1.489783e+001; krok(n+1)=9.499141e-004; ng(n+1)=1.375185e+000;
n=28; farx(n+1)=2.818051e-001; foe(n+1)=1.519852e+001; krok(n+1)=1.211464e-003; ng(n+1)=1.346646e+000;
n=29; farx(n+1)=2.729963e-001; foe(n+1)=7.320413e+000; krok(n+1)=1.279818e-002; ng(n+1)=2.421933e+000;
n=30; farx(n+1)=2.674697e-001; foe(n+1)=1.021428e+001; krok(n+1)=5.478088e-003; ng(n+1)=6.516496e+000;
n=31; farx(n+1)=2.641031e-001; foe(n+1)=1.181342e+001; krok(n+1)=1.771116e-002; ng(n+1)=1.083466e+001;
n=32; farx(n+1)=2.620504e-001; foe(n+1)=9.818735e+000; krok(n+1)=1.843937e-002; ng(n+1)=1.503014e+001;
n=33; farx(n+1)=2.551818e-001; foe(n+1)=1.159532e+001; krok(n+1)=1.717868e-001; ng(n+1)=1.748677e+001;
n=34; farx(n+1)=2.515789e-001; foe(n+1)=8.171702e+000; krok(n+1)=2.128042e-002; ng(n+1)=1.536113e+001;
n=35; farx(n+1)=2.410620e-001; foe(n+1)=3.500021e+000; krok(n+1)=7.113726e-001; ng(n+1)=1.780082e+001;
n=36; farx(n+1)=2.398388e-001; foe(n+1)=3.331236e+000; krok(n+1)=1.144404e-001; ng(n+1)=6.385237e+000;
n=37; farx(n+1)=2.351719e-001; foe(n+1)=3.324489e+000; krok(n+1)=7.310195e-001; ng(n+1)=5.474748e+000;
n=38; farx(n+1)=2.330089e-001; foe(n+1)=3.487481e+000; krok(n+1)=4.954132e-001; ng(n+1)=4.304306e+000;
n=39; farx(n+1)=2.324010e-001; foe(n+1)=3.590596e+000; krok(n+1)=5.327344e-001; ng(n+1)=4.439149e+000;
n=40; farx(n+1)=2.318338e-001; foe(n+1)=3.122020e+000; krok(n+1)=1.128562e+000; ng(n+1)=2.607618e+000;
n=41; farx(n+1)=2.313565e-001; foe(n+1)=3.578897e+000; krok(n+1)=1.205335e+000; ng(n+1)=1.299364e+000;
n=42; farx(n+1)=2.309434e-001; foe(n+1)=3.840416e+000; krok(n+1)=1.180464e+000; ng(n+1)=2.198313e+000;
n=43; farx(n+1)=2.304571e-001; foe(n+1)=3.731478e+000; krok(n+1)=1.015323e+000; ng(n+1)=1.028446e+000;
n=44; farx(n+1)=2.300668e-001; foe(n+1)=3.548264e+000; krok(n+1)=1.142949e+000; ng(n+1)=1.904597e+000;
n=45; farx(n+1)=2.298104e-001; foe(n+1)=3.955404e+000; krok(n+1)=8.536620e-001; ng(n+1)=1.150877e+000;
n=46; farx(n+1)=2.296080e-001; foe(n+1)=4.286185e+000; krok(n+1)=1.552709e+000; ng(n+1)=1.520237e+000;
n=47; farx(n+1)=2.294833e-001; foe(n+1)=4.239761e+000; krok(n+1)=1.295594e+000; ng(n+1)=5.916961e-001;
n=48; farx(n+1)=2.292977e-001; foe(n+1)=4.681676e+000; krok(n+1)=4.250100e+000; ng(n+1)=3.589241e-001;
n=49; farx(n+1)=2.289772e-001; foe(n+1)=4.791440e+000; krok(n+1)=2.208206e+000; ng(n+1)=1.285051e+000;
n=50; farx(n+1)=2.287137e-001; foe(n+1)=5.138794e+000; krok(n+1)=9.909022e-001; ng(n+1)=5.770399e-001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
