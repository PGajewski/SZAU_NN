%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.008326e+002; foe(n+1)=2.106528e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.701053e+002; foe(n+1)=1.770868e+002; krok(n+1)=5.202718e-004; ng(n+1)=8.624633e+002;
n=2; farx(n+1)=7.496575e+001; foe(n+1)=6.955134e+001; krok(n+1)=1.208515e-002; ng(n+1)=4.741004e+002;
n=3; farx(n+1)=6.707749e+001; foe(n+1)=6.430567e+001; krok(n+1)=4.634049e-004; ng(n+1)=6.658118e+002;
n=4; farx(n+1)=6.515722e+001; foe(n+1)=6.343693e+001; krok(n+1)=1.164626e-003; ng(n+1)=1.987050e+002;
n=5; farx(n+1)=1.855621e+001; foe(n+1)=5.203853e+001; krok(n+1)=3.012318e-002; ng(n+1)=9.645782e+001;
n=6; farx(n+1)=7.050864e+000; foe(n+1)=4.601960e+001; krok(n+1)=3.248447e-003; ng(n+1)=1.053321e+003;
n=7; farx(n+1)=4.078453e+000; foe(n+1)=3.802749e+001; krok(n+1)=1.772228e-003; ng(n+1)=2.349615e+003;
n=8; farx(n+1)=4.205817e+000; foe(n+1)=3.777197e+001; krok(n+1)=8.233132e-005; ng(n+1)=5.148408e+003;
n=9; farx(n+1)=4.205318e+000; foe(n+1)=3.757418e+001; krok(n+1)=1.688447e-003; ng(n+1)=4.915025e+003;
n=10; farx(n+1)=5.099392e+000; foe(n+1)=3.608410e+001; krok(n+1)=1.457199e-003; ng(n+1)=4.927310e+003;
n=11; farx(n+1)=6.926609e+000; foe(n+1)=3.177518e+001; krok(n+1)=2.129617e-003; ng(n+1)=4.366314e+003;
n=12; farx(n+1)=7.975333e+000; foe(n+1)=3.018165e+001; krok(n+1)=1.185775e-003; ng(n+1)=2.722310e+003;
n=13; farx(n+1)=9.161513e+000; foe(n+1)=2.810458e+001; krok(n+1)=8.443488e-003; ng(n+1)=1.719074e+003;
n=14; farx(n+1)=9.832275e+000; foe(n+1)=2.526775e+001; krok(n+1)=1.853270e-002; ng(n+1)=1.072944e+003;
n=15; farx(n+1)=1.013302e+001; foe(n+1)=2.188034e+001; krok(n+1)=1.464637e-003; ng(n+1)=1.548760e+003;
n=16; farx(n+1)=9.945888e+000; foe(n+1)=2.112864e+001; krok(n+1)=1.104943e-003; ng(n+1)=5.942966e+002;
n=17; farx(n+1)=8.993745e+000; foe(n+1)=1.789253e+001; krok(n+1)=6.700076e-003; ng(n+1)=3.023784e+002;
n=18; farx(n+1)=8.421115e+000; foe(n+1)=1.617050e+001; krok(n+1)=6.516589e-003; ng(n+1)=4.692966e+002;
n=19; farx(n+1)=7.577782e+000; foe(n+1)=1.414946e+001; krok(n+1)=2.041615e-003; ng(n+1)=4.790671e+002;
n=20; farx(n+1)=7.441084e+000; foe(n+1)=1.390487e+001; krok(n+1)=1.329544e-003; ng(n+1)=5.591294e+002;
n=21; farx(n+1)=6.003441e+000; foe(n+1)=1.218959e+001; krok(n+1)=2.527804e-002; ng(n+1)=3.209989e+002;
n=22; farx(n+1)=5.799304e+000; foe(n+1)=1.184316e+001; krok(n+1)=4.692985e-003; ng(n+1)=2.974556e+002;
n=23; farx(n+1)=5.017498e+000; foe(n+1)=1.042805e+001; krok(n+1)=5.318174e-003; ng(n+1)=4.677333e+002;
n=24; farx(n+1)=4.162320e+000; foe(n+1)=8.794316e+000; krok(n+1)=2.701093e-003; ng(n+1)=7.323138e+002;
n=25; farx(n+1)=3.693146e+000; foe(n+1)=7.852689e+000; krok(n+1)=2.213894e-003; ng(n+1)=7.150820e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.692103e+000; foe(n+1)=7.805885e+000; krok(n+1)=1.611823e-005; ng(n+1)=2.388826e+002;
n=27; farx(n+1)=3.687808e+000; foe(n+1)=7.786602e+000; krok(n+1)=1.856031e-005; ng(n+1)=1.466625e+002;
n=28; farx(n+1)=3.640774e+000; foe(n+1)=7.565612e+000; krok(n+1)=3.870864e-004; ng(n+1)=1.068546e+002;
n=29; farx(n+1)=2.635833e+000; foe(n+1)=5.211103e+000; krok(n+1)=5.414124e-003; ng(n+1)=1.048733e+002;
n=30; farx(n+1)=2.545236e+000; foe(n+1)=4.962045e+000; krok(n+1)=2.080994e-003; ng(n+1)=6.271257e+002;
n=31; farx(n+1)=2.264833e+000; foe(n+1)=4.124779e+000; krok(n+1)=2.254077e-003; ng(n+1)=7.543778e+002;
n=32; farx(n+1)=2.057950e+000; foe(n+1)=3.937879e+000; krok(n+1)=6.699412e-003; ng(n+1)=2.227572e+002;
n=33; farx(n+1)=1.409704e+000; foe(n+1)=2.984731e+000; krok(n+1)=2.804162e-003; ng(n+1)=5.815532e+002;
n=34; farx(n+1)=1.283897e+000; foe(n+1)=2.595114e+000; krok(n+1)=1.121665e-002; ng(n+1)=4.217919e+002;
n=35; farx(n+1)=1.196143e+000; foe(n+1)=2.269517e+000; krok(n+1)=5.680993e-003; ng(n+1)=3.019266e+002;
n=36; farx(n+1)=1.172931e+000; foe(n+1)=2.154542e+000; krok(n+1)=4.880194e-003; ng(n+1)=4.996794e+002;
n=37; farx(n+1)=1.099519e+000; foe(n+1)=2.007302e+000; krok(n+1)=4.509565e-003; ng(n+1)=2.822510e+002;
n=38; farx(n+1)=1.025456e+000; foe(n+1)=1.916673e+000; krok(n+1)=1.219985e-002; ng(n+1)=8.476987e+001;
n=39; farx(n+1)=9.429938e-001; foe(n+1)=1.819992e+000; krok(n+1)=1.473291e-002; ng(n+1)=1.855566e+002;
n=40; farx(n+1)=8.274203e-001; foe(n+1)=1.724548e+000; krok(n+1)=8.518466e-003; ng(n+1)=2.672979e+002;
n=41; farx(n+1)=6.986505e-001; foe(n+1)=1.545296e+000; krok(n+1)=2.262062e-002; ng(n+1)=4.425002e+002;
n=42; farx(n+1)=6.660563e-001; foe(n+1)=1.445624e+000; krok(n+1)=2.896961e-002; ng(n+1)=9.916224e+001;
n=43; farx(n+1)=6.371482e-001; foe(n+1)=1.365816e+000; krok(n+1)=5.557598e-003; ng(n+1)=3.869859e+002;
n=44; farx(n+1)=6.122784e-001; foe(n+1)=1.325388e+000; krok(n+1)=1.167289e-002; ng(n+1)=9.925333e+001;
n=45; farx(n+1)=6.053568e-001; foe(n+1)=1.293714e+000; krok(n+1)=2.331822e-002; ng(n+1)=1.359264e+002;
n=46; farx(n+1)=5.892361e-001; foe(n+1)=1.237241e+000; krok(n+1)=7.356694e-002; ng(n+1)=6.595654e+001;
n=47; farx(n+1)=5.645143e-001; foe(n+1)=1.208627e+000; krok(n+1)=6.074057e-002; ng(n+1)=1.635556e+002;
n=48; farx(n+1)=5.359882e-001; foe(n+1)=1.174810e+000; krok(n+1)=9.228634e-002; ng(n+1)=9.484575e+001;
n=49; farx(n+1)=5.260260e-001; foe(n+1)=1.131753e+000; krok(n+1)=1.046893e-001; ng(n+1)=6.882930e+001;
n=50; farx(n+1)=5.274239e-001; foe(n+1)=1.102972e+000; krok(n+1)=3.586741e-002; ng(n+1)=1.791272e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
