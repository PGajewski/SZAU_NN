%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.364088e+002; foe(n+1)=2.317977e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.779541e+002; foe(n+1)=1.749003e+002; krok(n+1)=5.143592e-004; ng(n+1)=1.007261e+003;
n=2; farx(n+1)=6.023099e+001; foe(n+1)=6.193414e+001; krok(n+1)=1.082825e-002; ng(n+1)=4.278479e+002;
n=3; farx(n+1)=5.765499e+001; foe(n+1)=6.161644e+001; krok(n+1)=1.469780e-003; ng(n+1)=9.270453e+001;
n=4; farx(n+1)=3.872764e+000; foe(n+1)=3.455422e+001; krok(n+1)=2.119383e-002; ng(n+1)=1.321248e+002;
n=5; farx(n+1)=3.379405e+000; foe(n+1)=3.423430e+001; krok(n+1)=4.075597e-006; ng(n+1)=2.375745e+003;
n=6; farx(n+1)=3.290760e+000; foe(n+1)=3.407587e+001; krok(n+1)=8.028344e-004; ng(n+1)=2.989172e+003;
n=7; farx(n+1)=5.375311e+000; foe(n+1)=2.723003e+001; krok(n+1)=2.981463e-002; ng(n+1)=2.906270e+003;
n=8; farx(n+1)=6.156867e+000; foe(n+1)=2.545473e+001; krok(n+1)=1.760941e-004; ng(n+1)=2.135888e+003;
n=9; farx(n+1)=6.620761e+000; foe(n+1)=2.396588e+001; krok(n+1)=2.634602e-003; ng(n+1)=1.474826e+003;
n=10; farx(n+1)=7.234174e+000; foe(n+1)=2.021066e+001; krok(n+1)=4.150488e-003; ng(n+1)=7.849242e+002;
n=11; farx(n+1)=6.181521e+000; foe(n+1)=1.755363e+001; krok(n+1)=1.058808e-002; ng(n+1)=4.828226e+002;
n=12; farx(n+1)=5.096677e+000; foe(n+1)=1.449566e+001; krok(n+1)=3.572423e-003; ng(n+1)=1.143073e+003;
n=13; farx(n+1)=4.317053e+000; foe(n+1)=1.330279e+001; krok(n+1)=5.414124e-003; ng(n+1)=1.478653e+002;
n=14; farx(n+1)=2.812435e+000; foe(n+1)=1.025934e+001; krok(n+1)=1.290032e-002; ng(n+1)=7.455831e+002;
n=15; farx(n+1)=2.596978e+000; foe(n+1)=9.997004e+000; krok(n+1)=2.594055e-004; ng(n+1)=1.003452e+003;
n=16; farx(n+1)=1.967630e+000; foe(n+1)=8.745981e+000; krok(n+1)=8.076024e-003; ng(n+1)=1.062770e+003;
n=17; farx(n+1)=1.294426e+000; foe(n+1)=6.783845e+000; krok(n+1)=2.081087e-003; ng(n+1)=2.027518e+003;
n=18; farx(n+1)=1.161741e+000; foe(n+1)=6.352774e+000; krok(n+1)=1.675019e-003; ng(n+1)=1.484380e+003;
n=19; farx(n+1)=9.011067e-001; foe(n+1)=5.666175e+000; krok(n+1)=1.526430e-002; ng(n+1)=9.739175e+002;
n=20; farx(n+1)=8.006952e-001; foe(n+1)=5.212906e+000; krok(n+1)=3.303815e-003; ng(n+1)=9.959362e+002;
n=21; farx(n+1)=7.516990e-001; foe(n+1)=4.880137e+000; krok(n+1)=1.588254e-003; ng(n+1)=9.725781e+002;
n=22; farx(n+1)=7.094840e-001; foe(n+1)=4.299622e+000; krok(n+1)=1.448480e-002; ng(n+1)=8.709615e+001;
n=23; farx(n+1)=6.974377e-001; foe(n+1)=4.024039e+000; krok(n+1)=6.607631e-003; ng(n+1)=5.960043e+002;
n=24; farx(n+1)=6.990509e-001; foe(n+1)=3.592686e+000; krok(n+1)=5.999763e-003; ng(n+1)=3.340515e+002;
n=25; farx(n+1)=7.275898e-001; foe(n+1)=3.357412e+000; krok(n+1)=5.608324e-003; ng(n+1)=6.466863e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.263384e-001; foe(n+1)=3.268038e+000; krok(n+1)=9.999543e-006; ng(n+1)=4.614386e+002;
n=27; farx(n+1)=7.252796e-001; foe(n+1)=3.262721e+000; krok(n+1)=4.659371e-006; ng(n+1)=1.518006e+002;
n=28; farx(n+1)=7.345535e-001; foe(n+1)=3.059693e+000; krok(n+1)=1.427772e-003; ng(n+1)=6.896876e+001;
n=29; farx(n+1)=6.930082e-001; foe(n+1)=2.766237e+000; krok(n+1)=4.988661e-004; ng(n+1)=1.216787e+002;
n=30; farx(n+1)=7.248373e-001; foe(n+1)=2.269777e+000; krok(n+1)=5.711090e-003; ng(n+1)=7.050255e+001;
n=31; farx(n+1)=7.875125e-001; foe(n+1)=2.010069e+000; krok(n+1)=5.062842e-003; ng(n+1)=5.522193e+002;
n=32; farx(n+1)=8.036513e-001; foe(n+1)=1.943547e+000; krok(n+1)=2.774090e-003; ng(n+1)=2.563368e+002;
n=33; farx(n+1)=7.388128e-001; foe(n+1)=1.772221e+000; krok(n+1)=2.896961e-002; ng(n+1)=7.597315e+001;
n=34; farx(n+1)=7.009759e-001; foe(n+1)=1.676577e+000; krok(n+1)=5.478088e-003; ng(n+1)=3.598250e+002;
n=35; farx(n+1)=7.008097e-001; foe(n+1)=1.629643e+000; krok(n+1)=2.502768e-002; ng(n+1)=6.756126e+001;
n=36; farx(n+1)=6.979643e-001; foe(n+1)=1.591948e+000; krok(n+1)=9.127324e-003; ng(n+1)=3.253149e+002;
n=37; farx(n+1)=6.903293e-001; foe(n+1)=1.543345e+000; krok(n+1)=8.420994e-003; ng(n+1)=2.839988e+002;
n=38; farx(n+1)=6.394173e-001; foe(n+1)=1.322620e+000; krok(n+1)=3.962977e-002; ng(n+1)=3.583621e+002;
n=39; farx(n+1)=5.907193e-001; foe(n+1)=1.171444e+000; krok(n+1)=1.079418e-001; ng(n+1)=1.892223e+002;
n=40; farx(n+1)=5.860483e-001; foe(n+1)=1.134159e+000; krok(n+1)=4.191618e-003; ng(n+1)=2.750302e+002;
n=41; farx(n+1)=5.833878e-001; foe(n+1)=1.115757e+000; krok(n+1)=5.829338e-003; ng(n+1)=1.443223e+002;
n=42; farx(n+1)=5.514396e-001; foe(n+1)=9.702761e-001; krok(n+1)=1.006999e-001; ng(n+1)=4.396042e+001;
n=43; farx(n+1)=5.485254e-001; foe(n+1)=9.497025e-001; krok(n+1)=1.970836e-003; ng(n+1)=2.636512e+002;
n=44; farx(n+1)=5.461111e-001; foe(n+1)=9.270525e-001; krok(n+1)=4.372259e-003; ng(n+1)=1.306135e+002;
n=45; farx(n+1)=5.171357e-001; foe(n+1)=9.039063e-001; krok(n+1)=2.548582e-002; ng(n+1)=9.492833e+001;
n=46; farx(n+1)=4.686116e-001; foe(n+1)=8.535073e-001; krok(n+1)=3.595477e-002; ng(n+1)=2.384594e+002;
n=47; farx(n+1)=4.337968e-001; foe(n+1)=8.235692e-001; krok(n+1)=4.030924e-002; ng(n+1)=2.115784e+002;
n=48; farx(n+1)=3.268435e-001; foe(n+1)=7.268764e-001; krok(n+1)=6.024636e-002; ng(n+1)=2.262284e+002;
n=49; farx(n+1)=3.176285e-001; foe(n+1)=7.186561e-001; krok(n+1)=4.696827e-003; ng(n+1)=2.259813e+002;
n=50; farx(n+1)=3.144576e-001; foe(n+1)=7.086912e-001; krok(n+1)=2.142359e-002; ng(n+1)=6.091844e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
