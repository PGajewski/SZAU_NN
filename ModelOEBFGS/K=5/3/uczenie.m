%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.756918e+002; foe(n+1)=1.773846e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.662715e+002; foe(n+1)=1.679891e+002; krok(n+1)=6.510435e-004; ng(n+1)=3.219920e+002;
n=2; farx(n+1)=7.441187e+001; foe(n+1)=7.698055e+001; krok(n+1)=7.442795e-003; ng(n+1)=2.565780e+002;
n=3; farx(n+1)=6.682220e+001; foe(n+1)=6.649965e+001; krok(n+1)=1.995464e-003; ng(n+1)=4.389020e+002;
n=4; farx(n+1)=6.516115e+001; foe(n+1)=6.032441e+001; krok(n+1)=4.312903e-003; ng(n+1)=3.853150e+002;
n=5; farx(n+1)=4.960201e+001; foe(n+1)=5.695213e+001; krok(n+1)=2.319637e-002; ng(n+1)=6.068716e+001;
n=6; farx(n+1)=2.476114e+001; foe(n+1)=5.146490e+001; krok(n+1)=2.107682e-002; ng(n+1)=1.940640e+002;
n=7; farx(n+1)=7.292764e+000; foe(n+1)=4.180214e+001; krok(n+1)=3.888965e-003; ng(n+1)=8.146945e+002;
n=8; farx(n+1)=6.896007e+000; foe(n+1)=4.144572e+001; krok(n+1)=3.936449e-005; ng(n+1)=2.894830e+003;
n=9; farx(n+1)=7.296861e+000; foe(n+1)=4.101475e+001; krok(n+1)=4.974973e-003; ng(n+1)=3.200407e+003;
n=10; farx(n+1)=8.432206e+000; foe(n+1)=3.713609e+001; krok(n+1)=1.353531e-003; ng(n+1)=2.892371e+003;
n=11; farx(n+1)=8.643104e+000; foe(n+1)=3.629488e+001; krok(n+1)=1.234892e-003; ng(n+1)=2.015046e+003;
n=12; farx(n+1)=9.853182e+000; foe(n+1)=2.791991e+001; krok(n+1)=1.843937e-002; ng(n+1)=2.135022e+003;
n=13; farx(n+1)=1.007280e+001; foe(n+1)=2.715184e+001; krok(n+1)=1.133637e-003; ng(n+1)=1.054158e+003;
n=14; farx(n+1)=1.065981e+001; foe(n+1)=2.640034e+001; krok(n+1)=3.473809e-003; ng(n+1)=1.289144e+003;
n=15; farx(n+1)=1.109474e+001; foe(n+1)=2.523228e+001; krok(n+1)=8.647968e-003; ng(n+1)=8.437778e+002;
n=16; farx(n+1)=1.180026e+001; foe(n+1)=2.237960e+001; krok(n+1)=2.900728e-002; ng(n+1)=6.289298e+002;
n=17; farx(n+1)=1.204076e+001; foe(n+1)=2.124182e+001; krok(n+1)=2.000182e-002; ng(n+1)=3.352395e+002;
n=18; farx(n+1)=9.973844e+000; foe(n+1)=1.849274e+001; krok(n+1)=2.096657e-002; ng(n+1)=2.698676e+002;
n=19; farx(n+1)=7.105567e+000; foe(n+1)=1.330869e+001; krok(n+1)=6.607631e-003; ng(n+1)=8.229030e+002;
n=20; farx(n+1)=6.762380e+000; foe(n+1)=1.297347e+001; krok(n+1)=3.248447e-003; ng(n+1)=5.382839e+002;
n=21; farx(n+1)=5.847693e+000; foe(n+1)=1.227612e+001; krok(n+1)=8.155298e-003; ng(n+1)=4.674249e+002;
n=22; farx(n+1)=2.767238e+000; foe(n+1)=8.467663e+000; krok(n+1)=3.933136e-002; ng(n+1)=5.192322e+002;
n=23; farx(n+1)=2.015758e+000; foe(n+1)=7.444474e+000; krok(n+1)=3.820826e-002; ng(n+1)=1.931999e+002;
n=24; farx(n+1)=1.367355e+000; foe(n+1)=6.087286e+000; krok(n+1)=1.818254e-001; ng(n+1)=4.780021e+002;
n=25; farx(n+1)=1.014156e+000; foe(n+1)=5.152237e+000; krok(n+1)=2.594655e-001; ng(n+1)=6.157879e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.031776e+000; foe(n+1)=4.492041e+000; krok(n+1)=9.667524e-006; ng(n+1)=1.047759e+003;
n=27; farx(n+1)=1.010543e+000; foe(n+1)=4.331775e+000; krok(n+1)=7.663580e-005; ng(n+1)=1.599253e+002;
n=28; farx(n+1)=8.609832e-001; foe(n+1)=3.695265e+000; krok(n+1)=9.173286e-003; ng(n+1)=4.011058e+001;
n=29; farx(n+1)=7.510084e-001; foe(n+1)=3.293635e+000; krok(n+1)=1.616776e-004; ng(n+1)=1.901501e+002;
n=30; farx(n+1)=6.507866e-001; foe(n+1)=2.618724e+000; krok(n+1)=4.889122e-003; ng(n+1)=4.002829e+002;
n=31; farx(n+1)=6.347949e-001; foe(n+1)=2.386347e+000; krok(n+1)=2.224854e-003; ng(n+1)=4.313008e+002;
n=32; farx(n+1)=6.416756e-001; foe(n+1)=2.153393e+000; krok(n+1)=1.547432e-002; ng(n+1)=1.074579e+002;
n=33; farx(n+1)=6.042274e-001; foe(n+1)=1.991942e+000; krok(n+1)=1.140023e-002; ng(n+1)=7.868325e+001;
n=34; farx(n+1)=5.875523e-001; foe(n+1)=1.907013e+000; krok(n+1)=3.407387e-002; ng(n+1)=1.253884e+002;
n=35; farx(n+1)=5.771289e-001; foe(n+1)=1.819850e+000; krok(n+1)=7.598245e-003; ng(n+1)=1.174273e+002;
n=36; farx(n+1)=5.439080e-001; foe(n+1)=1.702908e+000; krok(n+1)=2.571418e-002; ng(n+1)=1.873582e+002;
n=37; farx(n+1)=5.443086e-001; foe(n+1)=1.608314e+000; krok(n+1)=7.712744e-003; ng(n+1)=1.256140e+002;
n=38; farx(n+1)=5.358092e-001; foe(n+1)=1.574855e+000; krok(n+1)=1.142218e-002; ng(n+1)=1.262435e+002;
n=39; farx(n+1)=5.232187e-001; foe(n+1)=1.493179e+000; krok(n+1)=2.861011e-002; ng(n+1)=1.624818e+002;
n=40; farx(n+1)=5.386301e-001; foe(n+1)=1.440382e+000; krok(n+1)=1.032026e-001; ng(n+1)=1.113759e+002;
n=41; farx(n+1)=5.118349e-001; foe(n+1)=1.335317e+000; krok(n+1)=8.153064e-002; ng(n+1)=7.497561e+001;
n=42; farx(n+1)=5.214625e-001; foe(n+1)=1.296664e+000; krok(n+1)=2.142359e-002; ng(n+1)=1.057668e+002;
n=43; farx(n+1)=4.950143e-001; foe(n+1)=1.253398e+000; krok(n+1)=1.481341e-001; ng(n+1)=8.389516e+001;
n=44; farx(n+1)=4.521809e-001; foe(n+1)=1.175963e+000; krok(n+1)=1.380129e-001; ng(n+1)=1.584245e+002;
n=45; farx(n+1)=4.941274e-001; foe(n+1)=1.020296e+000; krok(n+1)=2.866206e-001; ng(n+1)=8.761383e+001;
n=46; farx(n+1)=4.865986e-001; foe(n+1)=9.900638e-001; krok(n+1)=1.125137e-001; ng(n+1)=4.082210e+001;
n=47; farx(n+1)=4.667252e-001; foe(n+1)=9.640459e-001; krok(n+1)=7.660919e-002; ng(n+1)=8.202111e+001;
n=48; farx(n+1)=4.611139e-001; foe(n+1)=9.289948e-001; krok(n+1)=1.981558e-001; ng(n+1)=1.106277e+002;
n=49; farx(n+1)=4.413865e-001; foe(n+1)=9.090601e-001; krok(n+1)=3.240219e-001; ng(n+1)=2.653682e+001;
n=50; farx(n+1)=4.435670e-001; foe(n+1)=8.943848e-001; krok(n+1)=2.409855e-001; ng(n+1)=3.808055e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
