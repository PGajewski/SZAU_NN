%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.938537e+002; foe(n+1)=2.955811e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.734115e+002; foe(n+1)=1.738669e+002; krok(n+1)=4.927090e-004; ng(n+1)=7.462399e+002;
n=2; farx(n+1)=6.623392e+001; foe(n+1)=6.456766e+001; krok(n+1)=1.640862e-002; ng(n+1)=1.363055e+002;
n=3; farx(n+1)=6.251853e+001; foe(n+1)=5.990408e+001; krok(n+1)=1.420248e-003; ng(n+1)=2.127569e+002;
n=4; farx(n+1)=6.100996e+001; foe(n+1)=5.877043e+001; krok(n+1)=2.678603e-003; ng(n+1)=8.949869e+001;
n=5; farx(n+1)=2.743498e+001; foe(n+1)=4.818302e+001; krok(n+1)=2.896961e-002; ng(n+1)=6.774154e+001;
n=6; farx(n+1)=1.096785e+001; foe(n+1)=3.481114e+001; krok(n+1)=6.752063e-003; ng(n+1)=4.648550e+002;
n=7; farx(n+1)=1.096179e+001; foe(n+1)=3.428664e+001; krok(n+1)=1.109357e-004; ng(n+1)=1.131419e+003;
n=8; farx(n+1)=1.043787e+001; foe(n+1)=3.367295e+001; krok(n+1)=6.480489e-003; ng(n+1)=9.737195e+002;
n=9; farx(n+1)=1.031220e+001; foe(n+1)=3.210165e+001; krok(n+1)=3.400118e-003; ng(n+1)=8.691811e+002;
n=10; farx(n+1)=1.011209e+001; foe(n+1)=3.028709e+001; krok(n+1)=1.007731e-002; ng(n+1)=4.806365e+002;
n=11; farx(n+1)=1.090007e+001; foe(n+1)=2.926533e+001; krok(n+1)=2.923005e-003; ng(n+1)=4.492786e+002;
n=12; farx(n+1)=1.148820e+001; foe(n+1)=2.694480e+001; krok(n+1)=5.421512e-002; ng(n+1)=4.041629e+002;
n=13; farx(n+1)=5.183375e+000; foe(n+1)=1.883707e+001; krok(n+1)=3.337297e-001; ng(n+1)=2.338029e+002;
n=14; farx(n+1)=5.446939e+000; foe(n+1)=1.815384e+001; krok(n+1)=1.825465e-002; ng(n+1)=2.827619e+002;
n=15; farx(n+1)=4.427714e+000; foe(n+1)=1.472102e+001; krok(n+1)=5.234463e-002; ng(n+1)=2.804645e+002;
n=16; farx(n+1)=4.235445e+000; foe(n+1)=1.378585e+001; krok(n+1)=7.266281e-002; ng(n+1)=1.474814e+002;
n=17; farx(n+1)=3.669728e+000; foe(n+1)=1.253535e+001; krok(n+1)=1.297775e-001; ng(n+1)=2.607961e+002;
n=18; farx(n+1)=2.915145e+000; foe(n+1)=1.184646e+001; krok(n+1)=1.102898e-001; ng(n+1)=1.549408e+002;
n=19; farx(n+1)=1.812009e+000; foe(n+1)=9.430431e+000; krok(n+1)=1.611570e-001; ng(n+1)=1.987525e+002;
n=20; farx(n+1)=1.185007e+000; foe(n+1)=6.158804e+000; krok(n+1)=6.041087e-001; ng(n+1)=1.521969e+002;
n=21; farx(n+1)=1.149744e+000; foe(n+1)=5.532809e+000; krok(n+1)=9.513510e-002; ng(n+1)=1.766917e+002;
n=22; farx(n+1)=1.114843e+000; foe(n+1)=5.391061e+000; krok(n+1)=2.114442e-001; ng(n+1)=1.156902e+002;
n=23; farx(n+1)=1.021059e+000; foe(n+1)=5.277766e+000; krok(n+1)=4.188592e-001; ng(n+1)=5.218574e+001;
n=24; farx(n+1)=8.526309e-001; foe(n+1)=4.863669e+000; krok(n+1)=3.667805e+000; ng(n+1)=3.974638e+001;
n=25; farx(n+1)=7.438966e-001; foe(n+1)=4.610267e+000; krok(n+1)=5.219391e-001; ng(n+1)=1.192531e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.277218e-001; foe(n+1)=4.491128e+000; krok(n+1)=1.611741e-005; ng(n+1)=1.725197e+002;
n=27; farx(n+1)=7.200900e-001; foe(n+1)=4.394770e+000; krok(n+1)=7.043991e-005; ng(n+1)=1.010911e+002;
n=28; farx(n+1)=7.371183e-001; foe(n+1)=4.342306e+000; krok(n+1)=1.616776e-004; ng(n+1)=5.118635e+001;
n=29; farx(n+1)=7.690732e-001; foe(n+1)=3.951466e+000; krok(n+1)=1.121665e-002; ng(n+1)=1.537181e+001;
n=30; farx(n+1)=7.276529e-001; foe(n+1)=3.788266e+000; krok(n+1)=1.226153e-002; ng(n+1)=2.968631e+001;
n=31; farx(n+1)=7.225694e-001; foe(n+1)=3.710290e+000; krok(n+1)=7.158549e-002; ng(n+1)=1.614961e+002;
n=32; farx(n+1)=7.023476e-001; foe(n+1)=3.681765e+000; krok(n+1)=1.450364e-002; ng(n+1)=4.693304e+001;
n=33; farx(n+1)=6.947870e-001; foe(n+1)=3.615526e+000; krok(n+1)=1.953985e-002; ng(n+1)=7.852927e+001;
n=34; farx(n+1)=6.815427e-001; foe(n+1)=3.517280e+000; krok(n+1)=5.536703e-002; ng(n+1)=8.655519e+001;
n=35; farx(n+1)=6.727664e-001; foe(n+1)=3.500027e+000; krok(n+1)=2.223039e-002; ng(n+1)=1.704609e+002;
n=36; farx(n+1)=6.775771e-001; foe(n+1)=3.358051e+000; krok(n+1)=2.682636e-001; ng(n+1)=1.250807e+002;
n=37; farx(n+1)=6.540321e-001; foe(n+1)=3.176239e+000; krok(n+1)=2.073757e-001; ng(n+1)=8.425143e+001;
n=38; farx(n+1)=5.477548e-001; foe(n+1)=2.843495e+000; krok(n+1)=6.404647e-001; ng(n+1)=1.307900e+002;
n=39; farx(n+1)=5.077927e-001; foe(n+1)=2.708022e+000; krok(n+1)=1.686145e-001; ng(n+1)=2.179448e+002;
n=40; farx(n+1)=4.346149e-001; foe(n+1)=2.565724e+000; krok(n+1)=2.942678e-001; ng(n+1)=4.671392e+001;
n=41; farx(n+1)=3.607566e-001; foe(n+1)=2.361078e+000; krok(n+1)=2.670983e-001; ng(n+1)=1.283411e+002;
n=42; farx(n+1)=3.419804e-001; foe(n+1)=2.167526e+000; krok(n+1)=1.556123e-001; ng(n+1)=7.793392e+001;
n=43; farx(n+1)=3.310820e-001; foe(n+1)=2.076098e+000; krok(n+1)=2.506731e-001; ng(n+1)=1.648798e+002;
n=44; farx(n+1)=3.567943e-001; foe(n+1)=1.599714e+000; krok(n+1)=2.451503e-001; ng(n+1)=2.586643e+002;
n=45; farx(n+1)=3.260496e-001; foe(n+1)=1.465199e+000; krok(n+1)=1.357860e-001; ng(n+1)=1.333471e+002;
n=46; farx(n+1)=3.369698e-001; foe(n+1)=1.247515e+000; krok(n+1)=2.990259e-001; ng(n+1)=1.738751e+002;
n=47; farx(n+1)=3.419203e-001; foe(n+1)=1.124167e+000; krok(n+1)=1.480267e-001; ng(n+1)=2.821794e+002;
n=48; farx(n+1)=3.426912e-001; foe(n+1)=1.060557e+000; krok(n+1)=1.919924e-001; ng(n+1)=1.005432e+002;
n=49; farx(n+1)=3.332261e-001; foe(n+1)=1.029487e+000; krok(n+1)=3.589327e-001; ng(n+1)=1.158415e+002;
n=50; farx(n+1)=3.148458e-001; foe(n+1)=1.013884e+000; krok(n+1)=1.775417e-001; ng(n+1)=4.033611e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
