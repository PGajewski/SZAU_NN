%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.988920e+002; foe(n+1)=2.010714e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.767841e+002; foe(n+1)=1.790868e+002; krok(n+1)=5.226755e-004; ng(n+1)=5.645825e+002;
n=2; farx(n+1)=9.656380e+001; foe(n+1)=9.828161e+001; krok(n+1)=2.502130e-002; ng(n+1)=2.554644e+002;
n=3; farx(n+1)=5.578274e+001; foe(n+1)=5.906439e+001; krok(n+1)=3.764443e-004; ng(n+1)=1.323330e+003;
n=4; farx(n+1)=5.268833e+001; foe(n+1)=5.741523e+001; krok(n+1)=8.631728e-004; ng(n+1)=2.297194e+002;
n=5; farx(n+1)=2.738127e+001; foe(n+1)=4.580106e+001; krok(n+1)=1.279818e-002; ng(n+1)=1.488824e+002;
n=6; farx(n+1)=2.261782e+001; foe(n+1)=3.975434e+001; krok(n+1)=5.852382e-003; ng(n+1)=8.661970e+002;
n=7; farx(n+1)=2.191611e+001; foe(n+1)=3.718387e+001; krok(n+1)=3.303309e-003; ng(n+1)=6.355815e+002;
n=8; farx(n+1)=2.061578e+001; foe(n+1)=3.555704e+001; krok(n+1)=9.495353e-003; ng(n+1)=3.511844e+002;
n=9; farx(n+1)=1.647089e+001; foe(n+1)=3.275211e+001; krok(n+1)=1.376948e-002; ng(n+1)=1.510883e+002;
n=10; farx(n+1)=1.525340e+001; foe(n+1)=3.104335e+001; krok(n+1)=6.130766e-003; ng(n+1)=1.156555e+002;
n=11; farx(n+1)=1.367883e+001; foe(n+1)=2.723106e+001; krok(n+1)=1.000091e-002; ng(n+1)=4.520361e+002;
n=12; farx(n+1)=1.305265e+001; foe(n+1)=2.642132e+001; krok(n+1)=3.739948e-003; ng(n+1)=3.126410e+002;
n=13; farx(n+1)=1.143001e+001; foe(n+1)=2.442317e+001; krok(n+1)=1.881038e-002; ng(n+1)=3.735148e+002;
n=14; farx(n+1)=9.543802e+000; foe(n+1)=2.317169e+001; krok(n+1)=7.191611e-003; ng(n+1)=3.432250e+002;
n=15; farx(n+1)=8.007098e+000; foe(n+1)=2.163598e+001; krok(n+1)=3.709130e-003; ng(n+1)=4.935047e+002;
n=16; farx(n+1)=6.430389e+000; foe(n+1)=1.988534e+001; krok(n+1)=4.264608e-003; ng(n+1)=2.624158e+002;
n=17; farx(n+1)=5.350941e+000; foe(n+1)=1.806828e+001; krok(n+1)=1.095618e-002; ng(n+1)=6.893626e+002;
n=18; farx(n+1)=4.759607e+000; foe(n+1)=1.618734e+001; krok(n+1)=8.258271e-004; ng(n+1)=1.367669e+003;
n=19; farx(n+1)=4.436435e+000; foe(n+1)=1.522972e+001; krok(n+1)=3.516052e-003; ng(n+1)=1.304843e+003;
n=20; farx(n+1)=4.193968e+000; foe(n+1)=1.471236e+001; krok(n+1)=9.385969e-003; ng(n+1)=6.693575e+002;
n=21; farx(n+1)=3.731869e+000; foe(n+1)=1.355271e+001; krok(n+1)=1.985729e-002; ng(n+1)=3.914384e+002;
n=22; farx(n+1)=2.994176e+000; foe(n+1)=9.527850e+000; krok(n+1)=1.448480e-002; ng(n+1)=5.989991e+002;
n=23; farx(n+1)=2.839961e+000; foe(n+1)=8.915083e+000; krok(n+1)=5.368339e-003; ng(n+1)=4.512934e+002;
n=24; farx(n+1)=2.790137e+000; foe(n+1)=8.795507e+000; krok(n+1)=1.849821e-003; ng(n+1)=2.854039e+002;
n=25; farx(n+1)=2.745115e+000; foe(n+1)=8.107211e+000; krok(n+1)=1.673711e-002; ng(n+1)=4.161834e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.752098e+000; foe(n+1)=7.955128e+000; krok(n+1)=1.109569e-005; ng(n+1)=4.441984e+002;
n=27; farx(n+1)=2.774068e+000; foe(n+1)=7.702533e+000; krok(n+1)=5.883434e-005; ng(n+1)=2.766226e+002;
n=28; farx(n+1)=2.665205e+000; foe(n+1)=7.043601e+000; krok(n+1)=1.078966e-004; ng(n+1)=3.055610e+002;
n=29; farx(n+1)=2.358935e+000; foe(n+1)=4.809697e+000; krok(n+1)=3.427028e-003; ng(n+1)=1.375223e+002;
n=30; farx(n+1)=2.185974e+000; foe(n+1)=4.355384e+000; krok(n+1)=4.505183e-003; ng(n+1)=5.439484e+002;
n=31; farx(n+1)=1.886385e+000; foe(n+1)=3.650838e+000; krok(n+1)=2.201622e-003; ng(n+1)=5.449274e+002;
n=32; farx(n+1)=1.595323e+000; foe(n+1)=2.840113e+000; krok(n+1)=5.636318e-003; ng(n+1)=7.160216e+002;
n=33; farx(n+1)=1.435084e+000; foe(n+1)=2.476998e+000; krok(n+1)=6.035177e-003; ng(n+1)=3.521585e+002;
n=34; farx(n+1)=1.372726e+000; foe(n+1)=2.259109e+000; krok(n+1)=5.680993e-003; ng(n+1)=1.869173e+002;
n=35; farx(n+1)=1.191348e+000; foe(n+1)=2.003149e+000; krok(n+1)=2.570124e-002; ng(n+1)=1.815523e+002;
n=36; farx(n+1)=9.794190e-001; foe(n+1)=1.651970e+000; krok(n+1)=6.503090e-002; ng(n+1)=8.616259e+001;
n=37; farx(n+1)=9.405974e-001; foe(n+1)=1.590876e+000; krok(n+1)=5.303205e-003; ng(n+1)=1.498250e+002;
n=38; farx(n+1)=8.515488e-001; foe(n+1)=1.471858e+000; krok(n+1)=9.801654e-003; ng(n+1)=1.412672e+002;
n=39; farx(n+1)=6.926657e-001; foe(n+1)=1.298131e+000; krok(n+1)=4.254539e-002; ng(n+1)=1.547894e+002;
n=40; farx(n+1)=6.234221e-001; foe(n+1)=1.248814e+000; krok(n+1)=3.006802e-002; ng(n+1)=6.482276e+001;
n=41; farx(n+1)=5.916557e-001; foe(n+1)=1.217959e+000; krok(n+1)=2.788482e-002; ng(n+1)=1.022307e+002;
n=42; farx(n+1)=5.283309e-001; foe(n+1)=1.089687e+000; krok(n+1)=4.681906e-002; ng(n+1)=8.190734e+001;
n=43; farx(n+1)=5.228153e-001; foe(n+1)=1.004875e+000; krok(n+1)=9.907791e-002; ng(n+1)=1.470286e+002;
n=44; farx(n+1)=4.987681e-001; foe(n+1)=9.116918e-001; krok(n+1)=5.918252e-002; ng(n+1)=1.687255e+002;
n=45; farx(n+1)=4.948838e-001; foe(n+1)=8.939496e-001; krok(n+1)=4.904612e-002; ng(n+1)=6.232950e+001;
n=46; farx(n+1)=4.937140e-001; foe(n+1)=8.273971e-001; krok(n+1)=1.962005e-001; ng(n+1)=1.056110e+002;
n=47; farx(n+1)=4.948819e-001; foe(n+1)=8.064564e-001; krok(n+1)=5.598693e-002; ng(n+1)=3.867886e+001;
n=48; farx(n+1)=4.947048e-001; foe(n+1)=7.721200e-001; krok(n+1)=6.688253e-002; ng(n+1)=1.393888e+002;
n=49; farx(n+1)=4.730343e-001; foe(n+1)=7.442863e-001; krok(n+1)=5.231840e-001; ng(n+1)=4.505413e+001;
n=50; farx(n+1)=4.607478e-001; foe(n+1)=7.320091e-001; krok(n+1)=1.952188e-001; ng(n+1)=2.960205e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
