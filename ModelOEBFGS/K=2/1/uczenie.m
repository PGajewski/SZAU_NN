%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.912483e+002; foe(n+1)=2.925609e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.805758e+002; foe(n+1)=1.812514e+002; krok(n+1)=4.988661e-004; ng(n+1)=6.520345e+002;
n=2; farx(n+1)=1.786003e+002; foe(n+1)=1.722948e+002; krok(n+1)=5.167850e-003; ng(n+1)=9.356695e+001;
n=3; farx(n+1)=7.244323e+001; foe(n+1)=6.094337e+001; krok(n+1)=9.258382e-003; ng(n+1)=1.600581e+002;
n=4; farx(n+1)=7.086483e+001; foe(n+1)=5.980168e+001; krok(n+1)=7.625735e-004; ng(n+1)=1.163085e+002;
n=5; farx(n+1)=5.754314e+001; foe(n+1)=5.766818e+001; krok(n+1)=1.725161e-002; ng(n+1)=5.521372e+001;
n=6; farx(n+1)=5.379779e+001; foe(n+1)=5.242102e+001; krok(n+1)=1.142218e-002; ng(n+1)=2.284176e+002;
n=7; farx(n+1)=4.918230e+001; foe(n+1)=4.602245e+001; krok(n+1)=1.160327e-002; ng(n+1)=2.385695e+002;
n=8; farx(n+1)=4.639943e+001; foe(n+1)=4.372541e+001; krok(n+1)=1.340015e-002; ng(n+1)=1.529650e+002;
n=9; farx(n+1)=4.668788e+001; foe(n+1)=4.225758e+001; krok(n+1)=1.919924e-001; ng(n+1)=1.456113e+002;
n=10; farx(n+1)=4.212438e+001; foe(n+1)=4.001318e+001; krok(n+1)=1.221144e-001; ng(n+1)=1.135891e+002;
n=11; farx(n+1)=3.925249e+001; foe(n+1)=3.909126e+001; krok(n+1)=5.576355e-002; ng(n+1)=1.282701e+002;
n=12; farx(n+1)=1.587913e+001; foe(n+1)=3.204437e+001; krok(n+1)=1.328755e+000; ng(n+1)=1.476093e+002;
n=13; farx(n+1)=5.337874e+000; foe(n+1)=2.689837e+001; krok(n+1)=4.448787e-001; ng(n+1)=2.531158e+002;
n=14; farx(n+1)=3.261157e+000; foe(n+1)=2.450168e+001; krok(n+1)=6.776944e-002; ng(n+1)=7.212932e+002;
n=15; farx(n+1)=3.299284e+000; foe(n+1)=2.364721e+001; krok(n+1)=2.243330e-002; ng(n+1)=1.066609e+003;
n=16; farx(n+1)=2.776245e+000; foe(n+1)=1.967810e+001; krok(n+1)=9.233170e-002; ng(n+1)=1.189894e+003;
n=17; farx(n+1)=1.228688e+000; foe(n+1)=1.007328e+001; krok(n+1)=6.614848e-001; ng(n+1)=8.912045e+002;
n=18; farx(n+1)=1.322421e+000; foe(n+1)=9.197784e+000; krok(n+1)=2.239477e-001; ng(n+1)=2.830965e+002;
n=19; farx(n+1)=1.078116e+000; foe(n+1)=8.660437e+000; krok(n+1)=7.382907e-001; ng(n+1)=1.893056e+002;
n=20; farx(n+1)=1.012720e+000; foe(n+1)=8.472253e+000; krok(n+1)=2.501044e-001; ng(n+1)=9.751913e+001;
n=21; farx(n+1)=9.906699e-001; foe(n+1)=8.348971e+000; krok(n+1)=7.203499e-001; ng(n+1)=1.048625e+002;
n=22; farx(n+1)=1.004501e+000; foe(n+1)=8.256682e+000; krok(n+1)=1.054352e+000; ng(n+1)=2.653080e+001;
n=23; farx(n+1)=1.041388e+000; foe(n+1)=7.746594e+000; krok(n+1)=3.765360e+000; ng(n+1)=6.715053e+001;
n=24; farx(n+1)=1.071947e+000; foe(n+1)=7.579288e+000; krok(n+1)=4.714530e-001; ng(n+1)=5.075063e+001;
n=25; farx(n+1)=1.101573e+000; foe(n+1)=7.350540e+000; krok(n+1)=8.674420e-001; ng(n+1)=4.523273e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.100653e+000; foe(n+1)=7.312744e+000; krok(n+1)=1.323611e-005; ng(n+1)=1.057020e+002;
n=27; farx(n+1)=1.086823e+000; foe(n+1)=7.290592e+000; krok(n+1)=1.629540e-004; ng(n+1)=2.969313e+001;
n=28; farx(n+1)=1.069649e+000; foe(n+1)=7.261364e+000; krok(n+1)=2.006209e-004; ng(n+1)=2.837624e+001;
n=29; farx(n+1)=1.101245e+000; foe(n+1)=7.139976e+000; krok(n+1)=9.447410e-003; ng(n+1)=9.797124e+000;
n=30; farx(n+1)=1.143102e+000; foe(n+1)=7.015291e+000; krok(n+1)=2.191235e-002; ng(n+1)=1.612003e+001;
n=31; farx(n+1)=1.141938e+000; foe(n+1)=6.985765e+000; krok(n+1)=4.438543e-002; ng(n+1)=8.837809e+001;
n=32; farx(n+1)=1.169571e+000; foe(n+1)=6.905429e+000; krok(n+1)=2.390821e-002; ng(n+1)=1.491654e+002;
n=33; farx(n+1)=1.156085e+000; foe(n+1)=6.883451e+000; krok(n+1)=2.243330e-002; ng(n+1)=1.099241e+002;
n=34; farx(n+1)=1.288929e+000; foe(n+1)=6.775113e+000; krok(n+1)=2.498965e-001; ng(n+1)=1.374154e+002;
n=35; farx(n+1)=1.265088e+000; foe(n+1)=6.697831e+000; krok(n+1)=1.928435e-001; ng(n+1)=7.236017e+001;
n=36; farx(n+1)=1.280343e+000; foe(n+1)=6.553598e+000; krok(n+1)=4.170483e-001; ng(n+1)=1.504356e+002;
n=37; farx(n+1)=1.164618e+000; foe(n+1)=6.415774e+000; krok(n+1)=3.435737e-001; ng(n+1)=2.222448e+001;
n=38; farx(n+1)=1.057588e+000; foe(n+1)=6.333259e+000; krok(n+1)=3.116529e-001; ng(n+1)=7.172421e+001;
n=39; farx(n+1)=9.260021e-001; foe(n+1)=6.245421e+000; krok(n+1)=4.063898e-001; ng(n+1)=1.207026e+002;
n=40; farx(n+1)=8.866980e-001; foe(n+1)=6.178858e+000; krok(n+1)=2.894475e-001; ng(n+1)=6.962236e+001;
n=41; farx(n+1)=8.767488e-001; foe(n+1)=6.072006e+000; krok(n+1)=1.714306e-001; ng(n+1)=1.115233e+002;
n=42; farx(n+1)=8.545798e-001; foe(n+1)=6.028282e+000; krok(n+1)=2.193298e-001; ng(n+1)=1.414573e+002;
n=43; farx(n+1)=7.503293e-001; foe(n+1)=5.910235e+000; krok(n+1)=1.454334e+000; ng(n+1)=5.271156e+001;
n=44; farx(n+1)=6.137596e-001; foe(n+1)=5.816918e+000; krok(n+1)=1.435731e+000; ng(n+1)=7.454365e+001;
n=45; farx(n+1)=5.787506e-001; foe(n+1)=5.744713e+000; krok(n+1)=2.625380e-001; ng(n+1)=8.030415e+001;
n=46; farx(n+1)=5.621358e-001; foe(n+1)=5.711163e+000; krok(n+1)=2.431780e-001; ng(n+1)=1.371213e+002;
n=47; farx(n+1)=5.430993e-001; foe(n+1)=5.662639e+000; krok(n+1)=3.550835e-001; ng(n+1)=8.260185e+001;
n=48; farx(n+1)=5.445801e-001; foe(n+1)=5.645355e+000; krok(n+1)=2.007487e-001; ng(n+1)=1.345115e+002;
n=49; farx(n+1)=4.942098e-001; foe(n+1)=5.594569e+000; krok(n+1)=8.193164e-001; ng(n+1)=6.629759e+001;
n=50; farx(n+1)=5.153361e-001; foe(n+1)=5.433574e+000; krok(n+1)=9.709553e-001; ng(n+1)=9.256139e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
