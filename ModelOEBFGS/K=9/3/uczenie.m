%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.194668e+002; foe(n+1)=2.127559e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.733925e+002; foe(n+1)=1.689827e+002; krok(n+1)=5.362933e-004; ng(n+1)=8.259299e+002;
n=2; farx(n+1)=6.274760e+001; foe(n+1)=6.458614e+001; krok(n+1)=8.417037e-003; ng(n+1)=3.946026e+002;
n=3; farx(n+1)=6.025646e+001; foe(n+1)=6.184380e+001; krok(n+1)=1.516318e-003; ng(n+1)=2.164104e+002;
n=4; farx(n+1)=3.880335e+001; foe(n+1)=5.895231e+001; krok(n+1)=2.580064e-002; ng(n+1)=4.479771e+001;
n=5; farx(n+1)=6.578926e+000; foe(n+1)=3.896416e+001; krok(n+1)=2.855545e-003; ng(n+1)=2.941508e+002;
n=6; farx(n+1)=5.598401e+000; foe(n+1)=3.837600e+001; krok(n+1)=1.649119e-005; ng(n+1)=1.555938e+003;
n=7; farx(n+1)=5.087959e+000; foe(n+1)=3.794267e+001; krok(n+1)=2.988526e-003; ng(n+1)=2.080872e+003;
n=8; farx(n+1)=4.626256e+000; foe(n+1)=3.069525e+001; krok(n+1)=5.414124e-003; ng(n+1)=2.270861e+003;
n=9; farx(n+1)=4.802810e+000; foe(n+1)=3.005497e+001; krok(n+1)=1.802468e-004; ng(n+1)=2.875273e+003;
n=10; farx(n+1)=5.971525e+000; foe(n+1)=2.509612e+001; krok(n+1)=6.951230e-003; ng(n+1)=3.111515e+003;
n=11; farx(n+1)=6.547721e+000; foe(n+1)=2.281415e+001; krok(n+1)=1.006932e-003; ng(n+1)=1.651514e+003;
n=12; farx(n+1)=5.515193e+000; foe(n+1)=1.730542e+001; krok(n+1)=4.880471e-002; ng(n+1)=9.937953e+002;
n=13; farx(n+1)=4.698705e+000; foe(n+1)=1.554815e+001; krok(n+1)=3.840117e-003; ng(n+1)=2.888139e+002;
n=14; farx(n+1)=4.543081e+000; foe(n+1)=1.535806e+001; krok(n+1)=2.204222e-003; ng(n+1)=2.234372e+002;
n=15; farx(n+1)=3.727249e+000; foe(n+1)=1.386854e+001; krok(n+1)=1.258748e-002; ng(n+1)=1.852644e+002;
n=16; farx(n+1)=2.898004e+000; foe(n+1)=1.170832e+001; krok(n+1)=1.419977e-002; ng(n+1)=7.289951e+002;
n=17; farx(n+1)=2.119763e+000; foe(n+1)=9.854597e+000; krok(n+1)=1.518330e-002; ng(n+1)=5.168199e+002;
n=18; farx(n+1)=1.857655e+000; foe(n+1)=9.006295e+000; krok(n+1)=5.557598e-003; ng(n+1)=6.426745e+002;
n=19; farx(n+1)=1.693366e+000; foe(n+1)=8.148335e+000; krok(n+1)=9.988735e-004; ng(n+1)=8.616430e+002;
n=20; farx(n+1)=1.388344e+000; foe(n+1)=7.163101e+000; krok(n+1)=1.064021e-002; ng(n+1)=4.520084e+002;
n=21; farx(n+1)=1.190727e+000; foe(n+1)=4.824287e+000; krok(n+1)=9.612071e-003; ng(n+1)=9.373213e+002;
n=22; farx(n+1)=1.170214e+000; foe(n+1)=4.507582e+000; krok(n+1)=7.405976e-004; ng(n+1)=8.329854e+002;
n=23; farx(n+1)=9.633303e-001; foe(n+1)=3.785321e+000; krok(n+1)=1.153579e-002; ng(n+1)=1.045453e+003;
n=24; farx(n+1)=7.789285e-001; foe(n+1)=2.428289e+000; krok(n+1)=1.201509e-003; ng(n+1)=1.519241e+003;
n=25; farx(n+1)=7.645306e-001; foe(n+1)=2.233051e+000; krok(n+1)=1.986798e-003; ng(n+1)=4.573477e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.682991e-001; foe(n+1)=2.030394e+000; krok(n+1)=9.706803e-006; ng(n+1)=5.384780e+002;
n=27; farx(n+1)=7.752215e-001; foe(n+1)=1.956210e+000; krok(n+1)=3.098519e-005; ng(n+1)=2.388664e+002;
n=28; farx(n+1)=7.734482e-001; foe(n+1)=1.916886e+000; krok(n+1)=1.803354e-004; ng(n+1)=7.644570e+001;
n=29; farx(n+1)=7.638334e-001; foe(n+1)=1.766446e+000; krok(n+1)=1.721118e-003; ng(n+1)=5.202446e+001;
n=30; farx(n+1)=7.198624e-001; foe(n+1)=1.521918e+000; krok(n+1)=7.152527e-003; ng(n+1)=3.090020e+001;
n=31; farx(n+1)=6.251584e-001; foe(n+1)=1.352871e+000; krok(n+1)=1.941426e-002; ng(n+1)=1.151219e+002;
n=32; farx(n+1)=6.013141e-001; foe(n+1)=1.325968e+000; krok(n+1)=6.884742e-003; ng(n+1)=1.651117e+002;
n=33; farx(n+1)=5.739926e-001; foe(n+1)=1.268700e+000; krok(n+1)=2.320653e-002; ng(n+1)=1.390426e+002;
n=34; farx(n+1)=5.739951e-001; foe(n+1)=1.204386e+000; krok(n+1)=5.954236e-002; ng(n+1)=9.602373e+001;
n=35; farx(n+1)=5.352890e-001; foe(n+1)=1.118534e+000; krok(n+1)=7.414397e-002; ng(n+1)=5.610736e+001;
n=36; farx(n+1)=5.155746e-001; foe(n+1)=1.046765e+000; krok(n+1)=3.544455e-003; ng(n+1)=3.342854e+002;
n=37; farx(n+1)=5.158102e-001; foe(n+1)=1.021637e+000; krok(n+1)=9.093040e-003; ng(n+1)=9.750624e+001;
n=38; farx(n+1)=5.703179e-001; foe(n+1)=9.701236e-001; krok(n+1)=3.571281e-002; ng(n+1)=1.606663e+002;
n=39; farx(n+1)=5.739444e-001; foe(n+1)=9.591518e-001; krok(n+1)=1.526430e-002; ng(n+1)=1.613596e+002;
n=40; farx(n+1)=5.625681e-001; foe(n+1)=9.428875e-001; krok(n+1)=2.398987e-002; ng(n+1)=7.527133e+001;
n=41; farx(n+1)=4.886989e-001; foe(n+1)=8.632544e-001; krok(n+1)=9.760941e-002; ng(n+1)=1.008444e+002;
n=42; farx(n+1)=4.783367e-001; foe(n+1)=8.509301e-001; krok(n+1)=3.883641e-003; ng(n+1)=9.741028e+001;
n=43; farx(n+1)=4.564499e-001; foe(n+1)=8.253821e-001; krok(n+1)=1.636186e-002; ng(n+1)=7.943142e+001;
n=44; farx(n+1)=4.240921e-001; foe(n+1)=7.911719e-001; krok(n+1)=2.219272e-002; ng(n+1)=1.106757e+002;
n=45; farx(n+1)=3.940181e-001; foe(n+1)=7.442611e-001; krok(n+1)=5.160128e-002; ng(n+1)=9.352059e+001;
n=46; farx(n+1)=3.763740e-001; foe(n+1)=7.081506e-001; krok(n+1)=1.486332e-002; ng(n+1)=1.868624e+002;
n=47; farx(n+1)=3.664431e-001; foe(n+1)=6.890675e-001; krok(n+1)=2.690904e-002; ng(n+1)=6.982357e+001;
n=48; farx(n+1)=3.671051e-001; foe(n+1)=6.730947e-001; krok(n+1)=4.486659e-002; ng(n+1)=9.801839e+001;
n=49; farx(n+1)=3.692000e-001; foe(n+1)=6.589055e-001; krok(n+1)=8.005809e-002; ng(n+1)=3.736248e+001;
n=50; farx(n+1)=3.704680e-001; foe(n+1)=6.365402e-001; krok(n+1)=6.677458e-002; ng(n+1)=1.093673e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
