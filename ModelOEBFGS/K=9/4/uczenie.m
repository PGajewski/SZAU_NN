%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.076283e+002; foe(n+1)=2.035767e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.696781e+002; foe(n+1)=1.679314e+002; krok(n+1)=5.260648e-004; ng(n+1)=8.624021e+002;
n=2; farx(n+1)=6.598589e+001; foe(n+1)=6.741887e+001; krok(n+1)=8.092065e-003; ng(n+1)=4.311479e+002;
n=3; farx(n+1)=6.231895e+001; foe(n+1)=6.269780e+001; krok(n+1)=2.568725e-003; ng(n+1)=3.038611e+002;
n=4; farx(n+1)=1.547224e+001; foe(n+1)=5.463533e+001; krok(n+1)=1.428686e-001; ng(n+1)=4.481966e+001;
n=5; farx(n+1)=1.066013e+001; foe(n+1)=5.096285e+001; krok(n+1)=3.600596e-005; ng(n+1)=1.639228e+003;
n=6; farx(n+1)=5.617292e+000; foe(n+1)=4.259560e+001; krok(n+1)=2.417862e-004; ng(n+1)=1.953035e+003;
n=7; farx(n+1)=5.868308e+000; foe(n+1)=4.028496e+001; krok(n+1)=4.315864e-004; ng(n+1)=2.719094e+003;
n=8; farx(n+1)=8.594203e+000; foe(n+1)=3.877479e+001; krok(n+1)=8.001137e-004; ng(n+1)=3.131306e+003;
n=9; farx(n+1)=1.021025e+001; foe(n+1)=3.748620e+001; krok(n+1)=3.878507e-003; ng(n+1)=2.907312e+003;
n=10; farx(n+1)=1.095128e+001; foe(n+1)=3.698374e+001; krok(n+1)=1.136630e-003; ng(n+1)=2.342402e+003;
n=11; farx(n+1)=1.123742e+001; foe(n+1)=3.138410e+001; krok(n+1)=1.321526e-002; ng(n+1)=1.529683e+003;
n=12; farx(n+1)=1.035239e+001; foe(n+1)=2.659209e+001; krok(n+1)=1.510644e-003; ng(n+1)=1.386389e+003;
n=13; farx(n+1)=1.036459e+001; foe(n+1)=2.477825e+001; krok(n+1)=8.155298e-003; ng(n+1)=7.118671e+002;
n=14; farx(n+1)=5.135875e+000; foe(n+1)=1.989557e+001; krok(n+1)=5.852382e-003; ng(n+1)=5.898691e+002;
n=15; farx(n+1)=4.242437e+000; foe(n+1)=1.802765e+001; krok(n+1)=5.022246e-003; ng(n+1)=4.472716e+002;
n=16; farx(n+1)=2.940266e+000; foe(n+1)=1.430486e+001; krok(n+1)=7.007869e-003; ng(n+1)=6.801990e+002;
n=17; farx(n+1)=3.433088e+000; foe(n+1)=1.137479e+001; krok(n+1)=1.111520e-002; ng(n+1)=1.582851e+003;
n=18; farx(n+1)=3.468920e+000; foe(n+1)=1.069950e+001; krok(n+1)=2.130452e-003; ng(n+1)=6.464163e+002;
n=19; farx(n+1)=3.546714e+000; foe(n+1)=1.017590e+001; krok(n+1)=2.216378e-003; ng(n+1)=3.776401e+002;
n=20; farx(n+1)=3.634444e+000; foe(n+1)=9.435303e+000; krok(n+1)=1.303318e-002; ng(n+1)=6.899692e+002;
n=21; farx(n+1)=3.409221e+000; foe(n+1)=8.905609e+000; krok(n+1)=5.020749e-003; ng(n+1)=2.483764e+002;
n=22; farx(n+1)=3.430060e+000; foe(n+1)=8.075681e+000; krok(n+1)=1.111520e-002; ng(n+1)=1.011349e+003;
n=23; farx(n+1)=3.121785e+000; foe(n+1)=7.805005e+000; krok(n+1)=1.511435e-002; ng(n+1)=2.730322e+002;
n=24; farx(n+1)=2.643293e+000; foe(n+1)=7.304961e+000; krok(n+1)=7.931784e-003; ng(n+1)=5.054509e+002;
n=25; farx(n+1)=2.390266e+000; foe(n+1)=7.044809e+000; krok(n+1)=1.170476e-002; ng(n+1)=3.792239e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.394179e+000; foe(n+1)=6.814897e+000; krok(n+1)=6.891598e-006; ng(n+1)=9.308387e+002;
n=27; farx(n+1)=2.388910e+000; foe(n+1)=6.784874e+000; krok(n+1)=6.293327e-005; ng(n+1)=9.471463e+001;
n=28; farx(n+1)=2.418726e+000; foe(n+1)=6.682644e+000; krok(n+1)=4.987505e-004; ng(n+1)=6.757281e+001;
n=29; farx(n+1)=2.103965e+000; foe(n+1)=6.060943e+000; krok(n+1)=1.119612e-003; ng(n+1)=1.099078e+002;
n=30; farx(n+1)=1.887018e+000; foe(n+1)=5.247211e+000; krok(n+1)=4.704763e-003; ng(n+1)=2.627256e+002;
n=31; farx(n+1)=1.573110e+000; foe(n+1)=4.533785e+000; krok(n+1)=1.706649e-002; ng(n+1)=2.446459e+002;
n=32; farx(n+1)=1.527266e+000; foe(n+1)=4.425449e+000; krok(n+1)=3.446556e-003; ng(n+1)=1.646325e+002;
n=33; farx(n+1)=1.338208e+000; foe(n+1)=3.958820e+000; krok(n+1)=6.607631e-003; ng(n+1)=3.499049e+002;
n=34; farx(n+1)=1.200970e+000; foe(n+1)=3.330017e+000; krok(n+1)=8.350786e-003; ng(n+1)=3.037048e+002;
n=35; farx(n+1)=1.102373e+000; foe(n+1)=2.542456e+000; krok(n+1)=1.178924e-002; ng(n+1)=5.324740e+002;
n=36; farx(n+1)=1.120800e+000; foe(n+1)=2.185335e+000; krok(n+1)=4.096666e-003; ng(n+1)=3.472784e+002;
n=37; farx(n+1)=1.047069e+000; foe(n+1)=1.958936e+000; krok(n+1)=1.086709e-002; ng(n+1)=2.034899e+002;
n=38; farx(n+1)=9.586472e-001; foe(n+1)=1.783028e+000; krok(n+1)=7.191676e-003; ng(n+1)=3.546392e+002;
n=39; farx(n+1)=8.637778e-001; foe(n+1)=1.645693e+000; krok(n+1)=1.520419e-002; ng(n+1)=1.969300e+002;
n=40; farx(n+1)=7.289952e-001; foe(n+1)=1.258421e+000; krok(n+1)=2.054980e-002; ng(n+1)=1.630779e+002;
n=41; farx(n+1)=7.103470e-001; foe(n+1)=1.215623e+000; krok(n+1)=2.659087e-003; ng(n+1)=1.212509e+002;
n=42; farx(n+1)=6.575073e-001; foe(n+1)=1.123921e+000; krok(n+1)=8.672124e-003; ng(n+1)=1.007910e+002;
n=43; farx(n+1)=6.345533e-001; foe(n+1)=1.065765e+000; krok(n+1)=3.813159e-003; ng(n+1)=2.207582e+002;
n=44; farx(n+1)=6.020677e-001; foe(n+1)=9.394335e-001; krok(n+1)=3.052860e-002; ng(n+1)=1.223140e+002;
n=45; farx(n+1)=5.913826e-001; foe(n+1)=9.030770e-001; krok(n+1)=8.092699e-003; ng(n+1)=9.282471e+001;
n=46; farx(n+1)=5.535849e-001; foe(n+1)=7.910312e-001; krok(n+1)=5.730945e-002; ng(n+1)=1.785900e+002;
n=47; farx(n+1)=5.413141e-001; foe(n+1)=7.566729e-001; krok(n+1)=3.805310e-002; ng(n+1)=1.787180e+002;
n=48; farx(n+1)=5.194760e-001; foe(n+1)=7.335659e-001; krok(n+1)=3.864513e-002; ng(n+1)=1.154969e+002;
n=49; farx(n+1)=4.679691e-001; foe(n+1)=6.856716e-001; krok(n+1)=1.072012e-001; ng(n+1)=6.703106e+001;
n=50; farx(n+1)=4.388039e-001; foe(n+1)=6.615791e-001; krok(n+1)=5.565015e-002; ng(n+1)=6.168902e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
