%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.128021e+002; foe(n+1)=3.212458e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.750078e+002; foe(n+1)=1.785210e+002; krok(n+1)=4.838020e-004; ng(n+1)=9.116263e+002;
n=2; farx(n+1)=5.410415e+001; foe(n+1)=6.465106e+001; krok(n+1)=2.803148e-002; ng(n+1)=1.775872e+002;
n=3; farx(n+1)=5.214691e+001; foe(n+1)=6.408790e+001; krok(n+1)=4.636412e-004; ng(n+1)=1.578641e+002;
n=4; farx(n+1)=4.716104e+001; foe(n+1)=6.324794e+001; krok(n+1)=1.772228e-003; ng(n+1)=8.914030e+001;
n=5; farx(n+1)=1.196757e+001; foe(n+1)=4.994493e+001; krok(n+1)=1.943015e-003; ng(n+1)=2.270939e+002;
n=6; farx(n+1)=8.983304e+000; foe(n+1)=4.861896e+001; krok(n+1)=9.381121e-004; ng(n+1)=1.268925e+003;
n=7; farx(n+1)=8.413027e+000; foe(n+1)=3.330016e+001; krok(n+1)=1.660195e-002; ng(n+1)=1.822566e+003;
n=8; farx(n+1)=8.628352e+000; foe(n+1)=3.273064e+001; krok(n+1)=2.895734e-004; ng(n+1)=1.939810e+003;
n=9; farx(n+1)=1.028299e+001; foe(n+1)=3.085689e+001; krok(n+1)=4.812762e-003; ng(n+1)=1.725150e+003;
n=10; farx(n+1)=1.159597e+001; foe(n+1)=2.916899e+001; krok(n+1)=2.818159e-003; ng(n+1)=1.287095e+003;
n=11; farx(n+1)=1.191303e+001; foe(n+1)=2.864763e+001; krok(n+1)=2.707062e-003; ng(n+1)=5.680145e+002;
n=12; farx(n+1)=1.362021e+001; foe(n+1)=2.720918e+001; krok(n+1)=2.858001e-002; ng(n+1)=6.085088e+002;
n=13; farx(n+1)=1.390152e+001; foe(n+1)=2.677740e+001; krok(n+1)=1.420248e-003; ng(n+1)=5.308154e+002;
n=14; farx(n+1)=1.245814e+001; foe(n+1)=2.515307e+001; krok(n+1)=3.050527e-002; ng(n+1)=2.565832e+002;
n=15; farx(n+1)=1.061999e+001; foe(n+1)=2.382456e+001; krok(n+1)=1.345640e-002; ng(n+1)=4.526543e+002;
n=16; farx(n+1)=8.223334e+000; foe(n+1)=1.944897e+001; krok(n+1)=4.002904e-002; ng(n+1)=5.804177e+002;
n=17; farx(n+1)=5.746794e+000; foe(n+1)=1.489068e+001; krok(n+1)=4.438543e-002; ng(n+1)=5.522800e+002;
n=18; farx(n+1)=2.837349e+000; foe(n+1)=1.111700e+001; krok(n+1)=3.139181e-002; ng(n+1)=1.089109e+003;
n=19; farx(n+1)=1.313413e+000; foe(n+1)=7.796156e+000; krok(n+1)=4.663470e-002; ng(n+1)=1.402190e+003;
n=20; farx(n+1)=1.103622e+000; foe(n+1)=6.571998e+000; krok(n+1)=1.015974e-001; ng(n+1)=1.213418e+003;
n=21; farx(n+1)=8.952246e-001; foe(n+1)=5.552282e+000; krok(n+1)=5.205007e-002; ng(n+1)=1.050815e+003;
n=22; farx(n+1)=9.138158e-001; foe(n+1)=5.347000e+000; krok(n+1)=6.948381e-002; ng(n+1)=6.795087e+002;
n=23; farx(n+1)=8.993361e-001; foe(n+1)=5.085013e+000; krok(n+1)=1.178633e-001; ng(n+1)=4.255295e+002;
n=24; farx(n+1)=1.047426e+000; foe(n+1)=4.716775e+000; krok(n+1)=4.556164e-001; ng(n+1)=1.991563e+002;
n=25; farx(n+1)=9.695505e-001; foe(n+1)=4.424411e+000; krok(n+1)=8.354052e-001; ng(n+1)=1.481659e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=9.662326e-001; foe(n+1)=4.326886e+000; krok(n+1)=3.566522e-006; ng(n+1)=4.263290e+002;
n=27; farx(n+1)=9.643641e-001; foe(n+1)=4.322225e+000; krok(n+1)=1.400116e-005; ng(n+1)=6.303331e+001;
n=28; farx(n+1)=9.447306e-001; foe(n+1)=4.293964e+000; krok(n+1)=1.512160e-004; ng(n+1)=5.094341e+001;
n=29; farx(n+1)=8.840479e-001; foe(n+1)=3.656041e+000; krok(n+1)=1.216238e-002; ng(n+1)=2.809709e+001;
n=30; farx(n+1)=9.949476e-001; foe(n+1)=3.132838e+000; krok(n+1)=3.722051e-003; ng(n+1)=3.814825e+002;
n=31; farx(n+1)=1.066003e+000; foe(n+1)=2.718114e+000; krok(n+1)=1.053841e-002; ng(n+1)=5.121901e+002;
n=32; farx(n+1)=1.065412e+000; foe(n+1)=2.703893e+000; krok(n+1)=4.430064e-004; ng(n+1)=3.407255e+002;
n=33; farx(n+1)=9.041661e-001; foe(n+1)=2.227694e+000; krok(n+1)=3.172714e-002; ng(n+1)=2.000157e+002;
n=34; farx(n+1)=8.198874e-001; foe(n+1)=1.886475e+000; krok(n+1)=1.226153e-002; ng(n+1)=3.581925e+002;
n=35; farx(n+1)=7.276045e-001; foe(n+1)=1.577609e+000; krok(n+1)=7.088910e-003; ng(n+1)=4.852726e+002;
n=36; farx(n+1)=6.756865e-001; foe(n+1)=1.383995e+000; krok(n+1)=1.080437e-002; ng(n+1)=1.926476e+002;
n=37; farx(n+1)=5.129078e-001; foe(n+1)=1.233186e+000; krok(n+1)=4.102628e-002; ng(n+1)=3.271466e+002;
n=38; farx(n+1)=5.019935e-001; foe(n+1)=1.219795e+000; krok(n+1)=5.485375e-003; ng(n+1)=1.562476e+002;
n=39; farx(n+1)=5.521765e-001; foe(n+1)=1.128443e+000; krok(n+1)=1.237945e-001; ng(n+1)=1.001440e+002;
n=40; farx(n+1)=4.626341e-001; foe(n+1)=9.810260e-001; krok(n+1)=6.024636e-002; ng(n+1)=1.778793e+002;
n=41; farx(n+1)=5.151612e-001; foe(n+1)=9.454035e-001; krok(n+1)=3.929724e-002; ng(n+1)=4.063665e+002;
n=42; farx(n+1)=4.896100e-001; foe(n+1)=8.739454e-001; krok(n+1)=2.553603e-001; ng(n+1)=5.211078e+002;
n=43; farx(n+1)=4.184943e-001; foe(n+1)=8.098864e-001; krok(n+1)=1.497423e-001; ng(n+1)=2.269069e+002;
n=44; farx(n+1)=2.799190e-001; foe(n+1)=6.202798e-001; krok(n+1)=4.787134e-001; ng(n+1)=2.911595e+002;
n=45; farx(n+1)=2.474837e-001; foe(n+1)=5.514096e-001; krok(n+1)=7.000904e-002; ng(n+1)=6.480159e+002;
n=46; farx(n+1)=2.400843e-001; foe(n+1)=5.165778e-001; krok(n+1)=9.327289e-002; ng(n+1)=2.913081e+002;
n=47; farx(n+1)=2.439327e-001; foe(n+1)=4.773761e-001; krok(n+1)=1.620110e-001; ng(n+1)=3.442936e+002;
n=48; farx(n+1)=2.431009e-001; foe(n+1)=4.572370e-001; krok(n+1)=2.343012e-001; ng(n+1)=4.056313e+002;
n=49; farx(n+1)=2.489338e-001; foe(n+1)=4.452977e-001; krok(n+1)=2.093785e-001; ng(n+1)=1.540039e+002;
n=50; farx(n+1)=2.512801e-001; foe(n+1)=4.388388e-001; krok(n+1)=2.994154e-001; ng(n+1)=7.925206e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Najlepszy model, uczenie predyktora OE, algorytm BFGS');
%figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
%subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1);
Eoe=foe(n+1);
