%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.792006e+002; foe(n+1)=1.772335e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.659868e+002; foe(n+1)=1.637087e+002; krok(n+1)=6.752731e-004; ng(n+1)=4.654250e+002;
n=2; farx(n+1)=7.647553e+001; foe(n+1)=7.222752e+001; krok(n+1)=5.967857e-003; ng(n+1)=3.354917e+002;
n=3; farx(n+1)=6.999349e+001; foe(n+1)=6.377141e+001; krok(n+1)=1.463096e-003; ng(n+1)=4.133526e+002;
n=4; farx(n+1)=6.958643e+001; foe(n+1)=6.247990e+001; krok(n+1)=3.621201e-003; ng(n+1)=1.809978e+002;
n=5; farx(n+1)=2.477940e+001; foe(n+1)=5.240340e+001; krok(n+1)=5.349375e-002; ng(n+1)=5.666761e+001;
n=6; farx(n+1)=1.322887e+001; foe(n+1)=4.900407e+001; krok(n+1)=2.139541e-003; ng(n+1)=8.415199e+002;
n=7; farx(n+1)=6.482547e+000; foe(n+1)=4.385542e+001; krok(n+1)=4.464102e-003; ng(n+1)=1.703602e+003;
n=8; farx(n+1)=5.824354e+000; foe(n+1)=4.328345e+001; krok(n+1)=2.170937e-005; ng(n+1)=3.751928e+003;
n=9; farx(n+1)=7.611071e+000; foe(n+1)=3.889243e+001; krok(n+1)=5.042484e-002; ng(n+1)=4.344529e+003;
n=10; farx(n+1)=8.383200e+000; foe(n+1)=3.732570e+001; krok(n+1)=9.677161e-005; ng(n+1)=4.019561e+003;
n=11; farx(n+1)=9.462526e+000; foe(n+1)=3.552530e+001; krok(n+1)=3.683227e-003; ng(n+1)=3.393313e+003;
n=12; farx(n+1)=1.042601e+001; foe(n+1)=3.405661e+001; krok(n+1)=1.532691e-003; ng(n+1)=2.493793e+003;
n=13; farx(n+1)=1.195621e+001; foe(n+1)=3.191812e+001; krok(n+1)=2.187783e-003; ng(n+1)=1.777997e+003;
n=14; farx(n+1)=1.394210e+001; foe(n+1)=3.029528e+001; krok(n+1)=2.531421e-003; ng(n+1)=7.299594e+002;
n=15; farx(n+1)=1.370636e+001; foe(n+1)=2.531089e+001; krok(n+1)=4.155078e-002; ng(n+1)=3.908306e+002;
n=16; farx(n+1)=1.182004e+001; foe(n+1)=2.150367e+001; krok(n+1)=7.481826e-003; ng(n+1)=3.609827e+002;
n=17; farx(n+1)=1.103672e+001; foe(n+1)=2.054939e+001; krok(n+1)=1.415702e-003; ng(n+1)=4.681245e+002;
n=18; farx(n+1)=9.600396e+000; foe(n+1)=1.904835e+001; krok(n+1)=3.572501e-003; ng(n+1)=5.946266e+002;
n=19; farx(n+1)=8.108434e+000; foe(n+1)=1.803336e+001; krok(n+1)=1.540867e-002; ng(n+1)=3.888660e+002;
n=20; farx(n+1)=4.501735e+000; foe(n+1)=1.510428e+001; krok(n+1)=1.513348e-002; ng(n+1)=6.171150e+002;
n=21; farx(n+1)=2.066467e+000; foe(n+1)=1.208974e+001; krok(n+1)=2.343419e-002; ng(n+1)=7.571322e+002;
n=22; farx(n+1)=1.463111e+000; foe(n+1)=1.096461e+001; krok(n+1)=1.695208e-003; ng(n+1)=1.445774e+003;
n=23; farx(n+1)=9.642692e-001; foe(n+1)=9.925620e+000; krok(n+1)=1.033570e-002; ng(n+1)=7.275848e+002;
n=24; farx(n+1)=8.948564e-001; foe(n+1)=9.718944e+000; krok(n+1)=9.093040e-003; ng(n+1)=2.850076e+002;
n=25; farx(n+1)=9.247223e-001; foe(n+1)=8.546392e+000; krok(n+1)=4.756755e-002; ng(n+1)=6.266667e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=9.148866e-001; foe(n+1)=8.352622e+000; krok(n+1)=3.460845e-006; ng(n+1)=9.199261e+002;
n=27; farx(n+1)=9.242412e-001; foe(n+1)=8.205381e+000; krok(n+1)=1.558957e-005; ng(n+1)=3.657969e+002;
n=28; farx(n+1)=9.618485e-001; foe(n+1)=8.094944e+000; krok(n+1)=6.234382e-005; ng(n+1)=1.749910e+002;
n=29; farx(n+1)=9.989137e-001; foe(n+1)=7.327307e+000; krok(n+1)=1.221241e-003; ng(n+1)=9.855743e+001;
n=30; farx(n+1)=1.021762e+000; foe(n+1)=4.542038e+000; krok(n+1)=8.510569e-003; ng(n+1)=9.265240e+001;
n=31; farx(n+1)=1.023508e+000; foe(n+1)=4.152780e+000; krok(n+1)=6.399708e-004; ng(n+1)=1.093553e+003;
n=32; farx(n+1)=1.035695e+000; foe(n+1)=3.859218e+000; krok(n+1)=5.548179e-003; ng(n+1)=1.952494e+002;
n=33; farx(n+1)=8.470570e-001; foe(n+1)=3.557315e+000; krok(n+1)=1.351485e-002; ng(n+1)=2.901734e+002;
n=34; farx(n+1)=8.013887e-001; foe(n+1)=3.458014e+000; krok(n+1)=2.742688e-003; ng(n+1)=1.976078e+002;
n=35; farx(n+1)=5.322098e-001; foe(n+1)=2.918603e+000; krok(n+1)=3.180224e-002; ng(n+1)=3.833299e+002;
n=36; farx(n+1)=4.898754e-001; foe(n+1)=2.809806e+000; krok(n+1)=8.398512e-004; ng(n+1)=6.250408e+002;
n=37; farx(n+1)=4.721860e-001; foe(n+1)=2.731531e+000; krok(n+1)=3.516052e-003; ng(n+1)=3.123614e+002;
n=38; farx(n+1)=4.564187e-001; foe(n+1)=2.601246e+000; krok(n+1)=1.424799e-003; ng(n+1)=5.455054e+002;
n=39; farx(n+1)=4.283981e-001; foe(n+1)=2.443352e+000; krok(n+1)=2.925850e-002; ng(n+1)=2.418743e+002;
n=40; farx(n+1)=4.904359e-001; foe(n+1)=2.211420e+000; krok(n+1)=4.663036e-002; ng(n+1)=3.166568e+002;
n=41; farx(n+1)=5.573036e-001; foe(n+1)=1.948579e+000; krok(n+1)=6.153853e-002; ng(n+1)=1.146786e+002;
n=42; farx(n+1)=5.883219e-001; foe(n+1)=1.857821e+000; krok(n+1)=5.846010e-003; ng(n+1)=3.425030e+002;
n=43; farx(n+1)=5.889151e-001; foe(n+1)=1.735882e+000; krok(n+1)=1.360047e-002; ng(n+1)=1.490582e+002;
n=44; farx(n+1)=6.017616e-001; foe(n+1)=1.671989e+000; krok(n+1)=1.033570e-002; ng(n+1)=1.532585e+002;
n=45; farx(n+1)=5.959802e-001; foe(n+1)=1.659475e+000; krok(n+1)=4.375565e-003; ng(n+1)=1.386441e+002;
n=46; farx(n+1)=5.125600e-001; foe(n+1)=1.517767e+000; krok(n+1)=5.397089e-002; ng(n+1)=5.246835e+001;
n=47; farx(n+1)=4.861441e-001; foe(n+1)=1.390505e+000; krok(n+1)=2.243330e-002; ng(n+1)=5.019578e+002;
n=48; farx(n+1)=4.646995e-001; foe(n+1)=1.225913e+000; krok(n+1)=8.625198e-002; ng(n+1)=3.758487e+002;
n=49; farx(n+1)=4.163381e-001; foe(n+1)=1.130580e+000; krok(n+1)=1.178633e-001; ng(n+1)=1.382436e+002;
n=50; farx(n+1)=3.759183e-001; foe(n+1)=1.071117e+000; krok(n+1)=4.176037e-001; ng(n+1)=6.975473e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
