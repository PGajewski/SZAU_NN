%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.854918e+002; foe(n+1)=2.853832e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.784165e+002; foe(n+1)=1.784718e+002; krok(n+1)=5.018139e-004; ng(n+1)=4.701646e+002;
n=2; farx(n+1)=4.574512e+001; foe(n+1)=6.583047e+001; krok(n+1)=3.881594e-002; ng(n+1)=4.663496e+001;
n=3; farx(n+1)=4.103158e+001; foe(n+1)=5.935202e+001; krok(n+1)=1.078966e-004; ng(n+1)=4.362693e+002;
n=4; farx(n+1)=3.571709e+001; foe(n+1)=5.819129e+001; krok(n+1)=9.064776e-004; ng(n+1)=7.518570e+001;
n=5; farx(n+1)=1.279962e+001; foe(n+1)=5.132213e+001; krok(n+1)=6.465635e-004; ng(n+1)=2.518508e+002;
n=6; farx(n+1)=1.374154e+001; foe(n+1)=4.773659e+001; krok(n+1)=1.296098e-002; ng(n+1)=1.234480e+003;
n=7; farx(n+1)=1.122921e+001; foe(n+1)=4.668623e+001; krok(n+1)=2.858001e-002; ng(n+1)=1.374617e+003;
n=8; farx(n+1)=7.665973e+000; foe(n+1)=4.509925e+001; krok(n+1)=4.904612e-002; ng(n+1)=1.584671e+003;
n=9; farx(n+1)=3.194529e+000; foe(n+1)=3.503181e+001; krok(n+1)=1.655202e-001; ng(n+1)=2.270454e+003;
n=10; farx(n+1)=1.466969e+000; foe(n+1)=2.534968e+001; krok(n+1)=1.655578e-001; ng(n+1)=2.536558e+003;
n=11; farx(n+1)=1.061906e+000; foe(n+1)=1.776202e+001; krok(n+1)=5.285294e-002; ng(n+1)=2.144258e+003;
n=12; farx(n+1)=1.109939e+000; foe(n+1)=1.474969e+001; krok(n+1)=4.187571e-001; ng(n+1)=8.190769e+002;
n=13; farx(n+1)=1.113025e+000; foe(n+1)=1.425364e+001; krok(n+1)=1.022485e-001; ng(n+1)=5.724529e+002;
n=14; farx(n+1)=1.150508e+000; foe(n+1)=1.403689e+001; krok(n+1)=5.461800e-001; ng(n+1)=2.595107e+002;
n=15; farx(n+1)=1.059822e+000; foe(n+1)=1.389875e+001; krok(n+1)=2.378126e+000; ng(n+1)=1.515164e+002;
n=16; farx(n+1)=1.024387e+000; foe(n+1)=1.360746e+001; krok(n+1)=4.440127e+000; ng(n+1)=1.818223e+002;
n=17; farx(n+1)=8.428446e-001; foe(n+1)=1.265996e+001; krok(n+1)=4.335649e+000; ng(n+1)=1.835939e+002;
n=18; farx(n+1)=7.228163e-001; foe(n+1)=1.131324e+001; krok(n+1)=6.046342e-001; ng(n+1)=5.405718e+002;
n=19; farx(n+1)=6.766316e-001; foe(n+1)=1.113382e+001; krok(n+1)=1.197092e-001; ng(n+1)=1.213341e+002;
n=20; farx(n+1)=4.265234e-001; foe(n+1)=1.009019e+001; krok(n+1)=1.197662e+000; ng(n+1)=3.979691e+002;
n=21; farx(n+1)=4.372648e-001; foe(n+1)=9.776947e+000; krok(n+1)=6.167589e-001; ng(n+1)=6.090533e+002;
n=22; farx(n+1)=4.008536e-001; foe(n+1)=9.326573e+000; krok(n+1)=1.077381e+000; ng(n+1)=7.343862e+001;
n=23; farx(n+1)=3.763556e-001; foe(n+1)=8.970485e+000; krok(n+1)=1.961845e-001; ng(n+1)=5.709668e+002;
n=24; farx(n+1)=3.348415e-001; foe(n+1)=8.731010e+000; krok(n+1)=4.811170e-001; ng(n+1)=5.454248e+002;
n=25; farx(n+1)=3.186007e-001; foe(n+1)=8.589453e+000; krok(n+1)=1.098329e+000; ng(n+1)=1.421981e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.184892e-001; foe(n+1)=8.588518e+000; krok(n+1)=2.408812e-006; ng(n+1)=5.162144e+001;
n=27; farx(n+1)=3.187167e-001; foe(n+1)=8.586494e+000; krok(n+1)=8.632369e-006; ng(n+1)=3.680197e+001;
n=28; farx(n+1)=3.184745e-001; foe(n+1)=8.586221e+000; krok(n+1)=8.489916e-005; ng(n+1)=4.306756e+000;
n=29; farx(n+1)=3.226696e-001; foe(n+1)=8.578394e+000; krok(n+1)=3.657312e-003; ng(n+1)=3.549889e+000;
n=30; farx(n+1)=3.296311e-001; foe(n+1)=8.571735e+000; krok(n+1)=2.017194e-002; ng(n+1)=9.258672e+000;
n=31; farx(n+1)=3.326411e-001; foe(n+1)=8.564890e+000; krok(n+1)=4.331299e-002; ng(n+1)=2.962445e+001;
n=32; farx(n+1)=3.338009e-001; foe(n+1)=8.559224e+000; krok(n+1)=8.457767e-001; ng(n+1)=9.695352e+001;
n=33; farx(n+1)=3.316671e-001; foe(n+1)=8.551352e+000; krok(n+1)=9.576737e-001; ng(n+1)=4.918574e+001;
n=34; farx(n+1)=3.415382e-001; foe(n+1)=8.539788e+000; krok(n+1)=9.429061e-001; ng(n+1)=3.225007e+001;
n=35; farx(n+1)=3.516366e-001; foe(n+1)=8.533415e+000; krok(n+1)=1.601772e+000; ng(n+1)=3.427794e+001;
n=36; farx(n+1)=3.595331e-001; foe(n+1)=8.527931e+000; krok(n+1)=5.076613e-001; ng(n+1)=3.562786e+001;
n=37; farx(n+1)=3.602438e-001; foe(n+1)=8.522855e+000; krok(n+1)=7.386536e-001; ng(n+1)=2.931053e+001;
n=38; farx(n+1)=3.639985e-001; foe(n+1)=8.516777e+000; krok(n+1)=7.926233e-001; ng(n+1)=5.859327e+001;
n=39; farx(n+1)=3.651709e-001; foe(n+1)=8.511597e+000; krok(n+1)=1.531110e+000; ng(n+1)=3.318378e+001;
n=40; farx(n+1)=3.773708e-001; foe(n+1)=8.502515e+000; krok(n+1)=5.045340e-001; ng(n+1)=9.503270e+000;
n=41; farx(n+1)=3.846374e-001; foe(n+1)=8.498927e+000; krok(n+1)=1.139125e+000; ng(n+1)=2.164519e+001;
n=42; farx(n+1)=3.877002e-001; foe(n+1)=8.494801e+000; krok(n+1)=9.110982e-001; ng(n+1)=4.766947e+001;
n=43; farx(n+1)=4.067905e-001; foe(n+1)=8.486193e+000; krok(n+1)=9.846165e-001; ng(n+1)=4.973979e+001;
n=44; farx(n+1)=4.265365e-001; foe(n+1)=8.477009e+000; krok(n+1)=3.263842e+000; ng(n+1)=2.426489e+001;
n=45; farx(n+1)=4.252349e-001; foe(n+1)=8.473724e+000; krok(n+1)=3.268918e-001; ng(n+1)=2.661604e+001;
n=46; farx(n+1)=4.354917e-001; foe(n+1)=8.469235e+000; krok(n+1)=8.922169e-001; ng(n+1)=1.360130e+001;
n=47; farx(n+1)=4.504053e-001; foe(n+1)=8.465667e+000; krok(n+1)=1.009182e+000; ng(n+1)=3.335919e+001;
n=48; farx(n+1)=4.610008e-001; foe(n+1)=8.460477e+000; krok(n+1)=1.238762e+000; ng(n+1)=3.156840e+001;
n=49; farx(n+1)=4.752115e-001; foe(n+1)=8.457449e+000; krok(n+1)=1.002885e+000; ng(n+1)=2.180362e+001;
n=50; farx(n+1)=4.811026e-001; foe(n+1)=8.454744e+000; krok(n+1)=1.531110e+000; ng(n+1)=1.654893e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
