%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.226340e+002; foe(n+1)=2.172163e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.843987e+002; foe(n+1)=1.814418e+002; krok(n+1)=5.840350e-004; ng(n+1)=9.332868e+002;
n=2; farx(n+1)=1.094264e+002; foe(n+1)=1.141616e+002; krok(n+1)=7.088910e-003; ng(n+1)=5.177503e+002;
n=3; farx(n+1)=4.978074e+001; foe(n+1)=5.567699e+001; krok(n+1)=7.648589e-004; ng(n+1)=1.433389e+003;
n=4; farx(n+1)=4.719423e+001; foe(n+1)=5.417984e+001; krok(n+1)=8.178849e-004; ng(n+1)=2.780911e+002;
n=5; farx(n+1)=2.386467e+001; foe(n+1)=4.482875e+001; krok(n+1)=2.513448e-002; ng(n+1)=1.722700e+002;
n=6; farx(n+1)=1.487179e+001; foe(n+1)=2.681467e+001; krok(n+1)=5.680993e-003; ng(n+1)=1.256706e+003;
n=7; farx(n+1)=1.462562e+001; foe(n+1)=2.606898e+001; krok(n+1)=1.329544e-003; ng(n+1)=2.748844e+002;
n=8; farx(n+1)=1.303968e+001; foe(n+1)=2.347050e+001; krok(n+1)=2.680031e-002; ng(n+1)=2.658334e+002;
n=9; farx(n+1)=1.238748e+001; foe(n+1)=2.275470e+001; krok(n+1)=3.376894e-003; ng(n+1)=1.914433e+002;
n=10; farx(n+1)=1.135497e+001; foe(n+1)=2.020095e+001; krok(n+1)=4.235232e-002; ng(n+1)=1.868839e+002;
n=11; farx(n+1)=1.038806e+001; foe(n+1)=1.887645e+001; krok(n+1)=1.596002e-002; ng(n+1)=2.446440e+002;
n=12; farx(n+1)=9.708281e+000; foe(n+1)=1.755925e+001; krok(n+1)=4.065324e-003; ng(n+1)=5.436392e+002;
n=13; farx(n+1)=9.543356e+000; foe(n+1)=1.720993e+001; krok(n+1)=3.138904e-004; ng(n+1)=5.427395e+002;
n=14; farx(n+1)=7.479901e+000; foe(n+1)=1.522071e+001; krok(n+1)=4.166678e-002; ng(n+1)=4.778738e+002;
n=15; farx(n+1)=6.192375e+000; foe(n+1)=1.363872e+001; krok(n+1)=1.812955e-003; ng(n+1)=7.118038e+002;
n=16; farx(n+1)=5.288980e+000; foe(n+1)=1.204610e+001; krok(n+1)=3.816075e-003; ng(n+1)=9.749181e+002;
n=17; farx(n+1)=5.043920e+000; foe(n+1)=1.165708e+001; krok(n+1)=5.961727e-003; ng(n+1)=1.038442e+003;
n=18; farx(n+1)=4.727649e+000; foe(n+1)=1.126989e+001; krok(n+1)=3.376366e-004; ng(n+1)=9.088776e+002;
n=19; farx(n+1)=4.080050e+000; foe(n+1)=9.842333e+000; krok(n+1)=1.594192e-002; ng(n+1)=9.800210e+002;
n=20; farx(n+1)=3.820065e+000; foe(n+1)=8.775158e+000; krok(n+1)=8.631803e-003; ng(n+1)=7.295952e+002;
n=21; farx(n+1)=3.622599e+000; foe(n+1)=8.346849e+000; krok(n+1)=5.829556e-003; ng(n+1)=8.136070e+002;
n=22; farx(n+1)=2.596892e+000; foe(n+1)=7.178298e+000; krok(n+1)=4.866267e-003; ng(n+1)=2.399449e+002;
n=23; farx(n+1)=1.711126e+000; foe(n+1)=5.523200e+000; krok(n+1)=7.242402e-003; ng(n+1)=6.357549e+002;
n=24; farx(n+1)=1.406995e+000; foe(n+1)=4.669866e+000; krok(n+1)=7.883344e-003; ng(n+1)=5.418280e+002;
n=25; farx(n+1)=1.287809e+000; foe(n+1)=4.086242e+000; krok(n+1)=7.366454e-003; ng(n+1)=7.603004e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.277047e+000; foe(n+1)=3.887276e+000; krok(n+1)=7.359719e-006; ng(n+1)=7.661612e+002;
n=27; farx(n+1)=1.265987e+000; foe(n+1)=3.775562e+000; krok(n+1)=3.190024e-005; ng(n+1)=2.681189e+002;
n=28; farx(n+1)=1.242386e+000; foe(n+1)=3.724640e+000; krok(n+1)=3.652332e-004; ng(n+1)=6.734864e+001;
n=29; farx(n+1)=1.225670e+000; foe(n+1)=3.299920e+000; krok(n+1)=1.078226e-003; ng(n+1)=9.017499e+001;
n=30; farx(n+1)=1.152017e+000; foe(n+1)=2.261412e+000; krok(n+1)=7.835038e-003; ng(n+1)=7.598612e+001;
n=31; farx(n+1)=1.115983e+000; foe(n+1)=2.101847e+000; krok(n+1)=3.128460e-003; ng(n+1)=3.524712e+002;
n=32; farx(n+1)=8.482796e-001; foe(n+1)=1.703194e+000; krok(n+1)=1.019447e-002; ng(n+1)=1.444279e+002;
n=33; farx(n+1)=6.569863e-001; foe(n+1)=1.489488e+000; krok(n+1)=9.385969e-003; ng(n+1)=1.644864e+002;
n=34; farx(n+1)=5.594094e-001; foe(n+1)=1.353352e+000; krok(n+1)=3.036370e-003; ng(n+1)=3.601747e+002;
n=35; farx(n+1)=4.480963e-001; foe(n+1)=1.194702e+000; krok(n+1)=1.859561e-002; ng(n+1)=2.447764e+002;
n=36; farx(n+1)=4.186772e-001; foe(n+1)=1.136918e+000; krok(n+1)=3.149998e-002; ng(n+1)=1.055566e+002;
n=37; farx(n+1)=4.084896e-001; foe(n+1)=1.121299e+000; krok(n+1)=2.607440e-002; ng(n+1)=5.754671e+001;
n=38; farx(n+1)=3.880672e-001; foe(n+1)=1.068915e+000; krok(n+1)=4.138006e-002; ng(n+1)=1.175360e+002;
n=39; farx(n+1)=3.700885e-001; foe(n+1)=1.035125e+000; krok(n+1)=2.580064e-002; ng(n+1)=8.935683e+001;
n=40; farx(n+1)=3.564496e-001; foe(n+1)=1.009115e+000; krok(n+1)=2.847603e-002; ng(n+1)=9.053699e+001;
n=41; farx(n+1)=3.378100e-001; foe(n+1)=9.635030e-001; krok(n+1)=5.671128e-002; ng(n+1)=9.546493e+001;
n=42; farx(n+1)=3.659876e-001; foe(n+1)=9.266987e-001; krok(n+1)=8.322808e-002; ng(n+1)=6.076017e+001;
n=43; farx(n+1)=3.743982e-001; foe(n+1)=8.716864e-001; krok(n+1)=1.428513e-001; ng(n+1)=7.572117e+001;
n=44; farx(n+1)=3.596740e-001; foe(n+1)=8.320257e-001; krok(n+1)=4.973429e-002; ng(n+1)=1.467362e+002;
n=45; farx(n+1)=3.088024e-001; foe(n+1)=7.629118e-001; krok(n+1)=1.363489e-001; ng(n+1)=4.903791e+001;
n=46; farx(n+1)=3.070281e-001; foe(n+1)=7.589144e-001; krok(n+1)=1.899071e-002; ng(n+1)=5.374199e+001;
n=47; farx(n+1)=2.995395e-001; foe(n+1)=7.388218e-001; krok(n+1)=9.327289e-002; ng(n+1)=1.111089e+002;
n=48; farx(n+1)=2.980799e-001; foe(n+1)=7.286654e-001; krok(n+1)=7.932207e-003; ng(n+1)=6.944758e+001;
n=49; farx(n+1)=2.996795e-001; foe(n+1)=7.178455e-001; krok(n+1)=3.708814e-002; ng(n+1)=4.476909e+001;
n=50; farx(n+1)=3.048127e-001; foe(n+1)=7.015856e-001; krok(n+1)=1.181740e-001; ng(n+1)=6.894182e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
