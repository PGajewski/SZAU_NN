%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.637018e+002; foe(n+1)=2.676724e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.713844e+002; foe(n+1)=1.743425e+002; krok(n+1)=4.898436e-004; ng(n+1)=6.746026e+002;
n=2; farx(n+1)=5.729759e+001; foe(n+1)=5.746568e+001; krok(n+1)=1.680437e-002; ng(n+1)=1.719838e+002;
n=3; farx(n+1)=5.208222e+001; foe(n+1)=5.079950e+001; krok(n+1)=3.378712e-003; ng(n+1)=2.117354e+002;
n=4; farx(n+1)=5.093308e+001; foe(n+1)=4.980353e+001; krok(n+1)=2.038825e-003; ng(n+1)=9.683927e+001;
n=5; farx(n+1)=3.445835e+001; foe(n+1)=4.111967e+001; krok(n+1)=3.002384e-002; ng(n+1)=9.747951e+001;
n=6; farx(n+1)=2.705110e+001; foe(n+1)=3.581023e+001; krok(n+1)=1.254679e-002; ng(n+1)=1.719125e+002;
n=7; farx(n+1)=2.191044e+001; foe(n+1)=3.253179e+001; krok(n+1)=5.770731e-003; ng(n+1)=1.688015e+002;
n=8; farx(n+1)=1.830680e+001; foe(n+1)=3.070623e+001; krok(n+1)=8.839546e-003; ng(n+1)=1.404379e+002;
n=9; farx(n+1)=1.812215e+001; foe(n+1)=2.899099e+001; krok(n+1)=6.325938e-002; ng(n+1)=1.213740e+002;
n=10; farx(n+1)=1.927256e+001; foe(n+1)=2.640327e+001; krok(n+1)=5.801457e-002; ng(n+1)=1.779407e+002;
n=11; farx(n+1)=1.677719e+001; foe(n+1)=2.337051e+001; krok(n+1)=1.417332e-001; ng(n+1)=7.127385e+001;
n=12; farx(n+1)=1.625507e+001; foe(n+1)=2.309150e+001; krok(n+1)=1.583007e-002; ng(n+1)=8.344064e+001;
n=13; farx(n+1)=1.487762e+001; foe(n+1)=2.242595e+001; krok(n+1)=4.109961e-002; ng(n+1)=9.772770e+001;
n=14; farx(n+1)=1.425254e+001; foe(n+1)=1.960251e+001; krok(n+1)=9.946858e-002; ng(n+1)=2.413298e+002;
n=15; farx(n+1)=1.245858e+001; foe(n+1)=1.765691e+001; krok(n+1)=3.034235e-002; ng(n+1)=2.711860e+002;
n=16; farx(n+1)=6.095555e+000; foe(n+1)=1.323438e+001; krok(n+1)=1.865458e-001; ng(n+1)=1.870525e+002;
n=17; farx(n+1)=4.652460e+000; foe(n+1)=1.232278e+001; krok(n+1)=1.308616e-002; ng(n+1)=1.895431e+002;
n=18; farx(n+1)=2.810377e+000; foe(n+1)=1.031472e+001; krok(n+1)=3.052860e-002; ng(n+1)=2.837882e+002;
n=19; farx(n+1)=2.344731e+000; foe(n+1)=9.667566e+000; krok(n+1)=3.879553e-002; ng(n+1)=6.018633e+002;
n=20; farx(n+1)=1.326393e+000; foe(n+1)=5.378572e+000; krok(n+1)=3.477470e-001; ng(n+1)=4.666270e+002;
n=21; farx(n+1)=1.367853e+000; foe(n+1)=4.119624e+000; krok(n+1)=2.301336e-001; ng(n+1)=1.204421e+002;
n=22; farx(n+1)=1.329214e+000; foe(n+1)=3.755410e+000; krok(n+1)=7.092411e-002; ng(n+1)=1.458925e+002;
n=23; farx(n+1)=7.887533e-001; foe(n+1)=2.785282e+000; krok(n+1)=4.936156e-001; ng(n+1)=7.879906e+001;
n=24; farx(n+1)=7.509297e-001; foe(n+1)=2.603150e+000; krok(n+1)=4.713644e-002; ng(n+1)=2.504654e+002;
n=25; farx(n+1)=5.869213e-001; foe(n+1)=2.267235e+000; krok(n+1)=7.382907e-001; ng(n+1)=7.996327e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.875680e-001; foe(n+1)=2.245787e+000; krok(n+1)=3.107255e-005; ng(n+1)=9.979848e+001;
n=27; farx(n+1)=5.729024e-001; foe(n+1)=2.196185e+000; krok(n+1)=2.266194e-004; ng(n+1)=4.415680e+001;
n=28; farx(n+1)=5.722541e-001; foe(n+1)=2.174207e+000; krok(n+1)=1.954789e-004; ng(n+1)=3.627404e+001;
n=29; farx(n+1)=6.016769e-001; foe(n+1)=1.922966e+000; krok(n+1)=3.856570e-003; ng(n+1)=2.659051e+001;
n=30; farx(n+1)=5.421414e-001; foe(n+1)=1.718714e+000; krok(n+1)=6.864555e-002; ng(n+1)=1.570919e+001;
n=31; farx(n+1)=5.327387e-001; foe(n+1)=1.653990e+000; krok(n+1)=2.191235e-002; ng(n+1)=7.359803e+001;
n=32; farx(n+1)=5.177794e-001; foe(n+1)=1.609809e+000; krok(n+1)=2.319637e-002; ng(n+1)=9.165864e+001;
n=33; farx(n+1)=4.900540e-001; foe(n+1)=1.364970e+000; krok(n+1)=1.178924e-002; ng(n+1)=1.864243e+002;
n=34; farx(n+1)=4.349667e-001; foe(n+1)=1.197301e+000; krok(n+1)=7.903310e-002; ng(n+1)=4.466693e+001;
n=35; farx(n+1)=4.321809e-001; foe(n+1)=1.119877e+000; krok(n+1)=1.605804e-002; ng(n+1)=1.916593e+002;
n=36; farx(n+1)=4.283664e-001; foe(n+1)=9.890048e-001; krok(n+1)=2.378798e-002; ng(n+1)=1.475901e+002;
n=37; farx(n+1)=4.289282e-001; foe(n+1)=9.630122e-001; krok(n+1)=3.034189e-002; ng(n+1)=2.543429e+001;
n=38; farx(n+1)=3.971676e-001; foe(n+1)=8.731437e-001; krok(n+1)=8.752990e-001; ng(n+1)=1.604992e+001;
n=39; farx(n+1)=4.181593e-001; foe(n+1)=8.298740e-001; krok(n+1)=4.480580e-001; ng(n+1)=3.689651e+001;
n=40; farx(n+1)=4.086893e-001; foe(n+1)=8.106221e-001; krok(n+1)=3.505976e-001; ng(n+1)=1.842999e+001;
n=41; farx(n+1)=4.294785e-001; foe(n+1)=7.864404e-001; krok(n+1)=5.281352e-001; ng(n+1)=2.534419e+001;
n=42; farx(n+1)=3.810428e-001; foe(n+1)=7.530415e-001; krok(n+1)=8.842170e-001; ng(n+1)=3.153462e+001;
n=43; farx(n+1)=3.749279e-001; foe(n+1)=7.265883e-001; krok(n+1)=4.500546e-001; ng(n+1)=2.950661e+001;
n=44; farx(n+1)=3.607559e-001; foe(n+1)=7.168706e-001; krok(n+1)=2.821404e-001; ng(n+1)=3.575420e+001;
n=45; farx(n+1)=3.589115e-001; foe(n+1)=7.003718e-001; krok(n+1)=8.231292e-001; ng(n+1)=1.396160e+001;
n=46; farx(n+1)=3.573146e-001; foe(n+1)=6.851569e-001; krok(n+1)=6.710813e-001; ng(n+1)=3.025413e+001;
n=47; farx(n+1)=3.548493e-001; foe(n+1)=6.633971e-001; krok(n+1)=4.872449e-001; ng(n+1)=2.311995e+001;
n=48; farx(n+1)=3.449358e-001; foe(n+1)=6.434866e-001; krok(n+1)=8.006244e-001; ng(n+1)=2.679419e+001;
n=49; farx(n+1)=3.278563e-001; foe(n+1)=6.257375e-001; krok(n+1)=5.219391e-001; ng(n+1)=4.440247e+001;
n=50; farx(n+1)=3.310243e-001; foe(n+1)=6.180849e-001; krok(n+1)=2.073757e-001; ng(n+1)=3.266961e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
