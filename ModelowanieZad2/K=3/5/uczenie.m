%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.611751e+002; foe(n+1)=2.585291e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.804095e+002; foe(n+1)=1.781335e+002; krok(n+1)=5.047513e-004; ng(n+1)=6.778441e+002;
n=2; farx(n+1)=5.915989e+001; foe(n+1)=5.453968e+001; krok(n+1)=7.092411e-002; ng(n+1)=1.540118e+002;
n=3; farx(n+1)=5.072850e+001; foe(n+1)=4.798764e+001; krok(n+1)=2.015675e-004; ng(n+1)=5.821248e+002;
n=4; farx(n+1)=4.764252e+001; foe(n+1)=4.594955e+001; krok(n+1)=5.362933e-004; ng(n+1)=2.116836e+002;
n=5; farx(n+1)=3.123768e+001; foe(n+1)=3.800604e+001; krok(n+1)=2.548617e-003; ng(n+1)=1.643495e+002;
n=6; farx(n+1)=1.915102e+001; foe(n+1)=3.441080e+001; krok(n+1)=8.565378e-003; ng(n+1)=2.309399e+002;
n=7; farx(n+1)=1.725519e+001; foe(n+1)=2.968230e+001; krok(n+1)=1.316643e-002; ng(n+1)=6.294750e+002;
n=8; farx(n+1)=1.699193e+001; foe(n+1)=2.538815e+001; krok(n+1)=2.069473e-002; ng(n+1)=5.740772e+002;
n=9; farx(n+1)=1.487731e+001; foe(n+1)=2.286309e+001; krok(n+1)=1.675011e-002; ng(n+1)=2.268744e+002;
n=10; farx(n+1)=1.022615e+001; foe(n+1)=2.002545e+001; krok(n+1)=1.142218e-002; ng(n+1)=1.623297e+002;
n=11; farx(n+1)=9.430049e+000; foe(n+1)=1.884893e+001; krok(n+1)=2.054980e-002; ng(n+1)=2.674580e+002;
n=12; farx(n+1)=5.692742e+000; foe(n+1)=1.444595e+001; krok(n+1)=6.787279e-002; ng(n+1)=1.536805e+002;
n=13; farx(n+1)=3.284000e+000; foe(n+1)=1.056530e+001; krok(n+1)=1.067078e-001; ng(n+1)=2.232358e+002;
n=14; farx(n+1)=2.517923e+000; foe(n+1)=9.024800e+000; krok(n+1)=1.238677e-002; ng(n+1)=1.718462e+002;
n=15; farx(n+1)=2.128450e+000; foe(n+1)=8.297820e+000; krok(n+1)=8.153064e-002; ng(n+1)=1.907916e+002;
n=16; farx(n+1)=1.997242e+000; foe(n+1)=7.857077e+000; krok(n+1)=1.363489e-001; ng(n+1)=1.835639e+002;
n=17; farx(n+1)=1.629724e+000; foe(n+1)=7.113963e+000; krok(n+1)=8.662598e-002; ng(n+1)=2.584340e+002;
n=18; farx(n+1)=1.651949e+000; foe(n+1)=6.743193e+000; krok(n+1)=2.760258e-001; ng(n+1)=5.940222e+001;
n=19; farx(n+1)=1.498412e+000; foe(n+1)=6.566993e+000; krok(n+1)=5.491644e-001; ng(n+1)=1.414269e+002;
n=20; farx(n+1)=1.328031e+000; foe(n+1)=6.470149e+000; krok(n+1)=4.544515e-001; ng(n+1)=2.219038e+001;
n=21; farx(n+1)=1.321791e+000; foe(n+1)=6.412022e+000; krok(n+1)=4.147513e-001; ng(n+1)=5.520333e+001;
n=22; farx(n+1)=1.230221e+000; foe(n+1)=6.356199e+000; krok(n+1)=9.073805e-001; ng(n+1)=4.714783e+001;
n=23; farx(n+1)=1.261209e+000; foe(n+1)=6.227978e+000; krok(n+1)=1.390988e+000; ng(n+1)=6.414322e+001;
n=24; farx(n+1)=1.076885e+000; foe(n+1)=5.965507e+000; krok(n+1)=2.457785e+000; ng(n+1)=3.332588e+001;
n=25; farx(n+1)=9.345288e-001; foe(n+1)=5.506242e+000; krok(n+1)=8.847528e-001; ng(n+1)=8.755249e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=9.261827e-001; foe(n+1)=5.445446e+000; krok(n+1)=2.331194e-005; ng(n+1)=1.349288e+002;
n=27; farx(n+1)=9.051038e-001; foe(n+1)=5.352769e+000; krok(n+1)=7.971656e-004; ng(n+1)=2.717225e+001;
n=28; farx(n+1)=8.818200e-001; foe(n+1)=5.316089e+000; krok(n+1)=3.031326e-005; ng(n+1)=6.685907e+001;
n=29; farx(n+1)=8.327592e-001; foe(n+1)=5.039545e+000; krok(n+1)=3.442236e-003; ng(n+1)=2.771413e+001;
n=30; farx(n+1)=7.929212e-001; foe(n+1)=4.582581e+000; krok(n+1)=6.543079e-003; ng(n+1)=2.966000e+001;
n=31; farx(n+1)=7.365830e-001; foe(n+1)=4.316884e+000; krok(n+1)=1.434453e-002; ng(n+1)=2.426715e+002;
n=32; farx(n+1)=7.302900e-001; foe(n+1)=4.223708e+000; krok(n+1)=1.370601e-002; ng(n+1)=2.186037e+002;
n=33; farx(n+1)=7.149077e-001; foe(n+1)=4.071020e+000; krok(n+1)=2.219272e-002; ng(n+1)=3.473776e+002;
n=34; farx(n+1)=6.949723e-001; foe(n+1)=3.766377e+000; krok(n+1)=1.928435e-001; ng(n+1)=3.268045e+002;
n=35; farx(n+1)=6.410955e-001; foe(n+1)=3.550065e+000; krok(n+1)=9.760941e-002; ng(n+1)=3.312288e+002;
n=36; farx(n+1)=6.270942e-001; foe(n+1)=3.163038e+000; krok(n+1)=3.655097e-001; ng(n+1)=1.888236e+002;
n=37; farx(n+1)=5.839364e-001; foe(n+1)=2.945642e+000; krok(n+1)=5.450576e-001; ng(n+1)=2.085598e+002;
n=38; farx(n+1)=4.860451e-001; foe(n+1)=2.838569e+000; krok(n+1)=4.641165e-001; ng(n+1)=2.966774e+001;
n=39; farx(n+1)=4.350499e-001; foe(n+1)=2.726185e+000; krok(n+1)=4.903006e-001; ng(n+1)=8.368850e+001;
n=40; farx(n+1)=4.074270e-001; foe(n+1)=2.661923e+000; krok(n+1)=5.219391e-001; ng(n+1)=2.268760e+002;
n=41; farx(n+1)=3.871061e-001; foe(n+1)=2.572769e+000; krok(n+1)=1.003200e+000; ng(n+1)=4.634986e+001;
n=42; farx(n+1)=3.485792e-001; foe(n+1)=2.512876e+000; krok(n+1)=3.819012e-001; ng(n+1)=1.475674e+002;
n=43; farx(n+1)=3.279645e-001; foe(n+1)=2.438347e+000; krok(n+1)=1.164353e+000; ng(n+1)=2.661252e+002;
n=44; farx(n+1)=3.248984e-001; foe(n+1)=2.394702e+000; krok(n+1)=3.390079e-001; ng(n+1)=2.246028e+002;
n=45; farx(n+1)=3.279455e-001; foe(n+1)=2.366371e+000; krok(n+1)=6.537835e-001; ng(n+1)=3.236193e+001;
n=46; farx(n+1)=3.195470e-001; foe(n+1)=2.352510e+000; krok(n+1)=5.250759e-001; ng(n+1)=5.285332e+001;
n=47; farx(n+1)=3.119703e-001; foe(n+1)=2.336589e+000; krok(n+1)=1.172218e+000; ng(n+1)=3.734050e+001;
n=48; farx(n+1)=3.144113e-001; foe(n+1)=2.323974e+000; krok(n+1)=7.491049e-001; ng(n+1)=8.821017e+000;
n=49; farx(n+1)=3.171218e-001; foe(n+1)=2.312839e+000; krok(n+1)=1.291004e+000; ng(n+1)=4.482041e+001;
n=50; farx(n+1)=3.179418e-001; foe(n+1)=2.305020e+000; krok(n+1)=2.953927e-001; ng(n+1)=3.382097e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
