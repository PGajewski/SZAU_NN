%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.690959e+002; foe(n+1)=2.776806e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.572321e+002; foe(n+1)=1.613794e+002; krok(n+1)=4.770094e-004; ng(n+1)=1.005418e+003;
n=2; farx(n+1)=5.907621e+001; foe(n+1)=6.309669e+001; krok(n+1)=6.450159e-003; ng(n+1)=3.124429e+002;
n=3; farx(n+1)=5.529119e+001; foe(n+1)=5.707645e+001; krok(n+1)=2.804162e-003; ng(n+1)=2.597547e+002;
n=4; farx(n+1)=5.387907e+001; foe(n+1)=5.529622e+001; krok(n+1)=7.517453e-003; ng(n+1)=1.036876e+002;
n=5; farx(n+1)=4.022078e+001; foe(n+1)=4.998629e+001; krok(n+1)=2.331518e-002; ng(n+1)=8.040861e+001;
n=6; farx(n+1)=2.189385e+001; foe(n+1)=3.442155e+001; krok(n+1)=1.835014e-002; ng(n+1)=2.274378e+002;
n=7; farx(n+1)=1.943297e+001; foe(n+1)=3.187492e+001; krok(n+1)=6.847610e-004; ng(n+1)=3.737089e+002;
n=8; farx(n+1)=1.545937e+001; foe(n+1)=2.900005e+001; krok(n+1)=6.130766e-003; ng(n+1)=3.973208e+002;
n=9; farx(n+1)=1.579034e+001; foe(n+1)=2.659935e+001; krok(n+1)=8.307419e-003; ng(n+1)=5.055153e+002;
n=10; farx(n+1)=1.602667e+001; foe(n+1)=2.495884e+001; krok(n+1)=2.667694e-002; ng(n+1)=2.500776e+002;
n=11; farx(n+1)=1.609366e+001; foe(n+1)=2.433203e+001; krok(n+1)=1.121665e-002; ng(n+1)=1.889282e+002;
n=12; farx(n+1)=1.376319e+001; foe(n+1)=2.311912e+001; krok(n+1)=2.476948e-002; ng(n+1)=2.372188e+002;
n=13; farx(n+1)=1.234047e+001; foe(n+1)=2.129672e+001; krok(n+1)=1.582996e-002; ng(n+1)=3.040013e+002;
n=14; farx(n+1)=1.224172e+001; foe(n+1)=2.108220e+001; krok(n+1)=2.013418e-003; ng(n+1)=4.421262e+002;
n=15; farx(n+1)=1.227703e+001; foe(n+1)=1.923186e+001; krok(n+1)=2.428721e-002; ng(n+1)=3.981628e+002;
n=16; farx(n+1)=7.730563e+000; foe(n+1)=1.481933e+001; krok(n+1)=1.104861e-001; ng(n+1)=2.711986e+002;
n=17; farx(n+1)=6.893840e+000; foe(n+1)=1.441567e+001; krok(n+1)=8.252113e-003; ng(n+1)=4.738019e+002;
n=18; farx(n+1)=6.313561e+000; foe(n+1)=1.387748e+001; krok(n+1)=1.264842e-002; ng(n+1)=4.065983e+002;
n=19; farx(n+1)=4.996716e+000; foe(n+1)=1.238023e+001; krok(n+1)=1.460546e-001; ng(n+1)=1.812234e+002;
n=20; farx(n+1)=2.427670e+000; foe(n+1)=9.901489e+000; krok(n+1)=2.286351e-001; ng(n+1)=3.451879e+002;
n=21; farx(n+1)=1.598550e+000; foe(n+1)=8.515091e+000; krok(n+1)=8.035313e-002; ng(n+1)=2.116917e+002;
n=22; farx(n+1)=1.130734e+000; foe(n+1)=7.245739e+000; krok(n+1)=3.522595e-002; ng(n+1)=3.910782e+002;
n=23; farx(n+1)=6.514228e-001; foe(n+1)=5.206733e+000; krok(n+1)=8.764941e-002; ng(n+1)=4.879760e+002;
n=24; farx(n+1)=4.642610e-001; foe(n+1)=3.639326e+000; krok(n+1)=4.954706e-002; ng(n+1)=9.234019e+002;
n=25; farx(n+1)=5.274991e-001; foe(n+1)=3.261970e+000; krok(n+1)=3.271756e-002; ng(n+1)=1.047714e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.144177e-001; foe(n+1)=2.200514e+000; krok(n+1)=1.373458e-005; ng(n+1)=8.721539e+002;
n=27; farx(n+1)=5.007235e-001; foe(n+1)=1.996093e+000; krok(n+1)=7.357142e-005; ng(n+1)=2.096132e+002;
n=28; farx(n+1)=5.023323e-001; foe(n+1)=1.938046e+000; krok(n+1)=1.963632e-004; ng(n+1)=6.348253e+001;
n=29; farx(n+1)=4.592462e-001; foe(n+1)=1.572538e+000; krok(n+1)=4.150488e-003; ng(n+1)=4.800808e+001;
n=30; farx(n+1)=4.687637e-001; foe(n+1)=1.439685e+000; krok(n+1)=1.479563e-002; ng(n+1)=1.096630e+002;
n=31; farx(n+1)=4.553719e-001; foe(n+1)=1.251005e+000; krok(n+1)=9.240905e-003; ng(n+1)=1.401912e+002;
n=32; farx(n+1)=4.535508e-001; foe(n+1)=1.194016e+000; krok(n+1)=1.073668e-002; ng(n+1)=1.542040e+002;
n=33; farx(n+1)=5.073105e-001; foe(n+1)=1.080531e+000; krok(n+1)=1.526430e-002; ng(n+1)=1.435471e+002;
n=34; farx(n+1)=5.171512e-001; foe(n+1)=1.063885e+000; krok(n+1)=5.097234e-003; ng(n+1)=1.081111e+002;
n=35; farx(n+1)=5.075221e-001; foe(n+1)=1.027907e+000; krok(n+1)=5.983917e-002; ng(n+1)=4.771673e+001;
n=36; farx(n+1)=4.506336e-001; foe(n+1)=9.748168e-001; krok(n+1)=1.083782e-001; ng(n+1)=2.562682e+001;
n=37; farx(n+1)=4.500856e-001; foe(n+1)=9.605787e-001; krok(n+1)=6.721749e-002; ng(n+1)=2.007195e+001;
n=38; farx(n+1)=4.515629e-001; foe(n+1)=9.550605e-001; krok(n+1)=7.604386e-002; ng(n+1)=2.780923e+001;
n=39; farx(n+1)=4.593653e-001; foe(n+1)=9.373635e-001; krok(n+1)=1.399123e-001; ng(n+1)=1.727290e+001;
n=40; farx(n+1)=4.457887e-001; foe(n+1)=9.174125e-001; krok(n+1)=6.814773e-002; ng(n+1)=4.578231e+001;
n=41; farx(n+1)=4.420138e-001; foe(n+1)=8.959936e-001; krok(n+1)=1.511586e-001; ng(n+1)=5.037696e+001;
n=42; farx(n+1)=4.477191e-001; foe(n+1)=8.765244e-001; krok(n+1)=1.527341e-001; ng(n+1)=3.414933e+001;
n=43; farx(n+1)=4.493662e-001; foe(n+1)=8.590035e-001; krok(n+1)=3.158996e-001; ng(n+1)=3.595495e+001;
n=44; farx(n+1)=4.298738e-001; foe(n+1)=8.379255e-001; krok(n+1)=7.271671e-001; ng(n+1)=1.995081e+001;
n=45; farx(n+1)=4.195094e-001; foe(n+1)=8.301908e-001; krok(n+1)=3.550835e-001; ng(n+1)=1.633307e+001;
n=46; farx(n+1)=4.049706e-001; foe(n+1)=8.201050e-001; krok(n+1)=4.187571e-001; ng(n+1)=2.785522e+001;
n=47; farx(n+1)=3.991962e-001; foe(n+1)=8.138715e-001; krok(n+1)=2.670983e-001; ng(n+1)=4.572734e+001;
n=48; farx(n+1)=3.916762e-001; foe(n+1)=8.081398e-001; krok(n+1)=3.268918e-001; ng(n+1)=1.718099e+001;
n=49; farx(n+1)=3.754402e-001; foe(n+1)=7.978107e-001; krok(n+1)=1.009068e+000; ng(n+1)=4.003829e+000;
n=50; farx(n+1)=3.691352e-001; foe(n+1)=7.869055e-001; krok(n+1)=9.135608e-001; ng(n+1)=2.952752e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
