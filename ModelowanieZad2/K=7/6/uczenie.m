%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.064949e+002; foe(n+1)=1.985301e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.852610e+002; foe(n+1)=1.790563e+002; krok(n+1)=6.162400e-004; ng(n+1)=5.940334e+002;
n=2; farx(n+1)=1.045230e+002; foe(n+1)=1.027162e+002; krok(n+1)=1.175824e-002; ng(n+1)=3.440347e+002;
n=3; farx(n+1)=5.934836e+001; foe(n+1)=6.027969e+001; krok(n+1)=3.910575e-004; ng(n+1)=1.499321e+003;
n=4; farx(n+1)=5.513371e+001; foe(n+1)=5.729732e+001; krok(n+1)=5.126539e-004; ng(n+1)=3.396411e+002;
n=5; farx(n+1)=2.443969e+001; foe(n+1)=4.414531e+001; krok(n+1)=2.753897e-002; ng(n+1)=1.418624e+002;
n=6; farx(n+1)=2.230925e+001; foe(n+1)=3.327879e+001; krok(n+1)=3.240245e-003; ng(n+1)=1.516746e+003;
n=7; farx(n+1)=2.278959e+001; foe(n+1)=3.009332e+001; krok(n+1)=1.525147e-003; ng(n+1)=9.385517e+002;
n=8; farx(n+1)=2.182804e+001; foe(n+1)=2.921141e+001; krok(n+1)=4.664313e-003; ng(n+1)=4.181257e+002;
n=9; farx(n+1)=1.863100e+001; foe(n+1)=2.653635e+001; krok(n+1)=1.423591e-002; ng(n+1)=3.145660e+002;
n=10; farx(n+1)=1.817269e+001; foe(n+1)=2.584117e+001; krok(n+1)=4.782427e-003; ng(n+1)=2.155912e+002;
n=11; farx(n+1)=1.642855e+001; foe(n+1)=2.452089e+001; krok(n+1)=9.778245e-003; ng(n+1)=2.059349e+002;
n=12; farx(n+1)=1.517954e+001; foe(n+1)=2.287266e+001; krok(n+1)=6.192369e-003; ng(n+1)=4.001342e+002;
n=13; farx(n+1)=1.472900e+001; foe(n+1)=2.235197e+001; krok(n+1)=1.346946e-002; ng(n+1)=9.423667e+001;
n=14; farx(n+1)=1.378303e+001; foe(n+1)=2.132779e+001; krok(n+1)=5.557598e-003; ng(n+1)=2.037046e+002;
n=15; farx(n+1)=1.304881e+001; foe(n+1)=2.027688e+001; krok(n+1)=1.636186e-002; ng(n+1)=1.390614e+002;
n=16; farx(n+1)=1.191512e+001; foe(n+1)=1.861857e+001; krok(n+1)=1.063635e-002; ng(n+1)=3.363592e+002;
n=17; farx(n+1)=1.063866e+001; foe(n+1)=1.764636e+001; krok(n+1)=6.480489e-003; ng(n+1)=3.463713e+002;
n=18; farx(n+1)=9.080550e+000; foe(n+1)=1.596618e+001; krok(n+1)=1.540553e-002; ng(n+1)=8.250895e+002;
n=19; farx(n+1)=7.929409e+000; foe(n+1)=1.455024e+001; krok(n+1)=2.490424e-003; ng(n+1)=8.212044e+002;
n=20; farx(n+1)=7.590285e+000; foe(n+1)=1.415116e+001; krok(n+1)=1.064808e-003; ng(n+1)=3.798734e+002;
n=21; farx(n+1)=7.348079e+000; foe(n+1)=1.383927e+001; krok(n+1)=1.629650e-003; ng(n+1)=4.105579e+002;
n=22; farx(n+1)=6.420111e+000; foe(n+1)=1.243570e+001; krok(n+1)=1.199493e-002; ng(n+1)=5.831569e+002;
n=23; farx(n+1)=5.745163e+000; foe(n+1)=1.105070e+001; krok(n+1)=1.360047e-002; ng(n+1)=4.570279e+002;
n=24; farx(n+1)=4.041969e+000; foe(n+1)=8.577885e+000; krok(n+1)=1.254679e-002; ng(n+1)=9.482028e+002;
n=25; farx(n+1)=3.812990e+000; foe(n+1)=8.138970e+000; krok(n+1)=2.403018e-003; ng(n+1)=8.177896e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.837087e+000; foe(n+1)=8.010896e+000; krok(n+1)=9.841122e-006; ng(n+1)=4.858378e+002;
n=27; farx(n+1)=3.793913e+000; foe(n+1)=7.566857e+000; krok(n+1)=3.164277e-004; ng(n+1)=1.763073e+002;
n=28; farx(n+1)=3.619595e+000; foe(n+1)=6.670808e+000; krok(n+1)=8.848135e-005; ng(n+1)=4.070693e+002;
n=29; farx(n+1)=3.124084e+000; foe(n+1)=5.899952e+000; krok(n+1)=1.118600e-003; ng(n+1)=2.753093e+002;
n=30; farx(n+1)=8.675501e-001; foe(n+1)=3.022141e+000; krok(n+1)=9.030211e-003; ng(n+1)=3.240233e+002;
n=31; farx(n+1)=7.067987e-001; foe(n+1)=2.650938e+000; krok(n+1)=5.062842e-003; ng(n+1)=2.950954e+002;
n=32; farx(n+1)=5.813136e-001; foe(n+1)=1.978855e+000; krok(n+1)=1.524981e-003; ng(n+1)=5.808969e+002;
n=33; farx(n+1)=5.605635e-001; foe(n+1)=1.768130e+000; krok(n+1)=3.918749e-003; ng(n+1)=2.459363e+002;
n=34; farx(n+1)=5.508220e-001; foe(n+1)=1.643107e+000; krok(n+1)=7.242402e-003; ng(n+1)=2.198099e+002;
n=35; farx(n+1)=5.321872e-001; foe(n+1)=1.526593e+000; krok(n+1)=3.778589e-003; ng(n+1)=6.964967e+001;
n=36; farx(n+1)=5.287712e-001; foe(n+1)=1.323103e+000; krok(n+1)=9.146433e-003; ng(n+1)=3.846879e+002;
n=37; farx(n+1)=5.120282e-001; foe(n+1)=1.273817e+000; krok(n+1)=2.378377e-002; ng(n+1)=6.882807e+001;
n=38; farx(n+1)=4.931114e-001; foe(n+1)=1.208215e+000; krok(n+1)=1.450364e-002; ng(n+1)=1.259022e+002;
n=39; farx(n+1)=4.855666e-001; foe(n+1)=1.177638e+000; krok(n+1)=2.091551e-002; ng(n+1)=2.287655e+002;
n=40; farx(n+1)=4.858995e-001; foe(n+1)=1.149031e+000; krok(n+1)=2.173419e-002; ng(n+1)=1.218900e+002;
n=41; farx(n+1)=4.808967e-001; foe(n+1)=1.099125e+000; krok(n+1)=4.880471e-002; ng(n+1)=6.261530e+001;
n=42; farx(n+1)=4.773479e-001; foe(n+1)=1.063369e+000; krok(n+1)=3.901146e-002; ng(n+1)=1.495012e+002;
n=43; farx(n+1)=4.677165e-001; foe(n+1)=9.930217e-001; krok(n+1)=1.329492e-001; ng(n+1)=3.607953e+001;
n=44; farx(n+1)=4.587891e-001; foe(n+1)=9.112203e-001; krok(n+1)=3.344126e-002; ng(n+1)=2.369236e+002;
n=45; farx(n+1)=4.178859e-001; foe(n+1)=7.702145e-001; krok(n+1)=5.335388e-002; ng(n+1)=2.006805e+002;
n=46; farx(n+1)=3.988394e-001; foe(n+1)=7.106291e-001; krok(n+1)=1.101515e-001; ng(n+1)=7.863183e+001;
n=47; farx(n+1)=3.545160e-001; foe(n+1)=6.439877e-001; krok(n+1)=1.498842e-001; ng(n+1)=1.059548e+002;
n=48; farx(n+1)=3.521168e-001; foe(n+1)=6.398937e-001; krok(n+1)=1.210728e-002; ng(n+1)=6.263256e+001;
n=49; farx(n+1)=3.490024e-001; foe(n+1)=6.247688e-001; krok(n+1)=1.093247e-001; ng(n+1)=4.768577e+001;
n=50; farx(n+1)=3.494815e-001; foe(n+1)=6.090437e-001; krok(n+1)=5.919426e-002; ng(n+1)=4.736455e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
