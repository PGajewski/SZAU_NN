%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.943024e+002; foe(n+1)=1.947468e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.711861e+002; foe(n+1)=1.701156e+002; krok(n+1)=6.682927e-004; ng(n+1)=8.113084e+002;
n=2; farx(n+1)=6.034650e+001; foe(n+1)=5.605907e+001; krok(n+1)=6.349841e-003; ng(n+1)=6.040593e+002;
n=3; farx(n+1)=5.947341e+001; foe(n+1)=5.556558e+001; krok(n+1)=1.300439e-003; ng(n+1)=1.136643e+002;
n=4; farx(n+1)=5.020201e+001; foe(n+1)=5.384539e+001; krok(n+1)=8.202462e-003; ng(n+1)=7.862293e+001;
n=5; farx(n+1)=1.525307e+001; foe(n+1)=3.574809e+001; krok(n+1)=1.346946e-002; ng(n+1)=1.977935e+002;
n=6; farx(n+1)=1.203736e+001; foe(n+1)=3.348334e+001; krok(n+1)=3.771986e-004; ng(n+1)=7.674668e+002;
n=7; farx(n+1)=8.299410e+000; foe(n+1)=2.441352e+001; krok(n+1)=2.607206e-003; ng(n+1)=1.074639e+003;
n=8; farx(n+1)=8.094584e+000; foe(n+1)=2.332375e+001; krok(n+1)=2.618406e-004; ng(n+1)=2.114828e+003;
n=9; farx(n+1)=9.182353e+000; foe(n+1)=2.125805e+001; krok(n+1)=1.517118e-002; ng(n+1)=2.210234e+003;
n=10; farx(n+1)=1.028443e+001; foe(n+1)=1.915008e+001; krok(n+1)=1.274291e-002; ng(n+1)=1.287131e+003;
n=11; farx(n+1)=1.039060e+001; foe(n+1)=1.788373e+001; krok(n+1)=3.941672e-003; ng(n+1)=8.017452e+002;
n=12; farx(n+1)=7.999873e+000; foe(n+1)=1.607707e+001; krok(n+1)=2.727640e-002; ng(n+1)=8.664764e+001;
n=13; farx(n+1)=6.284041e+000; foe(n+1)=1.454573e+001; krok(n+1)=3.340564e-003; ng(n+1)=5.205561e+002;
n=14; farx(n+1)=3.111175e+000; foe(n+1)=1.013391e+001; krok(n+1)=3.899772e-003; ng(n+1)=8.266927e+002;
n=15; farx(n+1)=2.462805e+000; foe(n+1)=9.487652e+000; krok(n+1)=1.457334e-003; ng(n+1)=3.711808e+002;
n=16; farx(n+1)=2.187736e+000; foe(n+1)=8.983017e+000; krok(n+1)=2.456077e-003; ng(n+1)=4.574880e+002;
n=17; farx(n+1)=1.789060e+000; foe(n+1)=7.726453e+000; krok(n+1)=9.659422e-003; ng(n+1)=6.512388e+002;
n=18; farx(n+1)=1.693255e+000; foe(n+1)=7.428904e+000; krok(n+1)=1.983052e-003; ng(n+1)=5.190389e+002;
n=19; farx(n+1)=1.567548e+000; foe(n+1)=6.571571e+000; krok(n+1)=1.614645e-002; ng(n+1)=4.872675e+002;
n=20; farx(n+1)=1.294102e+000; foe(n+1)=5.756981e+000; krok(n+1)=1.912971e-002; ng(n+1)=8.455669e+002;
n=21; farx(n+1)=1.110410e+000; foe(n+1)=5.160140e+000; krok(n+1)=2.501815e-003; ng(n+1)=1.589738e+003;
n=22; farx(n+1)=8.214484e-001; foe(n+1)=4.531164e+000; krok(n+1)=5.414124e-003; ng(n+1)=1.402062e+003;
n=23; farx(n+1)=6.083777e-001; foe(n+1)=3.975120e+000; krok(n+1)=3.262529e-003; ng(n+1)=9.181924e+002;
n=24; farx(n+1)=5.107814e-001; foe(n+1)=3.361027e+000; krok(n+1)=1.369522e-003; ng(n+1)=7.210180e+002;
n=25; farx(n+1)=4.974679e-001; foe(n+1)=2.950550e+000; krok(n+1)=1.027490e-002; ng(n+1)=5.287382e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.863917e-001; foe(n+1)=2.336515e+000; krok(n+1)=4.063871e-005; ng(n+1)=5.206301e+002;
n=27; farx(n+1)=4.895985e-001; foe(n+1)=2.060125e+000; krok(n+1)=2.114892e-005; ng(n+1)=3.923038e+002;
n=28; farx(n+1)=4.858735e-001; foe(n+1)=1.880870e+000; krok(n+1)=1.058889e-004; ng(n+1)=2.047977e+002;
n=29; farx(n+1)=4.714932e-001; foe(n+1)=1.744115e+000; krok(n+1)=2.559644e-004; ng(n+1)=1.430230e+002;
n=30; farx(n+1)=4.827383e-001; foe(n+1)=1.576007e+000; krok(n+1)=1.673711e-002; ng(n+1)=1.749311e+002;
n=31; farx(n+1)=4.876140e-001; foe(n+1)=1.456345e+000; krok(n+1)=6.746361e-003; ng(n+1)=1.409919e+002;
n=32; farx(n+1)=5.558046e-001; foe(n+1)=1.272231e+000; krok(n+1)=1.748904e-002; ng(n+1)=1.060611e+002;
n=33; farx(n+1)=5.626888e-001; foe(n+1)=1.204749e+000; krok(n+1)=5.294040e-003; ng(n+1)=1.570005e+002;
n=34; farx(n+1)=5.432148e-001; foe(n+1)=1.147280e+000; krok(n+1)=1.962977e-002; ng(n+1)=6.122295e+001;
n=35; farx(n+1)=5.385258e-001; foe(n+1)=1.102523e+000; krok(n+1)=2.440235e-002; ng(n+1)=3.608280e+001;
n=36; farx(n+1)=5.116701e-001; foe(n+1)=1.044926e+000; krok(n+1)=3.650930e-002; ng(n+1)=1.063586e+002;
n=37; farx(n+1)=4.820381e-001; foe(n+1)=1.005337e+000; krok(n+1)=1.041670e-002; ng(n+1)=7.219281e+001;
n=38; farx(n+1)=4.149375e-001; foe(n+1)=9.158220e-001; krok(n+1)=3.300845e-002; ng(n+1)=1.417514e+002;
n=39; farx(n+1)=4.051230e-001; foe(n+1)=8.822793e-001; krok(n+1)=4.050274e-002; ng(n+1)=4.768699e+001;
n=40; farx(n+1)=3.962884e-001; foe(n+1)=8.526963e-001; krok(n+1)=1.920518e-002; ng(n+1)=1.099399e+002;
n=41; farx(n+1)=3.593401e-001; foe(n+1)=7.740773e-001; krok(n+1)=1.281531e-001; ng(n+1)=4.266090e+001;
n=42; farx(n+1)=3.543486e-001; foe(n+1)=7.655358e-001; krok(n+1)=2.284436e-002; ng(n+1)=2.062610e+001;
n=43; farx(n+1)=3.527329e-001; foe(n+1)=7.604873e-001; krok(n+1)=8.674162e-003; ng(n+1)=3.844764e+001;
n=44; farx(n+1)=3.455926e-001; foe(n+1)=7.483398e-001; krok(n+1)=2.835564e-002; ng(n+1)=8.637289e+001;
n=45; farx(n+1)=3.298679e-001; foe(n+1)=7.156302e-001; krok(n+1)=3.149998e-002; ng(n+1)=5.070199e+001;
n=46; farx(n+1)=3.363657e-001; foe(n+1)=6.929681e-001; krok(n+1)=1.446686e-001; ng(n+1)=2.223803e+001;
n=47; farx(n+1)=3.364154e-001; foe(n+1)=6.675652e-001; krok(n+1)=5.793922e-002; ng(n+1)=7.992649e+001;
n=48; farx(n+1)=3.258470e-001; foe(n+1)=6.550801e-001; krok(n+1)=1.472237e-001; ng(n+1)=5.929150e+001;
n=49; farx(n+1)=3.065301e-001; foe(n+1)=6.356909e-001; krok(n+1)=2.475890e-001; ng(n+1)=2.478735e+001;
n=50; farx(n+1)=3.033065e-001; foe(n+1)=6.250599e-001; krok(n+1)=1.170340e-001; ng(n+1)=4.597582e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
