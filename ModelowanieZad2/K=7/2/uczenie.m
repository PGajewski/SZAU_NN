%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.744531e+002; foe(n+1)=1.855787e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.528295e+002; foe(n+1)=1.609353e+002; krok(n+1)=6.946998e-004; ng(n+1)=6.961327e+002;
n=2; farx(n+1)=6.163391e+001; foe(n+1)=6.066401e+001; krok(n+1)=3.804775e-003; ng(n+1)=5.414739e+002;
n=3; farx(n+1)=5.946053e+001; foe(n+1)=5.721112e+001; krok(n+1)=1.330026e-003; ng(n+1)=2.689301e+002;
n=4; farx(n+1)=5.416886e+001; foe(n+1)=5.614505e+001; krok(n+1)=4.776032e-003; ng(n+1)=7.547006e+001;
n=5; farx(n+1)=1.803176e+001; foe(n+1)=3.629502e+001; krok(n+1)=3.345123e-002; ng(n+1)=1.248416e+002;
n=6; farx(n+1)=1.070714e+001; foe(n+1)=2.076671e+001; krok(n+1)=3.692938e-003; ng(n+1)=6.476044e+002;
n=7; farx(n+1)=1.065459e+001; foe(n+1)=1.958541e+001; krok(n+1)=6.423816e-004; ng(n+1)=4.065611e+002;
n=8; farx(n+1)=1.019250e+001; foe(n+1)=1.928687e+001; krok(n+1)=5.320104e-003; ng(n+1)=1.613985e+002;
n=9; farx(n+1)=8.891777e+000; foe(n+1)=1.809846e+001; krok(n+1)=1.501192e-002; ng(n+1)=2.077856e+002;
n=10; farx(n+1)=7.172246e+000; foe(n+1)=1.573138e+001; krok(n+1)=6.875219e-003; ng(n+1)=4.541042e+002;
n=11; farx(n+1)=6.446946e+000; foe(n+1)=1.406296e+001; krok(n+1)=1.243743e-003; ng(n+1)=5.926753e+002;
n=12; farx(n+1)=6.003360e+000; foe(n+1)=1.323695e+001; krok(n+1)=2.722891e-003; ng(n+1)=4.839478e+002;
n=13; farx(n+1)=4.018639e+000; foe(n+1)=8.505317e+000; krok(n+1)=2.398987e-002; ng(n+1)=5.171430e+002;
n=14; farx(n+1)=3.922824e+000; foe(n+1)=7.981395e+000; krok(n+1)=4.101231e-003; ng(n+1)=4.012256e+002;
n=15; farx(n+1)=3.508169e+000; foe(n+1)=6.892553e+000; krok(n+1)=4.747676e-003; ng(n+1)=2.993862e+002;
n=16; farx(n+1)=3.202949e+000; foe(n+1)=6.462969e+000; krok(n+1)=3.709130e-003; ng(n+1)=1.254760e+002;
n=17; farx(n+1)=2.458654e+000; foe(n+1)=5.160959e+000; krok(n+1)=4.892037e-003; ng(n+1)=4.007388e+002;
n=18; farx(n+1)=1.949759e+000; foe(n+1)=4.225388e+000; krok(n+1)=5.557598e-003; ng(n+1)=4.836549e+002;
n=19; farx(n+1)=1.613864e+000; foe(n+1)=3.688043e+000; krok(n+1)=3.801047e-003; ng(n+1)=3.927666e+002;
n=20; farx(n+1)=1.143321e+000; foe(n+1)=3.087009e+000; krok(n+1)=1.574999e-002; ng(n+1)=6.394665e+002;
n=21; farx(n+1)=6.835500e-001; foe(n+1)=2.119859e+000; krok(n+1)=3.157023e-002; ng(n+1)=3.480226e+002;
n=22; farx(n+1)=5.760854e-001; foe(n+1)=1.817365e+000; krok(n+1)=3.779179e-003; ng(n+1)=6.028147e+002;
n=23; farx(n+1)=5.322982e-001; foe(n+1)=1.654029e+000; krok(n+1)=3.683227e-003; ng(n+1)=3.047691e+002;
n=24; farx(n+1)=5.096168e-001; foe(n+1)=1.219171e+000; krok(n+1)=7.000904e-002; ng(n+1)=7.457033e+001;
n=25; farx(n+1)=5.122083e-001; foe(n+1)=1.121227e+000; krok(n+1)=2.315269e-002; ng(n+1)=1.997524e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.124568e-001; foe(n+1)=1.111078e+000; krok(n+1)=1.539716e-005; ng(n+1)=9.760320e+001;
n=27; farx(n+1)=5.128651e-001; foe(n+1)=1.068785e+000; krok(n+1)=2.151482e-004; ng(n+1)=6.481838e+001;
n=28; farx(n+1)=5.072583e-001; foe(n+1)=1.057527e+000; krok(n+1)=3.812225e-005; ng(n+1)=5.581879e+001;
n=29; farx(n+1)=4.937208e-001; foe(n+1)=9.785523e-001; krok(n+1)=4.616173e-004; ng(n+1)=5.590538e+001;
n=30; farx(n+1)=4.512831e-001; foe(n+1)=8.346142e-001; krok(n+1)=3.178877e-002; ng(n+1)=1.214346e+001;
n=31; farx(n+1)=4.211552e-001; foe(n+1)=7.207339e-001; krok(n+1)=7.000904e-002; ng(n+1)=7.800862e+001;
n=32; farx(n+1)=4.052252e-001; foe(n+1)=6.317301e-001; krok(n+1)=2.800363e-002; ng(n+1)=1.141982e+002;
n=33; farx(n+1)=3.995981e-001; foe(n+1)=6.147419e-001; krok(n+1)=4.403244e-003; ng(n+1)=8.959436e+001;
n=34; farx(n+1)=4.013771e-001; foe(n+1)=5.919027e-001; krok(n+1)=2.378377e-002; ng(n+1)=6.562893e+001;
n=35; farx(n+1)=3.862110e-001; foe(n+1)=5.647304e-001; krok(n+1)=3.914062e-002; ng(n+1)=5.731495e+001;
n=36; farx(n+1)=3.723958e-001; foe(n+1)=5.495396e-001; krok(n+1)=3.269900e-002; ng(n+1)=7.715943e+001;
n=37; farx(n+1)=3.719616e-001; foe(n+1)=5.397077e-001; krok(n+1)=1.726831e-002; ng(n+1)=7.225696e+001;
n=38; farx(n+1)=3.700131e-001; foe(n+1)=5.214358e-001; krok(n+1)=4.158324e-002; ng(n+1)=5.338675e+001;
n=39; farx(n+1)=3.629610e-001; foe(n+1)=4.994846e-001; krok(n+1)=1.446686e-001; ng(n+1)=2.430891e+001;
n=40; farx(n+1)=3.566681e-001; foe(n+1)=4.907329e-001; krok(n+1)=3.941187e-002; ng(n+1)=6.122487e+001;
n=41; farx(n+1)=3.610962e-001; foe(n+1)=4.601804e-001; krok(n+1)=1.674643e-001; ng(n+1)=4.611570e+001;
n=42; farx(n+1)=3.541998e-001; foe(n+1)=4.548491e-001; krok(n+1)=6.423218e-002; ng(n+1)=5.202729e+001;
n=43; farx(n+1)=3.392794e-001; foe(n+1)=4.492062e-001; krok(n+1)=6.563449e-002; ng(n+1)=1.993037e+001;
n=44; farx(n+1)=3.231136e-001; foe(n+1)=4.422586e-001; krok(n+1)=8.877087e-002; ng(n+1)=2.309361e+001;
n=45; farx(n+1)=3.220531e-001; foe(n+1)=4.347287e-001; krok(n+1)=2.320583e-001; ng(n+1)=6.367777e+000;
n=46; farx(n+1)=3.181830e-001; foe(n+1)=4.292726e-001; krok(n+1)=1.892883e-001; ng(n+1)=3.645081e+001;
n=47; farx(n+1)=3.163792e-001; foe(n+1)=4.223496e-001; krok(n+1)=1.088038e-001; ng(n+1)=2.582020e+001;
n=48; farx(n+1)=3.079285e-001; foe(n+1)=4.049566e-001; krok(n+1)=4.641165e-001; ng(n+1)=2.347579e+001;
n=49; farx(n+1)=3.055395e-001; foe(n+1)=3.999484e-001; krok(n+1)=1.497077e-001; ng(n+1)=2.294561e+001;
n=50; farx(n+1)=3.043587e-001; foe(n+1)=3.929878e-001; krok(n+1)=1.232694e-001; ng(n+1)=3.987946e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
