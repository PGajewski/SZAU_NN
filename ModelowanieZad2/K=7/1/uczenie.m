%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.977466e+002; foe(n+1)=1.977029e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.801530e+002; foe(n+1)=1.790774e+002; krok(n+1)=6.552053e-004; ng(n+1)=6.442206e+002;
n=2; farx(n+1)=1.259429e+002; foe(n+1)=1.125282e+002; krok(n+1)=8.300976e-003; ng(n+1)=4.453429e+002;
n=3; farx(n+1)=6.424290e+001; foe(n+1)=5.650342e+001; krok(n+1)=6.791933e-004; ng(n+1)=1.353869e+003;
n=4; farx(n+1)=5.986230e+001; foe(n+1)=5.384389e+001; krok(n+1)=1.078226e-003; ng(n+1)=2.796710e+002;
n=5; farx(n+1)=2.985516e+001; foe(n+1)=4.327877e+001; krok(n+1)=3.482091e-002; ng(n+1)=1.334202e+002;
n=6; farx(n+1)=1.948316e+001; foe(n+1)=3.014993e+001; krok(n+1)=6.951230e-003; ng(n+1)=9.324782e+002;
n=7; farx(n+1)=1.849988e+001; foe(n+1)=2.880092e+001; krok(n+1)=1.021844e-003; ng(n+1)=3.677383e+002;
n=8; farx(n+1)=1.741870e+001; foe(n+1)=2.775730e+001; krok(n+1)=1.109636e-002; ng(n+1)=1.134327e+002;
n=9; farx(n+1)=1.701742e+001; foe(n+1)=2.628382e+001; krok(n+1)=7.632150e-003; ng(n+1)=3.379822e+002;
n=10; farx(n+1)=1.543139e+001; foe(n+1)=2.439128e+001; krok(n+1)=3.108824e-002; ng(n+1)=6.344656e+001;
n=11; farx(n+1)=1.351971e+001; foe(n+1)=2.214994e+001; krok(n+1)=2.991958e-002; ng(n+1)=2.518280e+002;
n=12; farx(n+1)=1.227665e+001; foe(n+1)=2.134765e+001; krok(n+1)=4.427789e-003; ng(n+1)=2.116400e+002;
n=13; farx(n+1)=1.126929e+001; foe(n+1)=2.070269e+001; krok(n+1)=3.707239e-003; ng(n+1)=4.056588e+002;
n=14; farx(n+1)=8.283112e+000; foe(n+1)=1.834788e+001; krok(n+1)=1.506159e-002; ng(n+1)=3.857057e+002;
n=15; farx(n+1)=5.215720e+000; foe(n+1)=1.651780e+001; krok(n+1)=2.409244e-002; ng(n+1)=2.671227e+002;
n=16; farx(n+1)=4.434827e+000; foe(n+1)=1.588806e+001; krok(n+1)=8.336543e-004; ng(n+1)=4.814353e+002;
n=17; farx(n+1)=4.104980e+000; foe(n+1)=1.549065e+001; krok(n+1)=2.855545e-003; ng(n+1)=2.783869e+002;
n=18; farx(n+1)=2.742650e+000; foe(n+1)=1.379107e+001; krok(n+1)=6.425309e-003; ng(n+1)=3.987369e+002;
n=19; farx(n+1)=2.196921e+000; foe(n+1)=1.253645e+001; krok(n+1)=2.647552e-003; ng(n+1)=5.461646e+002;
n=20; farx(n+1)=1.712201e+000; foe(n+1)=1.030952e+001; krok(n+1)=3.174920e-003; ng(n+1)=1.264872e+003;
n=21; farx(n+1)=1.678464e+000; foe(n+1)=1.000286e+001; krok(n+1)=4.352222e-004; ng(n+1)=7.809684e+002;
n=22; farx(n+1)=1.659300e+000; foe(n+1)=9.712591e+000; krok(n+1)=2.896066e-003; ng(n+1)=3.978126e+002;
n=23; farx(n+1)=1.690003e+000; foe(n+1)=8.072647e+000; krok(n+1)=4.953895e-002; ng(n+1)=7.395876e+002;
n=24; farx(n+1)=1.610513e+000; foe(n+1)=7.938418e+000; krok(n+1)=3.930173e-003; ng(n+1)=2.298320e+002;
n=25; farx(n+1)=1.303454e+000; foe(n+1)=6.853751e+000; krok(n+1)=7.897489e-002; ng(n+1)=3.156229e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.284854e+000; foe(n+1)=6.633150e+000; krok(n+1)=1.161317e-005; ng(n+1)=4.371502e+002;
n=27; farx(n+1)=1.280911e+000; foe(n+1)=6.584026e+000; krok(n+1)=1.069939e-005; ng(n+1)=2.559345e+002;
n=28; farx(n+1)=1.342273e+000; foe(n+1)=6.430951e+000; krok(n+1)=7.309947e-005; ng(n+1)=1.685386e+002;
n=29; farx(n+1)=1.292639e+000; foe(n+1)=5.986625e+000; krok(n+1)=7.893559e-004; ng(n+1)=8.762644e+001;
n=30; farx(n+1)=1.497874e+000; foe(n+1)=4.207881e+000; krok(n+1)=1.856226e-002; ng(n+1)=5.775287e+001;
n=31; farx(n+1)=1.504981e+000; foe(n+1)=3.923961e+000; krok(n+1)=8.953304e-004; ng(n+1)=2.727448e+002;
n=32; farx(n+1)=1.523819e+000; foe(n+1)=3.422950e+000; krok(n+1)=1.358387e-003; ng(n+1)=5.015209e+002;
n=33; farx(n+1)=1.337309e+000; foe(n+1)=2.826246e+000; krok(n+1)=8.166461e-003; ng(n+1)=2.410275e+002;
n=34; farx(n+1)=1.183617e+000; foe(n+1)=2.520758e+000; krok(n+1)=7.740832e-003; ng(n+1)=2.352006e+002;
n=35; farx(n+1)=1.026599e+000; foe(n+1)=2.134053e+000; krok(n+1)=1.053841e-002; ng(n+1)=1.612621e+002;
n=36; farx(n+1)=9.818700e-001; foe(n+1)=2.038041e+000; krok(n+1)=2.357114e-003; ng(n+1)=2.497680e+002;
n=37; farx(n+1)=7.724631e-001; foe(n+1)=1.763334e+000; krok(n+1)=3.556534e-002; ng(n+1)=3.471215e+001;
n=38; farx(n+1)=7.307385e-001; foe(n+1)=1.680829e+000; krok(n+1)=4.267031e-003; ng(n+1)=1.841391e+002;
n=39; farx(n+1)=7.052398e-001; foe(n+1)=1.612740e+000; krok(n+1)=1.189189e-002; ng(n+1)=9.119635e+001;
n=40; farx(n+1)=6.638876e-001; foe(n+1)=1.424325e+000; krok(n+1)=5.631405e-003; ng(n+1)=2.176734e+002;
n=41; farx(n+1)=6.426053e-001; foe(n+1)=1.369489e+000; krok(n+1)=1.248857e-002; ng(n+1)=1.854617e+002;
n=42; farx(n+1)=6.223129e-001; foe(n+1)=1.331917e+000; krok(n+1)=4.486659e-002; ng(n+1)=1.086355e+002;
n=43; farx(n+1)=6.011490e-001; foe(n+1)=1.276327e+000; krok(n+1)=3.550424e-002; ng(n+1)=8.696455e+001;
n=44; farx(n+1)=5.856062e-001; foe(n+1)=1.210161e+000; krok(n+1)=1.028050e-001; ng(n+1)=7.812331e+001;
n=45; farx(n+1)=5.918379e-001; foe(n+1)=1.137249e+000; krok(n+1)=3.805310e-002; ng(n+1)=1.518486e+002;
n=46; farx(n+1)=5.487039e-001; foe(n+1)=1.040622e+000; krok(n+1)=6.659180e-002; ng(n+1)=1.773685e+002;
n=47; farx(n+1)=4.402095e-001; foe(n+1)=9.130057e-001; krok(n+1)=1.253606e-001; ng(n+1)=1.113707e+002;
n=48; farx(n+1)=3.740089e-001; foe(n+1)=8.490440e-001; krok(n+1)=6.442938e-002; ng(n+1)=1.392105e+002;
n=49; farx(n+1)=3.664711e-001; foe(n+1)=7.761463e-001; krok(n+1)=1.695040e-001; ng(n+1)=8.562680e+001;
n=50; farx(n+1)=3.605619e-001; foe(n+1)=7.112401e-001; krok(n+1)=5.335388e-002; ng(n+1)=1.874473e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
