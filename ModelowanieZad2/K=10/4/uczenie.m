%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.430726e+002; foe(n+1)=2.434356e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.463411e+002; foe(n+1)=1.454844e+002; krok(n+1)=4.863026e-004; ng(n+1)=1.570721e+003;
n=2; farx(n+1)=6.344522e+001; foe(n+1)=6.184304e+001; krok(n+1)=3.813746e-003; ng(n+1)=7.177713e+002;
n=3; farx(n+1)=6.152026e+001; foe(n+1)=5.785563e+001; krok(n+1)=3.442236e-003; ng(n+1)=3.076859e+002;
n=4; farx(n+1)=4.946839e+001; foe(n+1)=5.597131e+001; krok(n+1)=2.417030e-002; ng(n+1)=5.136078e+001;
n=5; farx(n+1)=3.107650e+001; foe(n+1)=4.738976e+001; krok(n+1)=1.178924e-002; ng(n+1)=2.249008e+002;
n=6; farx(n+1)=2.291485e+001; foe(n+1)=4.462857e+001; krok(n+1)=8.252113e-003; ng(n+1)=2.180841e+002;
n=7; farx(n+1)=9.835741e+000; foe(n+1)=3.529186e+001; krok(n+1)=9.335866e-003; ng(n+1)=6.347158e+002;
n=8; farx(n+1)=8.347341e+000; foe(n+1)=3.389349e+001; krok(n+1)=1.172640e-004; ng(n+1)=1.652412e+003;
n=9; farx(n+1)=7.417256e+000; foe(n+1)=2.887114e+001; krok(n+1)=2.700359e-003; ng(n+1)=2.127518e+003;
n=10; farx(n+1)=7.402273e+000; foe(n+1)=2.846846e+001; krok(n+1)=1.107642e-004; ng(n+1)=2.887173e+003;
n=11; farx(n+1)=7.796511e+000; foe(n+1)=2.769585e+001; krok(n+1)=6.748373e-003; ng(n+1)=2.755413e+003;
n=12; farx(n+1)=8.061977e+000; foe(n+1)=2.187503e+001; krok(n+1)=1.012183e-002; ng(n+1)=2.481572e+003;
n=13; farx(n+1)=8.191529e+000; foe(n+1)=1.425838e+001; krok(n+1)=6.764823e-003; ng(n+1)=1.010363e+003;
n=14; farx(n+1)=8.070296e+000; foe(n+1)=1.396592e+001; krok(n+1)=1.104943e-003; ng(n+1)=2.067756e+002;
n=15; farx(n+1)=5.946272e+000; foe(n+1)=1.188780e+001; krok(n+1)=2.223039e-002; ng(n+1)=1.706471e+002;
n=16; farx(n+1)=2.522303e+000; foe(n+1)=7.079669e+000; krok(n+1)=2.690904e-002; ng(n+1)=2.570210e+002;
n=17; farx(n+1)=1.685096e+000; foe(n+1)=5.572096e+000; krok(n+1)=2.015675e-004; ng(n+1)=1.043393e+003;
n=18; farx(n+1)=1.429649e+000; foe(n+1)=4.857975e+000; krok(n+1)=2.414856e-003; ng(n+1)=1.607792e+003;
n=19; farx(n+1)=1.285332e+000; foe(n+1)=3.735703e+000; krok(n+1)=1.198026e-003; ng(n+1)=1.034849e+003;
n=20; farx(n+1)=1.278038e+000; foe(n+1)=3.284891e+000; krok(n+1)=7.088910e-003; ng(n+1)=4.014597e+002;
n=21; farx(n+1)=1.107083e+000; foe(n+1)=2.795505e+000; krok(n+1)=2.079162e-002; ng(n+1)=1.885914e+002;
n=22; farx(n+1)=1.014823e+000; foe(n+1)=2.542502e+000; krok(n+1)=1.058808e-002; ng(n+1)=2.691431e+002;
n=23; farx(n+1)=9.380636e-001; foe(n+1)=2.384648e+000; krok(n+1)=7.740832e-003; ng(n+1)=2.743921e+002;
n=24; farx(n+1)=8.516631e-001; foe(n+1)=2.192919e+000; krok(n+1)=1.596372e-002; ng(n+1)=1.673503e+002;
n=25; farx(n+1)=7.774011e-001; foe(n+1)=1.985964e+000; krok(n+1)=1.433719e-002; ng(n+1)=2.308543e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.761089e-001; foe(n+1)=1.919994e+000; krok(n+1)=1.530281e-005; ng(n+1)=2.626529e+002;
n=27; farx(n+1)=7.763231e-001; foe(n+1)=1.915897e+000; krok(n+1)=2.034152e-005; ng(n+1)=5.577235e+001;
n=28; farx(n+1)=7.782638e-001; foe(n+1)=1.908024e+000; krok(n+1)=9.866949e-005; ng(n+1)=3.828310e+001;
n=29; farx(n+1)=7.603646e-001; foe(n+1)=1.845026e+000; krok(n+1)=6.349841e-003; ng(n+1)=1.693444e+001;
n=30; farx(n+1)=7.494432e-001; foe(n+1)=1.793676e+000; krok(n+1)=3.401267e-003; ng(n+1)=2.521780e+001;
n=31; farx(n+1)=7.270124e-001; foe(n+1)=1.700359e+000; krok(n+1)=6.480489e-003; ng(n+1)=5.644413e+001;
n=32; farx(n+1)=7.053058e-001; foe(n+1)=1.581120e+000; krok(n+1)=2.223039e-002; ng(n+1)=2.151036e+002;
n=33; farx(n+1)=6.162291e-001; foe(n+1)=1.392025e+000; krok(n+1)=3.272372e-002; ng(n+1)=1.220290e+002;
n=34; farx(n+1)=5.459142e-001; foe(n+1)=1.203835e+000; krok(n+1)=1.004449e-002; ng(n+1)=2.379723e+002;
n=35; farx(n+1)=5.050090e-001; foe(n+1)=1.137244e+000; krok(n+1)=9.907442e-003; ng(n+1)=1.428652e+002;
n=36; farx(n+1)=4.749950e-001; foe(n+1)=1.077969e+000; krok(n+1)=1.243357e-002; ng(n+1)=1.108477e+002;
n=37; farx(n+1)=4.429138e-001; foe(n+1)=1.018271e+000; krok(n+1)=1.683407e-002; ng(n+1)=6.193205e+001;
n=38; farx(n+1)=4.467483e-001; foe(n+1)=9.560585e-001; krok(n+1)=4.294671e-002; ng(n+1)=7.389295e+001;
n=39; farx(n+1)=4.437580e-001; foe(n+1)=9.148529e-001; krok(n+1)=2.085765e-002; ng(n+1)=6.764334e+001;
n=40; farx(n+1)=4.103288e-001; foe(n+1)=8.242799e-001; krok(n+1)=4.446078e-002; ng(n+1)=1.099526e+002;
n=41; farx(n+1)=3.932664e-001; foe(n+1)=7.689305e-001; krok(n+1)=4.715694e-002; ng(n+1)=7.237418e+001;
n=42; farx(n+1)=3.873974e-001; foe(n+1)=7.429522e-001; krok(n+1)=1.175824e-002; ng(n+1)=8.437339e+001;
n=43; farx(n+1)=3.868058e-001; foe(n+1)=7.033721e-001; krok(n+1)=9.599621e-002; ng(n+1)=3.412473e+001;
n=44; farx(n+1)=3.855845e-001; foe(n+1)=6.658199e-001; krok(n+1)=1.142218e-002; ng(n+1)=1.687733e+002;
n=45; farx(n+1)=4.045280e-001; foe(n+1)=6.370233e-001; krok(n+1)=4.346837e-002; ng(n+1)=7.593674e+001;
n=46; farx(n+1)=3.939048e-001; foe(n+1)=6.180349e-001; krok(n+1)=4.102364e-002; ng(n+1)=4.459411e+001;
n=47; farx(n+1)=3.819521e-001; foe(n+1)=6.075516e-001; krok(n+1)=1.680696e-002; ng(n+1)=6.444621e+001;
n=48; farx(n+1)=3.734128e-001; foe(n+1)=5.918545e-001; krok(n+1)=3.351559e-002; ng(n+1)=7.599748e+001;
n=49; farx(n+1)=3.701730e-001; foe(n+1)=5.622525e-001; krok(n+1)=9.228634e-002; ng(n+1)=3.604604e+001;
n=50; farx(n+1)=3.730622e-001; foe(n+1)=5.292554e-001; krok(n+1)=7.866273e-002; ng(n+1)=7.569566e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
