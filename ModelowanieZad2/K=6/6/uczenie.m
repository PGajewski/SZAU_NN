%uczenie predyktora oe
clear all;
n=0; farx(n+1)=1.941734e+002; foe(n+1)=1.939294e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.820446e+002; foe(n+1)=1.817354e+002; krok(n+1)=9.446471e-004; ng(n+1)=4.442876e+002;
n=2; farx(n+1)=1.636976e+002; foe(n+1)=1.629432e+002; krok(n+1)=2.209886e-003; ng(n+1)=3.293791e+002;
n=3; farx(n+1)=5.561784e+001; foe(n+1)=5.588259e+001; krok(n+1)=3.721397e-003; ng(n+1)=5.014511e+002;
n=4; farx(n+1)=5.266817e+001; foe(n+1)=5.541689e+001; krok(n+1)=2.561707e-003; ng(n+1)=7.508765e+001;
n=5; farx(n+1)=4.575173e+001; foe(n+1)=5.428670e+001; krok(n+1)=3.973596e-003; ng(n+1)=1.384158e+002;
n=6; farx(n+1)=3.929284e+001; foe(n+1)=4.395904e+001; krok(n+1)=4.879939e-002; ng(n+1)=2.472449e+002;
n=7; farx(n+1)=3.503427e+001; foe(n+1)=3.926711e+001; krok(n+1)=1.024683e-002; ng(n+1)=2.298493e+002;
n=8; farx(n+1)=3.251111e+001; foe(n+1)=3.760658e+001; krok(n+1)=5.711090e-003; ng(n+1)=2.096381e+002;
n=9; farx(n+1)=3.033299e+001; foe(n+1)=3.671420e+001; krok(n+1)=5.381741e-003; ng(n+1)=2.975662e+002;
n=10; farx(n+1)=2.262006e+001; foe(n+1)=2.989460e+001; krok(n+1)=6.742193e-002; ng(n+1)=4.073428e+002;
n=11; farx(n+1)=2.158544e+001; foe(n+1)=2.942209e+001; krok(n+1)=2.519327e-003; ng(n+1)=1.295019e+002;
n=12; farx(n+1)=1.802257e+001; foe(n+1)=2.760724e+001; krok(n+1)=2.219272e-002; ng(n+1)=1.149206e+002;
n=13; farx(n+1)=1.640856e+001; foe(n+1)=2.670726e+001; krok(n+1)=2.921865e-003; ng(n+1)=3.083921e+002;
n=14; farx(n+1)=1.047086e+001; foe(n+1)=2.066935e+001; krok(n+1)=4.000365e-002; ng(n+1)=2.427558e+002;
n=15; farx(n+1)=1.008948e+001; foe(n+1)=1.982354e+001; krok(n+1)=6.856719e-004; ng(n+1)=6.073620e+002;
n=16; farx(n+1)=9.865030e+000; foe(n+1)=1.922104e+001; krok(n+1)=2.414856e-003; ng(n+1)=4.489424e+002;
n=17; farx(n+1)=8.338284e+000; foe(n+1)=1.792568e+001; krok(n+1)=2.327615e-002; ng(n+1)=1.448797e+002;
n=18; farx(n+1)=6.638205e+000; foe(n+1)=1.595104e+001; krok(n+1)=1.121665e-002; ng(n+1)=3.614504e+002;
n=19; farx(n+1)=5.319025e+000; foe(n+1)=1.492279e+001; krok(n+1)=1.987953e-002; ng(n+1)=2.759140e+002;
n=20; farx(n+1)=4.424573e+000; foe(n+1)=1.427906e+001; krok(n+1)=5.414124e-003; ng(n+1)=5.170902e+002;
n=21; farx(n+1)=3.559229e+000; foe(n+1)=1.363970e+001; krok(n+1)=2.156451e-003; ng(n+1)=2.792990e+002;
n=22; farx(n+1)=2.455050e+000; foe(n+1)=1.248145e+001; krok(n+1)=7.481826e-003; ng(n+1)=3.906093e+002;
n=23; farx(n+1)=1.909216e+000; foe(n+1)=1.178771e+001; krok(n+1)=5.980899e-003; ng(n+1)=9.293989e+002;
n=24; farx(n+1)=1.460145e+000; foe(n+1)=1.066555e+001; krok(n+1)=5.680993e-003; ng(n+1)=1.076251e+003;
n=25; farx(n+1)=1.385051e+000; foe(n+1)=1.016542e+001; krok(n+1)=2.223039e-002; ng(n+1)=1.076194e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.379181e+000; foe(n+1)=9.874511e+000; krok(n+1)=4.419215e-006; ng(n+1)=7.535728e+002;
n=27; farx(n+1)=1.368892e+000; foe(n+1)=9.835898e+000; krok(n+1)=9.579321e-005; ng(n+1)=8.871341e+001;
n=28; farx(n+1)=1.438639e+000; foe(n+1)=8.394035e+000; krok(n+1)=1.238012e-003; ng(n+1)=1.899493e+002;
n=29; farx(n+1)=1.242221e+000; foe(n+1)=5.902320e+000; krok(n+1)=4.957630e-004; ng(n+1)=5.094523e+002;
n=30; farx(n+1)=1.359127e+000; foe(n+1)=4.910967e+000; krok(n+1)=7.010405e-004; ng(n+1)=9.278678e+002;
n=31; farx(n+1)=1.293516e+000; foe(n+1)=4.228213e+000; krok(n+1)=2.569527e-003; ng(n+1)=2.296363e+002;
n=32; farx(n+1)=9.675225e-001; foe(n+1)=3.038673e+000; krok(n+1)=1.000091e-002; ng(n+1)=3.156058e+002;
n=33; farx(n+1)=8.952805e-001; foe(n+1)=2.851351e+000; krok(n+1)=8.650734e-004; ng(n+1)=5.017166e+002;
n=34; farx(n+1)=7.360976e-001; foe(n+1)=2.543727e+000; krok(n+1)=1.916385e-002; ng(n+1)=9.699371e+001;
n=35; farx(n+1)=6.491298e-001; foe(n+1)=2.221594e+000; krok(n+1)=2.621411e-003; ng(n+1)=4.571372e+002;
n=36; farx(n+1)=6.191013e-001; foe(n+1)=1.940923e+000; krok(n+1)=4.916421e-003; ng(n+1)=4.727067e+002;
n=37; farx(n+1)=5.729964e-001; foe(n+1)=1.713323e+000; krok(n+1)=1.500979e-002; ng(n+1)=2.661398e+002;
n=38; farx(n+1)=5.302560e-001; foe(n+1)=1.555887e+000; krok(n+1)=2.001452e-002; ng(n+1)=2.299459e+002;
n=39; farx(n+1)=5.064145e-001; foe(n+1)=1.444091e+000; krok(n+1)=6.353015e-003; ng(n+1)=2.636110e+002;
n=40; farx(n+1)=4.659559e-001; foe(n+1)=1.272938e+000; krok(n+1)=6.754791e-002; ng(n+1)=1.339140e+002;
n=41; farx(n+1)=4.741650e-001; foe(n+1)=1.035275e+000; krok(n+1)=3.754388e-002; ng(n+1)=3.117430e+002;
n=42; farx(n+1)=4.832876e-001; foe(n+1)=9.447370e-001; krok(n+1)=3.820826e-002; ng(n+1)=2.291000e+002;
n=43; farx(n+1)=4.763205e-001; foe(n+1)=9.104831e-001; krok(n+1)=4.785778e-002; ng(n+1)=1.733347e+002;
n=44; farx(n+1)=4.565661e-001; foe(n+1)=8.619962e-001; krok(n+1)=4.797973e-002; ng(n+1)=1.196613e+002;
n=45; farx(n+1)=4.468195e-001; foe(n+1)=8.003421e-001; krok(n+1)=1.490738e-001; ng(n+1)=1.370234e+002;
n=46; farx(n+1)=4.414138e-001; foe(n+1)=7.705247e-001; krok(n+1)=9.228634e-002; ng(n+1)=7.742282e+001;
n=47; farx(n+1)=4.446534e-001; foe(n+1)=6.927696e-001; krok(n+1)=9.571557e-002; ng(n+1)=7.757851e+001;
n=48; farx(n+1)=3.969777e-001; foe(n+1)=6.393633e-001; krok(n+1)=2.250273e-001; ng(n+1)=1.418978e+002;
n=49; farx(n+1)=3.734789e-001; foe(n+1)=5.850752e-001; krok(n+1)=5.857529e-002; ng(n+1)=8.753702e+001;
n=50; farx(n+1)=3.517445e-001; foe(n+1)=5.398676e-001; krok(n+1)=8.029948e-001; ng(n+1)=4.068982e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
