%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.496792e+002; foe(n+1)=2.510723e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.720439e+002; foe(n+1)=1.748859e+002; krok(n+1)=4.988661e-004; ng(n+1)=5.025003e+002;
n=2; farx(n+1)=5.248742e+001; foe(n+1)=6.424051e+001; krok(n+1)=1.535317e-002; ng(n+1)=1.104504e+002;
n=3; farx(n+1)=4.988298e+001; foe(n+1)=6.104717e+001; krok(n+1)=3.164277e-004; ng(n+1)=3.527511e+002;
n=4; farx(n+1)=4.845598e+001; foe(n+1)=5.346481e+001; krok(n+1)=5.214412e-003; ng(n+1)=4.312955e+002;
n=5; farx(n+1)=3.246374e+001; foe(n+1)=4.881606e+001; krok(n+1)=1.586357e-002; ng(n+1)=4.950029e+001;
n=6; farx(n+1)=2.753469e+001; foe(n+1)=4.580283e+001; krok(n+1)=1.601914e-002; ng(n+1)=4.477667e+002;
n=7; farx(n+1)=2.636443e+001; foe(n+1)=3.980195e+001; krok(n+1)=1.464382e-002; ng(n+1)=6.757891e+002;
n=8; farx(n+1)=2.685184e+001; foe(n+1)=3.677834e+001; krok(n+1)=4.788074e-003; ng(n+1)=5.176569e+002;
n=9; farx(n+1)=2.391179e+001; foe(n+1)=3.363582e+001; krok(n+1)=2.320583e-001; ng(n+1)=4.567297e+002;
n=10; farx(n+1)=2.356499e+001; foe(n+1)=3.304715e+001; krok(n+1)=3.651364e-002; ng(n+1)=4.270866e+002;
n=11; farx(n+1)=2.029722e+001; foe(n+1)=2.657214e+001; krok(n+1)=9.656284e-002; ng(n+1)=4.065771e+002;
n=12; farx(n+1)=1.720534e+001; foe(n+1)=2.480232e+001; krok(n+1)=5.536470e-002; ng(n+1)=4.252286e+002;
n=13; farx(n+1)=1.648919e+001; foe(n+1)=2.344873e+001; krok(n+1)=2.429096e-002; ng(n+1)=4.968108e+002;
n=14; farx(n+1)=8.768668e+000; foe(n+1)=1.797312e+001; krok(n+1)=2.760258e-001; ng(n+1)=2.984546e+002;
n=15; farx(n+1)=4.446843e+000; foe(n+1)=1.296727e+001; krok(n+1)=2.010759e-001; ng(n+1)=6.166034e+002;
n=16; farx(n+1)=2.819558e+000; foe(n+1)=9.788817e+000; krok(n+1)=5.226535e-001; ng(n+1)=5.289343e+002;
n=17; farx(n+1)=1.953572e+000; foe(n+1)=8.650326e+000; krok(n+1)=1.160291e-001; ng(n+1)=1.288679e+002;
n=18; farx(n+1)=1.332405e+000; foe(n+1)=6.753383e+000; krok(n+1)=7.382907e-001; ng(n+1)=1.603405e+002;
n=19; farx(n+1)=9.770960e-001; foe(n+1)=5.611778e+000; krok(n+1)=5.491644e-001; ng(n+1)=4.084137e+002;
n=20; farx(n+1)=9.329831e-001; foe(n+1)=5.306776e+000; krok(n+1)=4.112198e-001; ng(n+1)=2.252199e+002;
n=21; farx(n+1)=9.905656e-001; foe(n+1)=5.215172e+000; krok(n+1)=3.371762e-001; ng(n+1)=7.096332e+001;
n=22; farx(n+1)=1.150090e+000; foe(n+1)=5.044124e+000; krok(n+1)=9.826030e-001; ng(n+1)=6.621548e+001;
n=23; farx(n+1)=1.341092e+000; foe(n+1)=4.760263e+000; krok(n+1)=5.203615e-001; ng(n+1)=8.717797e+001;
n=24; farx(n+1)=1.169109e+000; foe(n+1)=4.474393e+000; krok(n+1)=4.144507e-001; ng(n+1)=1.880857e+002;
n=25; farx(n+1)=8.662008e-001; foe(n+1)=4.035765e+000; krok(n+1)=8.707243e-001; ng(n+1)=3.705202e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=8.604655e-001; foe(n+1)=3.964927e+000; krok(n+1)=8.539569e-006; ng(n+1)=2.169510e+002;
n=27; farx(n+1)=8.576506e-001; foe(n+1)=3.927024e+000; krok(n+1)=4.720762e-005; ng(n+1)=9.878044e+001;
n=28; farx(n+1)=8.716139e-001; foe(n+1)=3.871745e+000; krok(n+1)=5.326130e-004; ng(n+1)=3.233842e+001;
n=29; farx(n+1)=8.253710e-001; foe(n+1)=3.463825e+000; krok(n+1)=8.669283e-003; ng(n+1)=2.068129e+001;
n=30; farx(n+1)=8.235435e-001; foe(n+1)=3.091065e+000; krok(n+1)=6.544675e-003; ng(n+1)=6.178881e+001;
n=31; farx(n+1)=8.506827e-001; foe(n+1)=2.840529e+000; krok(n+1)=3.752980e-003; ng(n+1)=2.422292e+002;
n=32; farx(n+1)=9.645832e-001; foe(n+1)=2.511304e+000; krok(n+1)=6.734730e-003; ng(n+1)=1.857208e+002;
n=33; farx(n+1)=9.785373e-001; foe(n+1)=2.420433e+000; krok(n+1)=7.964480e-002; ng(n+1)=2.671974e+002;
n=34; farx(n+1)=9.496837e-001; foe(n+1)=2.235340e+000; krok(n+1)=5.671128e-002; ng(n+1)=3.495366e+002;
n=35; farx(n+1)=6.881123e-001; foe(n+1)=2.023564e+000; krok(n+1)=1.443061e-001; ng(n+1)=1.453901e+002;
n=36; farx(n+1)=8.164851e-001; foe(n+1)=1.893205e+000; krok(n+1)=1.111619e-001; ng(n+1)=1.740683e+002;
n=37; farx(n+1)=7.231820e-001; foe(n+1)=1.806538e+000; krok(n+1)=2.490283e-001; ng(n+1)=1.105157e+002;
n=38; farx(n+1)=6.413174e-001; foe(n+1)=1.630430e+000; krok(n+1)=4.170483e-001; ng(n+1)=8.340098e+001;
n=39; farx(n+1)=6.466274e-001; foe(n+1)=1.572988e+000; krok(n+1)=3.098762e-001; ng(n+1)=8.888284e+001;
n=40; farx(n+1)=6.394337e-001; foe(n+1)=1.512533e+000; krok(n+1)=3.706964e-001; ng(n+1)=1.671958e+002;
n=41; farx(n+1)=6.376220e-001; foe(n+1)=1.485065e+000; krok(n+1)=1.342163e+000; ng(n+1)=4.837609e+001;
n=42; farx(n+1)=5.677370e-001; foe(n+1)=1.458448e+000; krok(n+1)=8.892951e-001; ng(n+1)=4.980255e+001;
n=43; farx(n+1)=5.607462e-001; foe(n+1)=1.454183e+000; krok(n+1)=5.467184e-001; ng(n+1)=2.155588e+001;
n=44; farx(n+1)=5.544150e-001; foe(n+1)=1.451707e+000; krok(n+1)=1.339714e+000; ng(n+1)=1.729155e+001;
n=45; farx(n+1)=5.553053e-001; foe(n+1)=1.446553e+000; krok(n+1)=1.740861e+000; ng(n+1)=2.566411e+001;
n=46; farx(n+1)=5.581653e-001; foe(n+1)=1.443557e+000; krok(n+1)=7.525649e-001; ng(n+1)=9.793997e+000;
n=47; farx(n+1)=5.432326e-001; foe(n+1)=1.438093e+000; krok(n+1)=1.691553e+000; ng(n+1)=1.416977e+001;
n=48; farx(n+1)=6.004852e-001; foe(n+1)=1.422955e+000; krok(n+1)=4.225082e+000; ng(n+1)=7.926797e+000;
n=49; farx(n+1)=6.067349e-001; foe(n+1)=1.419997e+000; krok(n+1)=9.372047e-001; ng(n+1)=2.528325e+001;
n=50; farx(n+1)=6.282197e-001; foe(n+1)=1.417159e+000; krok(n+1)=2.290894e+000; ng(n+1)=6.263167e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
