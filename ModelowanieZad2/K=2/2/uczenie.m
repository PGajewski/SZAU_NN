%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.417010e+002; foe(n+1)=2.483557e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.698493e+002; foe(n+1)=1.747906e+002; krok(n+1)=4.988661e-004; ng(n+1)=6.068687e+002;
n=2; farx(n+1)=5.221510e+001; foe(n+1)=5.377399e+001; krok(n+1)=1.571994e-002; ng(n+1)=1.729791e+002;
n=3; farx(n+1)=5.088073e+001; foe(n+1)=5.188984e+001; krok(n+1)=7.964319e-004; ng(n+1)=1.646985e+002;
n=4; farx(n+1)=1.419911e+001; foe(n+1)=2.985756e+001; krok(n+1)=3.201933e-002; ng(n+1)=8.096335e+001;
n=5; farx(n+1)=1.285269e+001; foe(n+1)=2.838609e+001; krok(n+1)=2.875463e-004; ng(n+1)=2.727324e+002;
n=6; farx(n+1)=1.117824e+001; foe(n+1)=2.698312e+001; krok(n+1)=2.840497e-003; ng(n+1)=1.566074e+002;
n=7; farx(n+1)=1.144374e+001; foe(n+1)=2.646061e+001; krok(n+1)=6.422675e-003; ng(n+1)=1.441482e+002;
n=8; farx(n+1)=1.427270e+001; foe(n+1)=2.482979e+001; krok(n+1)=1.175824e-002; ng(n+1)=2.404052e+002;
n=9; farx(n+1)=1.275857e+001; foe(n+1)=2.159336e+001; krok(n+1)=8.452792e-002; ng(n+1)=1.044241e+002;
n=10; farx(n+1)=1.161938e+001; foe(n+1)=2.101195e+001; krok(n+1)=2.702970e-002; ng(n+1)=1.185891e+002;
n=11; farx(n+1)=5.438954e+000; foe(n+1)=1.544924e+001; krok(n+1)=8.877087e-002; ng(n+1)=1.422356e+002;
n=12; farx(n+1)=5.125852e+000; foe(n+1)=1.447611e+001; krok(n+1)=6.101994e-002; ng(n+1)=4.087410e+002;
n=13; farx(n+1)=3.128092e+000; foe(n+1)=1.127855e+001; krok(n+1)=4.681906e-002; ng(n+1)=2.917011e+002;
n=14; farx(n+1)=1.586188e+000; foe(n+1)=8.592514e+000; krok(n+1)=6.345766e-002; ng(n+1)=5.848408e+002;
n=15; farx(n+1)=1.316890e+000; foe(n+1)=6.644516e+000; krok(n+1)=1.644497e-001; ng(n+1)=6.640968e+002;
n=16; farx(n+1)=1.099890e+000; foe(n+1)=5.704150e+000; krok(n+1)=1.578639e-001; ng(n+1)=4.042090e+002;
n=17; farx(n+1)=9.939042e-001; foe(n+1)=5.615372e+000; krok(n+1)=2.051030e-001; ng(n+1)=8.619513e+001;
n=18; farx(n+1)=1.024211e+000; foe(n+1)=5.484952e+000; krok(n+1)=6.400584e-001; ng(n+1)=9.389213e+001;
n=19; farx(n+1)=9.803182e-001; foe(n+1)=5.417097e+000; krok(n+1)=6.193808e-001; ng(n+1)=6.582653e+001;
n=20; farx(n+1)=1.043304e+000; foe(n+1)=5.148018e+000; krok(n+1)=3.848936e+000; ng(n+1)=4.961119e+001;
n=21; farx(n+1)=1.359236e+000; foe(n+1)=4.391122e+000; krok(n+1)=3.233202e+000; ng(n+1)=5.309294e+001;
n=22; farx(n+1)=1.483081e+000; foe(n+1)=3.943784e+000; krok(n+1)=3.624196e-001; ng(n+1)=1.240164e+002;
n=23; farx(n+1)=1.348301e+000; foe(n+1)=3.302384e+000; krok(n+1)=2.064051e-001; ng(n+1)=2.610985e+002;
n=24; farx(n+1)=1.167623e+000; foe(n+1)=2.814881e+000; krok(n+1)=7.262643e-002; ng(n+1)=4.038547e+002;
n=25; farx(n+1)=7.274196e-001; foe(n+1)=2.373604e+000; krok(n+1)=4.015963e-001; ng(n+1)=1.788913e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.266887e-001; foe(n+1)=2.353453e+000; krok(n+1)=7.676118e-006; ng(n+1)=1.626012e+002;
n=27; farx(n+1)=7.270817e-001; foe(n+1)=2.337249e+000; krok(n+1)=4.194015e-005; ng(n+1)=7.053390e+001;
n=28; farx(n+1)=7.213550e-001; foe(n+1)=2.323408e+000; krok(n+1)=8.375096e-004; ng(n+1)=1.226333e+001;
n=29; farx(n+1)=7.446389e-001; foe(n+1)=2.194542e+000; krok(n+1)=5.320104e-003; ng(n+1)=1.520869e+001;
n=30; farx(n+1)=7.551123e-001; foe(n+1)=2.151747e+000; krok(n+1)=6.555717e-003; ng(n+1)=8.503247e+001;
n=31; farx(n+1)=8.046998e-001; foe(n+1)=2.053281e+000; krok(n+1)=1.802073e-002; ng(n+1)=5.293342e+001;
n=32; farx(n+1)=7.916007e-001; foe(n+1)=2.028190e+000; krok(n+1)=1.349675e-002; ng(n+1)=7.457116e+001;
n=33; farx(n+1)=5.970397e-001; foe(n+1)=1.769556e+000; krok(n+1)=7.301859e-002; ng(n+1)=1.314083e+002;
n=34; farx(n+1)=5.003735e-001; foe(n+1)=1.663502e+000; krok(n+1)=5.005537e-002; ng(n+1)=9.982562e+001;
n=35; farx(n+1)=5.870208e-001; foe(n+1)=1.580556e+000; krok(n+1)=9.137743e-002; ng(n+1)=1.437412e+002;
n=36; farx(n+1)=5.280035e-001; foe(n+1)=1.516482e+000; krok(n+1)=5.558094e-002; ng(n+1)=2.079472e+001;
n=37; farx(n+1)=5.690371e-001; foe(n+1)=1.481109e+000; krok(n+1)=2.393567e-001; ng(n+1)=7.431815e+001;
n=38; farx(n+1)=5.210291e-001; foe(n+1)=1.450743e+000; krok(n+1)=2.836964e-001; ng(n+1)=7.925726e+001;
n=39; farx(n+1)=5.041919e-001; foe(n+1)=1.410801e+000; krok(n+1)=1.186820e+000; ng(n+1)=4.895257e+001;
n=40; farx(n+1)=4.996915e-001; foe(n+1)=1.403046e+000; krok(n+1)=8.670260e-001; ng(n+1)=2.713105e+001;
n=41; farx(n+1)=4.887487e-001; foe(n+1)=1.393805e+000; krok(n+1)=5.925364e-001; ng(n+1)=3.945469e+001;
n=42; farx(n+1)=4.893159e-001; foe(n+1)=1.381265e+000; krok(n+1)=1.980712e+000; ng(n+1)=7.392887e+000;
n=43; farx(n+1)=4.851797e-001; foe(n+1)=1.345494e+000; krok(n+1)=4.945624e+000; ng(n+1)=4.035245e+001;
n=44; farx(n+1)=5.173751e-001; foe(n+1)=1.323168e+000; krok(n+1)=1.062525e+000; ng(n+1)=2.380222e+001;
n=45; farx(n+1)=5.403491e-001; foe(n+1)=1.312430e+000; krok(n+1)=8.083004e-001; ng(n+1)=8.218374e+000;
n=46; farx(n+1)=5.246075e-001; foe(n+1)=1.301217e+000; krok(n+1)=1.120145e+000; ng(n+1)=7.448555e+000;
n=47; farx(n+1)=5.379416e-001; foe(n+1)=1.292304e+000; krok(n+1)=1.477307e+000; ng(n+1)=1.850299e+001;
n=48; farx(n+1)=5.299739e-001; foe(n+1)=1.285303e+000; krok(n+1)=1.715220e+000; ng(n+1)=2.442547e+000;
n=49; farx(n+1)=5.400834e-001; foe(n+1)=1.275949e+000; krok(n+1)=1.268929e+000; ng(n+1)=7.005959e+001;
n=50; farx(n+1)=5.438988e-001; foe(n+1)=1.269574e+000; krok(n+1)=1.390988e+000; ng(n+1)=3.489930e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
